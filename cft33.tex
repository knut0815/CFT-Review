
\documentclass[12pt, a4paper, notitlepage, twoside]{report}

\raggedbottom

\RequirePackage[l2tabu, orthodox]{nag}

\usepackage[top=20mm,bottom=20mm,left=25mm,right=25mm]{geometry}

\usepackage{showkeys}

\usepackage{amsmath,amssymb,amsfonts}

\usepackage{multirow}

\usepackage{underbracket}
% Depending on which version of underbracket.sty is used, the command \cunderbracket can cause an error when its arguments include raised or lowered text, as in \cunderbracket{J^a}{(z)K_{bc}}{(J^bJ^c)}(y) .

\usepackage{pgf}
\usepackage{tikz}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}

\numberwithin{equation}{section}

% Beware that page numbers in the index can be wrong by one unit or more.
% This problem is apparently solved by running Makeindex several times.
\usepackage{makeidx}
\makeindex
\usepackage{tocbibind}

\usepackage{amsthm}
\newtheoremstyle{break}{9pt}{9pt}{\itshape}{}{\bfseries}{}{\newline}{}
\theoremstyle{break}    
\newtheorem{exo}{Exercise}[chapter]
\newtheorem{hyp}{Axiom}[chapter]

% urlcolor is set to black because unwanted url links appear in the bibliography
\usepackage[colorlinks=true,linktoc=all,linkcolor=black,citecolor=red,urlcolor=blue]{hyperref}

\title{\bfseries Conformal field theory on the plane}

\author{Sylvain Ribault \vspace{2mm}
\\
{\normalsize CEA Saclay, Institut de Physique Th\'eorique}
 \\
 {\footnotesize \ttfamily sylvain.ribault@cea.fr }
}


\begin{document}

\maketitle

\begin{abstract}
We provide an introduction to conformal field theory on the plane in the conformal bootstrap approach.
We introduce the main ideas of the bootstrap approach to quantum field theory, and how they apply to two-dimensional theories with local conformal symmetry.
We describe the mathematical structures which appear in such theories, from the Virasoro algebra and its representations, to the BPZ equations and their solutions.
As examples, we study a number of models: Liouville theory, (generalized) minimal models, free bosonic theories, the $H_3^+$ model, and the $SU_2$ and $\widetilde{SL}_2(\mathbb{R})$ WZW models. 
\end{abstract}
\vspace{1cm}
\begin{center}
 \textbf{Keywords}
\end{center}
\noindent conformal field theory, conformal bootstrap, Virasoro algebra, BPZ equations, Liouville theory, minimal models, free bosons,
KZ equations, KZ-BPZ relation, $H_3^+$ model, WZW models

\vspace{1cm}
\begin{center}
\textbf{Public domain notice}
\end{center}
\noindent To the extent possible under law, Sylvain Ribault has waived all copyright and related or neighboring rights to this text.

\tableofcontents
\hypersetup{linkcolor=blue}

\addtocounter{chapter}{-1}

\chapter{Preliminaries \label{secprel}}

\section{Context and approach}

As an introduction to two-dimensional conformal field theory, this text has the particularity of using exclusively the bootstrap approach, which consists in systematically exploiting symmetry and consistency assumptions.
While this approach is widely recognized as very powerful, most of the literature uses it alongside the Lagrangian approach, which can be quite useful for heuristics and for some computations.
Renouncing Lagrangians however has the advantages of simplicity and consistency, and we will try to show that we do not lose much in terms of heuristics and computational power -- we will only have to deplore the loss of a simple definition for WZW models.

Another advantage of the bootstrap approach is that by making assumptions explicit, we can better understand them, and if necessary lift them.
For example, results such as the C-theorem, and the fact that scale invariance implies conformal invariance in two-dimensional unitary quantum field theories, rely on the strong assumption that there exists an energy-momentum tensor -- a conserved field with spin two and conformal dimension two, which generates conformal transformations.
We will not lift this assumption, as we will study theories with local (i.e.
not just global) conformal invariance, which therefore always have an energy-momentum tensor.

We will however lift a number of other common assumptions, in particular the existence of a vacuum state, and the existence of theories on any Riemann surface (and not just on the plane).
It would be interesting to investigate how this affects the set of possible models, and in particular the classification of minimal models.
It is however mainly for the sake of generality and simplicity that
we will lift these assumptions.
We will indeed be studying not only rational, but also non-rational theories such as Liouville theory.
Non-rational theories do not necessarily have a vacuum state, and assuming their consistency on the torus is of little help for determining their spectrums \cite{rib14c}. 

By definition, rational conformal field theories have spectrums made of finitely many representations.
However, in order to ensure closure under fusion, these representations must have complicated structures.
In Liouville theory, the spectrum is made of a continuum of representations, but these representations are merely Verma modules, so we will study this theory first.
Then we will study minimal models, which are rational and therefore less generic and more complicated.
Even later will come free theories: since we do not do use a perturbative approach, they do not play any fundamental role. 


\section{Plan of the article \label{secplan}}

We will do a systematic exposition of the ideas and techniques of the conformal bootstrap approach in Chapters \ref{secintr} and \ref{secccs}, before studying particular models in Chapters \ref{seccbm} and \ref{secaff}.

In Chapter \ref{secintr}, we introduce the bootstrap approach to quantum field theory, before focusing on the particular case of conformal field theories with their Virasoro symmetry algebra.
We then give a preview of some of the simplest models.

In Chapter \ref{secccs}, we work out the technical consequences of these ideas for the spectrum and correlation functions.
We study the highest-weight representations of the Virasoro algebra, the fields that correspond to states in these representations, and the correlation functions of these fields. 

In Chapter \ref{seccbm}, we introduce and solve the simplest non-trivial two-dimensional conformal field theories: Liouville theory, generalized minimal models, and A-series minimal models.
We define these theories by a few simple assumptions on their spectrums and correlation functions.
We pay particular attention to the three-point structure constants, whose explicit expressions we derive. 

In Chapter \ref{secaff}, we introduce extended symmetry algebras, starting with the affine $\hat{\mathfrak{u}}_1$ algebra.
This not only allows us to study free bosonic theories, but also provides alternative perspectives on Liouville theory -- perspectives which were originally obtained using the Lagrangian approach.
We then consider nonabelian affine symmetry algebras, and in particular $\widehat{\mathfrak{sl}}_2$.
We deduce the definition and solution of the $H_3^+$ model from the KZ-BPZ relation between differential equations satisfied by $\widehat{\mathfrak{sl}}_2$-symmetric and Virasoro-symmetric correlation functions.
We then consider WZW models, and in particular the $SU_2$ and $\widetilde{SL}_2(\mathbb{R})$ WZW models. 

In each Chapter, the last Section is devoted to exercises.
Some exercises are intended to test and improve one's comprehension of the material; such exercises become scarcer in later Chapters.
Some exercises sketch proofs of results from the main text, in cases when hints and guidance seem warranted.
And some exercises provide supplementary material about: 
\begin{itemize}
 \item singular vectors of Verma modules (Exercise \ref{exosv}),
 \item characters of Virasoro representations (Exercise \ref{exochar}),
\item logarithmic conformal field theory (Exercise \ref{exolog}), 
\item fusion rules of unitary Verma modules (Exercise \ref{exoaur}), 
\item Liouville theory with finite multiplicities (Exercise \ref{exomul}),
\item generalization of the Sugawara construction (Exercise \ref{exotqpj}),
\item the Wakimoto free-field representation of $\widehat{\mathfrak{sl}}_2$ (Exercise \ref{exowaki}).
\end{itemize}

This text comes with an index, which points to the one or two places in the text where each term is defined.
At these places, the terms in question appear in bold. 


\section{Why one more review on conformal field theory?}

Let us argue that this review article fills an available ecological niche, by considering which neighbouring niches are already filled: 
\begin{itemize}
\item 
The book \cite{zz90} by A. and Al. Zamoldochikov is in spirit quite close to this article.
That book is a concise exposition of conformal field theory, from the basic principles to advanced results, mostly in the conformal bootstrap approach.
However, the depth and breadth of the ideas may be too much for beginning students.
Non-rational theories such as Liouville theory are not covered.
And misprints are frequent.
\item
Non-rational theories are covered in a review by Schomerus \cite{sch05}.
That article uses multiple approaches, and pays particular attention to boundary conformal field theory, with applications to string theory in mind. 
\item
The Big Yellow Book \cite{fms97} is a useful reference, especially on rational conformal field theories.
As its epic length suggests, it is rather encyclopedic. 
\item
The encyclopedic approach was extended in the direction of Liouville theory by Nakayama's review \cite{nak04}, which includes systematic guides to the literature.
\item 
On the more pedagogical side, Gaberdiel's review \cite{gab99} provides a consistent exposition using vertex operators, which mathematically formalize the conformal bootstrap approach.
That text deals more with the symmetry algebras and their representations, than with correlation functions.
Examples include logarithmic theories, but no non-rational theories.
\item
Motivations and applications are mostly absent from the present text.
On the statistical mechanics side, they are given in Cardy's lecture notes \cite{car08}, which also provide a concise introduction to the formalism.
\item 
$W$-symmetry is reviewed in depth in Bouwknegt and Schoutens's article \cite{bs92}, where $W$-symmetric conformal field theories are however not solved systematically.
An exposition of the $W$-symmetric minimal models and conformal Toda theories would be a natural extension of the present article, although these theories have not been fully solved so far. 
\end{itemize}
In contrast to these texts, we will treat both rational and non-rational theories.
Moreover, our exclusive use of the bootstrap approach means that we need not assume any previous knowledge of quantum field theory.
The prerequisites for this text are limited to 
elementary complex analysis, and some familiarity with Lie algebras and their representations.
A much abridged version is also available \cite{rib16}.

While this review article mostly presents already known results, the following aspects may be original:
\begin{itemize}
\item in Section \ref{secaco}, the formulation of Al. Zamolodchikov's recursion representation of conformal blocks as an explicit formula,
\item in Section \ref{secliou}, a complete and correct solution of Liouville theory, using only the bootstrap approach, 
\item in Section \ref{secvmm}, the logical sequence ``Liouville theory $\rightarrow$ generalized minimal models $\rightarrow$ minimal models'',
\item in Section \ref{secsacf}, the remark that compactified free bosons exist for any value of $c$ and not just if $c=1$,
\item in Section \ref{seclld}, the derivation of the light and heavy asymptotic limits of Liouville theory, without using the Lagrangian definition,
\item in Section \ref{secsu}, the definition of the generalized $SU_2$ WZW model,
\item in Section \ref{secslr}, a concise derivation of the spectrum and fusion rules of the $\widetilde{SL}_2(\mathbb{R})$ WZW model.
\end{itemize}


\section{User's manual}

This review article is intended as a tool for learning, and as a collection of technical results.
It provides neither a history of the subject, nor a guide to the literature.
Accordingly, citations to the existing literature are not meant to distribute credit to researchers in the field.
Citations are solely meant to be 
\href{http://researchpracticesandtools.blogspot.fr/2013/08/write-for-humans-not-for-robots.html}
{helpful to the reader}, and are therefore used sparingly.
Each cited work comes with a hopefully clear and precise indication of what could be useful therein.
In choosing cited works, the criterions have been
\begin{enumerate}
\item ease of access (only freely and if possible legally available texts are cited), 
\item clarity and completeness (this often favours review articles over original works),
\item my familiarity with the cited works (admittedly this favours my own works). 
\end{enumerate}
Citations are only one tool for finding more information on the subject. 
The reader is assumed to have access to other tools such as Google and Wikipedia. 
To facilitate searches, an effort has been made to use standard terminology and notations. 

Traditional scientific articles, with their frozen texts and authors, are obviously a poor way of conveying the ever-evolving knowledge of a community of researchers.
They may become obsolete, but it is not clear what will replace them.
Meanwhile, it seems prudent to distribute the present text so that it can easily be 
\href{http://researchpracticesandtools.blogspot.fr/2014/02/the-case-for-emancipating-articles-from.html}
{reused and modified by others}.
For this purpose:
\begin{itemize}
 \item This text is in the public domain, in order to eliminate legal restrictions to its reuse. 
\item This article is distributed not only using Arxiv, but also using \href{https://github.com/ribault/CFT-Review}{GitHub}, so that it can be collaboratively modified. 
\item In the Latex file, there are no user-defined global macros.
This makes it easier to reuse excerpts of that file. 
\end{itemize}

I have tried to follow some stylistic good practices, such as: providing a clickable table of contents, not clogging the bibliography with superfluous information such as journal data, avoiding Latin plurals when regular plurals are available, and numbering all equations while boxing the important ones. 
% Also, having a linebreak at the end of each sentence, in order to facilitate version control.


\section{Acknowledgements}

I am grateful to my colleagues at IPhT Saclay, and in particular to Antoine Duval, Riccardo Guida, Santiago Migliaccio, Vincent Pasquier, and Pierre Ronceray, for the opportunity to give lectures on this subject. I am also grateful to the organizers and participants to the 10th APCTP Focus Program on Liouville, Integrability and Branes, and in particular to Soojong Rey, for including my lectures in an otherwise very advanced workshop. Moreover, I am grateful to the organizers and participants to the 2016 Carg\`ese school on Quantum integrable systems, conformal field theory and stochastic processes, for challenging me to introduce the subject in about four hours. (See \cite{rib16}.) 

I wish to thank Philippe Di Francesco, Sheer El-Showk, Matthias Gaberdiel, Christoph Keller, Miguel Paulos, Slava Rychkov, Vincent Vargas, and G\'erard Watts, for useful discussions and correspondence.

I am grateful to Connor Behan, Fran\c{c}ois David, Quang-Dien Duong, Bruno Le Floch, Omar Foda, and Raoul Santachiara, for helpful comments on this text.

\chapter{Introduction \label{secintr}}

\section{Quantum field theory \label{secqft} }

Conformal field theory is a special case of \textbf{\boldmath quantum field theory}\index{quantum field theory}, and we start with a brief reminder of what quantum field theory is.

\subsection{Definition} 

A \textbf{\boldmath theory}\index{theory} can be either a general framework such as quantum field theory or general relativity, or a more specific \textbf{\boldmath model}\index{model} such as the standard model of particle physics or Liouville theory.
The standard model is formulated in the framework of quantum field theory, so we can call it a model of quantum field theory or simply a quantum field theory.
Similarly, Liouville theory is a conformal field theory.
A model need not be directly related to a \textbf{\boldmath physical system}\index{physical system}: a given physical system can be described by several models, and a given model can describe a number (possibly zero) of physical systems.
This holds not only for physical systems, but also for what could be called theoretical systems, such as quantum gravity in $d$ dimensions.
These notions are illustrated by the following examples:
\begin{align}
 \begin{tikzpicture}[scale = .5]
  \node at (5,11){Theories};
  \node at (14,11){Models};
  \node at (25,11){Systems};
  \draw[thick] (0,10.3) -- (30,10.3);
  %
  \draw[fill = red!10] (0, 6.3) rectangle (20, 9.7);
  \draw[fill = red!10] (0, 4.1) rectangle (20, 5.9);
  \draw[fill = red!10] (0, .3) rectangle (20, 3.7);
  %
  \node at (.2, 8)[right] {Newtonian mechanics};
  \node at (.2, 5)[right] {General relativity};
  \node at (.2, 2)[right] {Conformal field theory};
  %
  \draw (14, 8.8) node[draw, fill = white] (ss) {Spinning solid};
  \draw (14, 7.2) node[draw, fill = white] (gb) {Gravitating bodies};
  \draw (14, 5) node[draw, fill = white] (rgb) {Relativistic gravitating bodies};
  \draw (14, 2.8) node[draw, fill = white] (mm) {Minimal model};
  \draw (14, 1.2) node[draw, fill = white] (lt) {Liouville theory};
  %
  \draw (25, 8.8) node[draw, fill = green!10] (st) {Spinning top};
  \draw (25, 6.1) node[draw, fill = green!10] (ssys) {Solar system};
  \draw (25, 2.8) node[draw, fill = green!10] (qg) {2d quantum geometry};
  \draw (25, 1.2) node[draw, fill = green!10] (str) {2d string};
  %
  \draw[thick, dashed] (ss.east) to [out = 0, in = 180] (st.west);
  \draw[thick, dashed] (gb.east) to [out = 0, in = 180] (ssys.west);
  \draw[thick, dashed] (rgb.east) to [out = 0, in = 180] (ssys.west);
  \draw[thick, dashed] (lt.east) to [out = 0, in = 180] (qg.west);
  \draw[thick, dashed] (lt.east) to [out = 0, in = 180] (str.west);
 \end{tikzpicture}
\end{align}

Now, what is a \textbf{\boldmath quantum}\index{quantum} theory? First, this is a probabilistic theory, which does not predict the outcome of a given experiment, but the probabilities of different outcomes.
Second, a quantum theory does not predict just probabilities, but actually probability amplitudes.
Such amplitudes can be added, giving rise to interferences. 

Last, the \textbf{\boldmath field}\index{field} in field theory is a variable defined on some space, which can describe an arbitrary number of particles propagating in that space.
In particular, field theories can describe the creation and annihilation of particles.
For example, a ``height of water'' field can be defined on the surface of the ocean, in order to describe arbitrary numbers of water waves.
A field can in some respects be thought of as an infinite collection of elementary objects: in our example, individual waves of definite wavelengths.
Field theory constrains how these objects behave in relation with the underlying space, for instance by requiring interactions to be local.

So, quantum field theory is particularly well-suited to predicting the outcomes of collisions of particles, whether in the cosmos or in a particle accelerator.
Such collisions can indeed create or destroy particles, so we need a field theory, and repeating the same collision can produce different outcomes, so we need a probabilistic theory. 

\subsection{Observables}

In a model, the \textbf{\boldmath observables}\index{observable} are the quantities which can in principle be measured.
The nature of the observables is in general dictated by the theory.
For example, in the theory of general relativity, the observables are light signals and motions of objects, and do not include the space-time metric. 
Which observables are relevant may depend on the physical system.
For example, in two-dimensional conformal field theory, some observables are functions on the two-dimensional space.
Such observables are relevant in condensed-matter physics and in quantum geometry, where the space has a physical interpretation.
They are not relevant in string theory, where the two-dimensional space is the world-sheet of a string. 
In quantum field theory in general, and in conformal field theory in particular, we define the observables to be 
\begin{itemize}
 \item the spectrum and
\item the correlation functions.
\end{itemize}

In quantum theory, the \textbf{\boldmath spectrum}\index{spectrum} or space of states is a vector space whose elements represent the states of a system.
The vector space structure is what leads to interferences.
A vector $\sigma$ and the action $A(\sigma)$ of an operator $A$ on $\sigma$ may be written as 
\begin{align}
\left\{\begin{array}{l} 
 \sigma = |\sigma\rangle\ , \\ A(\sigma) = A|\sigma\rangle = |A\sigma\rangle\ .
\end{array}\right. 
\end{align}

In quantum field theory, states are supposed to live on constant-time slices of space-time. If space-time is Euclidean, we can take such slices to be spheres surrounding any point $x$. If the theory is invariant under dilatations, such spheres can contract to infinitesimal sizes without loss of information. Therefore, to each state $|\sigma\rangle$ and each point $x$ we associate an object $V_\sigma(x)$, and the collection of these objects when $x$ varies is a field. 

\begin{hyp}[\textbf{\boldmath State-field correspondence}\index{state-field correspondence} or state-operator correspondence]
~\label{ax:sfc}
 There is an injective linear map from the spectrum to the space of fields,
 \begin{align}
 |\sigma \rangle  \ \mapsto \ V_\sigma(x)\ .
\end{align}
\end{hyp} 
\noindent
Thinking of the state as a type of particles, the field $V_\sigma(x)$ can be thought of as measuring the presence of such particles at point $x$.
Then, a \textbf{\boldmath correlation function}\index{correlation function}, here an \textbf{\boldmath $N$-point function}\index{N-point function@$N$-point function}
\begin{align}
\left\langle \prod_{i=1}^N V_{\sigma_i}(x_i)\right\rangle
\label{pva}
\end{align}
is the probability amplitude for the interaction of $N$ particles of types $\sigma_1,\cdots \sigma_N$, located at points $x_1,\cdots x_N$. 
Correlation functions are numbers that linearly depend on fields, in particular 
\begin{align}
 \frac{\partial}{\partial x} \left\langle \prod_{i=1}^N V_{\sigma_i}(x_i)\right\rangle = \left\langle \frac{\partial}{\partial x} \prod_{i=1}^N V_{\sigma_i}(x_i)\right\rangle\ ,
\end{align}
for any component $x$ of a coordinate $x_i$. 
Correlation functions will be defined by the equations that they obey, which will be deduced from the assumptions of the bootstrap approach.

To construct a model of quantum field theory is therefore to give principles which uniquely determine a spectrum and a set of correlation functions.
To \textbf{\boldmath solve a model}\index{solve (model)} is to actually compute the spectrum and correlation functions. 

% NB: do we want an axiom that correlation functions are single-valued? Or should it be part of the definition? An axiom would is better as it can be relaxed!

\section{The bootstrap approach}

\subsection{Principles \label{secprin}}

The \textbf{\boldmath bootstrap approach}\index{bootstrap approach} is a method for constructing and solving theories, based on the systematic exploitation of 
\begin{enumerate}
 \item symmetry assumptions,
 \item consistency conditions,
\end{enumerate}
For example, the symmetry assumption of general covariance is the basis of the theory of general relativity, and the further symmetry assumptions of homogeneity and isotropy of the universe are used in constructing models of cosmology.
In quantum theories, an essential consistency condition is the condition that the sum of the probabilities of all possible events is one. 

Given a set of assumptions, there may exist any number of models which obey them:
\begin{itemize}
 \item no model at all, if the assumptions are too restrictive,
\item one model, in which case we may be able to solve it,
\item a manageable number of models, in which case we may be able to classify them, and to focus on one of them by making further assumptions,
\item a huge number of models, if the assumptions are not restrictive enough.
\end{itemize}
We will now explore in turn the symmetry assumptions and consistency conditions in quantum field theory. 

\subsection{Symmetry assumptions \label{secsa}}

If a model of quantum field theory has a symmetry algebra, then the spectrum $S$ must be a representation of this algebra, and can therefore be written as
\begin{align}
 S = \bigoplus_R m_R  R\ .\
\label{somr}
\end{align}
Here we have decomposed $S$ as a combination of some basic representations $R$ of the symmetry algebra, and the number $m_R \in {\mathbb{N}}\cup\{\infty\}$ is the \textbf{\boldmath multiplicity}\index{multiplicity} of the representation $R$ in the spectrum $S$.
A state $\sigma$ in the spectrum can then be written as 
\begin{align}
 \sigma = (R,v)\ ,
\label{arv}
\end{align}
where $v$ is a state in the representation $R$, and the corresponding field can be written as 
$V_\sigma(x)= V_{(R,v)}(x)$. For example, for any spin $j\in \frac12 \mathbb{N}$ the algebra $\mathfrak{sl}_2$ has a representation of dimension $2j+1$, whose states $\sigma = (j,m)$ can be labelled by their magnetic momentums $m\in\{-j, -j+1,\cdots j\}$.

The idea is now that the dependence of a correlation function $\left\langle \prod_{i=1}^n V_{(R_i,v_i)}(x_i)\right\rangle$ on $v_i$ is determined by symmetry considerations, whereas the dependence on $R_i$ is constrained by consistency conditions.
This idea however comes with a number of technical assumptions.
In particular, for the dependence on $v_i$ to be completely determined by symmetry, $R_i$ must be an \textbf{\boldmath indecomposable representation}\index{indecomposable representation}, which cannot be written as a direct sum of smaller representations.
\begin{align}
 R \ \ \text{indecomposable} \quad \Leftrightarrow \quad \nexists R',R'' \neq 0 \quad | \quad R = R'\oplus R''\ .
\end{align}
In particular, any \textbf{\boldmath irreducible representation}\index{irreducible representation}, which by definition does not have a nontrivial subrepresentation, is indecomposable,
\begin{align}
 R \ \ \text{irreducible} \quad \Leftrightarrow \quad \nexists R' \neq 0,R \quad | \quad R'\subset R\ .
\end{align}
(See Exercise \ref{exoirr} for an example of an indecomposable representation which is not irreducible.)

We will therefore distinguish two types of data:
\begin{itemize}
 \item \textbf{\boldmath universal data}\index{universal data}, which are also called 
model-independent or algebraic data.
This is the information on representations of the symmetry algebra, which determines in particular the $v_i$-dependence of correlation functions.
Universal data in conformal field theory, and in particular conformal blocks, will be studied in Chapter \ref{secccs}. 
\item \textbf{\boldmath model-dependent data}\index{model-dependent data}, which encode how the spectrum and correlation functions of a particular model are built from the universal data.
This includes the multiplicities $m_R$, which encode how the spectrum is built from representations, and the structure constants, which encode how correlation functions are built from conformal blocks.
We will study these data 
in Chapter \ref{seccbm}.  
\end{itemize}
Which data are  universal or model-dependent depends on the choice of a symmetry algebra.
If a model's symmetry algebra $\mathfrak{A}$ is actually a subalgebra of a larger symmetry algebra $\mathfrak{A}'$, then the representations of $\mathfrak{A}$ which appear in the spectrum
must combine into representations of the larger algebra $\mathfrak{A}'$.
Which combinations can appear is universal data of $\mathfrak{A}'$, but model-dependent data from the point of view of the smaller algebra $\mathfrak{A}$. 

Since a field theory is defined on some space, we can distinguish two types of symmetries: 
\begin{itemize}
 \item space-time symmetries, which act on that space,
\item internal symmetries, which do not.
\end{itemize}
Space-time symmetries include in particular the invariances under rotations and translations.
Internal symmetries include gauge invariances.
The distinction between space-time and internal symmetries depends on the choice of the space: for example, supersymmetry can be an internal or space-time symmetry depending on whether the theory is formulated on an ordinary space or on a superspace.

\subsection{Consistency conditions \label{seccc}}

The consistency conditions on the correlation functions $\left\langle\prod_{i=1}^n V_{\sigma_i}(x_i)\right\rangle$ are derived from axioms on the fields $V_{\sigma_i}(x_i)$:

\begin{hyp}[\textbf{Commutativity}\index{commutativity} or locality]
\label{ax:col}
\begin{align}
 \boxed{V_{\sigma_1}(x_1)V_{\sigma_2}(x_2) = V_{\sigma_2}(x_2) V_{\sigma_1}(x_1)}\ ,
\label{comm}
\end{align}
provided $(x_1,x_2)$ obey some condition.
In Minkowski space for instance, $x_1-x_2$ is supposed to be space-like.
In the two-dimensional Euclidean space, the condition is $x_1\neq x_2$.
\end{hyp}
\begin{hyp}[\textbf{Associativity}\index{associativity}]
\label{ax:ass}
\begin{align}
 \boxed{\left(V_{\sigma_1}(x_1)V_{\sigma_2}(x_2)\right) V_{\sigma_3}(x_3) = V_{\sigma_1}(x_1)  \left(V_{\sigma_2}(x_2) V_{\sigma_3}(x_3)\right)}\ .
\label{asso}
\end{align}
\end{hyp} 
\noindent
Together with commutativity, this implies that the ordering of fields in correlation functions is indifferent.
\begin{hyp}[Existence of an \textbf{\boldmath OPE}\index{OPE} (operator product expansion)]
 \label{ax:ope}
 \begin{align}
 \boxed{V_{\sigma_1}(x_1)V_{\sigma_2}(x_2) = \sum_{\sigma\in S} C_{\sigma_1,\sigma_2}^{\sigma}(x_1,x_2) V_{\sigma}(x_2)}\ ,
\label{ope}
\end{align}
where the \textbf{\boldmath OPE coefficient}\index{OPE coefficient} $C_{\sigma_1,\sigma_2}^{\sigma}(x_1,x_2)$ is a function (i.e.
not a field), and the sum runs over a basis of the spectrum $S$. 
The sum is supposed to converge if $x_1$ and $x_2$ are sufficiently close. 
\end{hyp} 
\noindent
Our axioms do not include the existence of a vacuum state, a frequently encountered axiom of quantum field theory in flat space.
In Liouville theory this axiom is not satisfied, and in minimal models we can do without it. 

Let us now study how these assumptions constrain the correlation functions.
By performing multiple OPEs, an $N$-point function (with $N\geq 3$) can always be reduced to a combination of two-point functions, for instance
\begin{align}
 \left\langle \prod_{i=1}^4 V_{\sigma_i}(x_i) \right\rangle = \sum_{\sigma\in S} C_{\sigma_1,\sigma_2}^{\sigma}(x_1,x_2)\sum_{\sigma'\in S} C_{\sigma,\sigma_3}^{\sigma'}(x_2,x_3)\left\langle V_{\sigma'}(x_3)V_{\sigma_4}(x_4)\right\rangle\ .
\end{align}
We could go further and reduce the two-point function to a sum of one-point functions.
This is however unnecessary, because conformal symmetry will determine the two-point function, so that we can consider it a known quantity.
So, in order to compute correlation functions, all we need to know (in addition to the spectrum $S$) is the OPE coefficient $C_{\sigma_1,\sigma_2}^{\sigma}(x_1,x_2)$.
But this quantity is itself strongly constrained by the associativity assumption \eqref{asso}, which implies
\begin{align}
 \sum_{\sigma_s\in S} C_{\sigma_1,\sigma_2}^{\sigma_s}(x_1,x_2) C_{\sigma_s,\sigma_3}^{\sigma_4}(x_2,x_3) = \sum_{\sigma_t\in S} C_{\sigma_1,\sigma_t}^{\sigma_4}(x_1,x_3)C_{\sigma_2,\sigma_3}^{\sigma_t}(x_2,x_3)\ ,
\label{cccc}
\end{align}
for any choice of the four states $(\sigma_1,\sigma_2,\sigma_3,\sigma_4)$.
(See Exercise \ref{exoten} a similar calculation in a technically simpler context.) This condition can be represented schematically as 
\begin{align}
\sum_{s} 
 \begin{tikzpicture}[scale = .2, baseline=(current  bounding  box.center), very thick]
  \draw (-4,3) node [above] {$1$} -- (0, -1) -- (4, 3) node [above] {$3$};
  \draw (0, 3) node [above] {$2$} -- (-2, 1) -- node [below left] {$s$} (0, -1) -- (0, -4) node [below] {$4$};
 \end{tikzpicture}
= \quad
\sum_{t} 
\begin{tikzpicture}[scale = .2, baseline=(current  bounding  box.center), very thick]
  \draw (-4,3) node [above] {$1$} -- (0, -1) -- (4, 3) node [above] {$3$};
  \draw (0, 3) node [above] {$2$} -- (2, 1) -- node [below right] {$t$} (0, -1) -- (0, -4) node [below] {$4$};
  \end{tikzpicture}
\label{sdsd}
\end{align}
where each node corresponds to an OPE coefficient. 

The OPE coefficients can be determined by solving the associativity condition \eqref{cccc}, provided the model has enough symmetry for 
\begin{itemize}
 \item constraining the dependence of the OPE coefficient $C_{\sigma_1,\sigma_2}^{\sigma}(x_1,x_2)$ on $(x_1,x_2)$, and
\item decomposing the spectrum $S$ into a reasonable number of representations.
\end{itemize}
These conditions are fulfilled in certain conformal field theories.
In particular, as we will see in Chapter \ref{secccs}, conformal symmetry is enough for determining the $x$-dependence of OPE coefficients. 

For the moment, let us show how symmetry constraints can simplify the associativity condition.
We recall that a state $\sigma\in S$ can be written as $\sigma=(R,v)$ as in eq. \eqref{arv}, where $R$ is an indecomposable representation of the symmetry algebra and $v\in R$.
Symmetry constraints lead to equations for the OPE coefficient 
$C_{\sigma_1,\sigma_2}^{\sigma_3}(x_1,x_2)$, which have two general properties:
\begin{itemize}
 \item The symmetry equations for the OPE coefficient are linear.
\item A symmetry equation may have terms with different values of the parameters $v_i$ and $x_i$, but it involves only one value of each of the parameters $R_i$, as by definition the action of a symmetry transformation on a state $v_i\in R_i$ is another state in the same representation. 
\end{itemize}
Therefore, an OPE coefficient can be decomposed into universal and model-dependent data as
\begin{align}
 C_{\sigma_1,\sigma_2}^{\sigma_3}(x_1,x_2) = \sum_{\lambda=1}^{N_{R_1R_2}^{R_3}} C_{R_1,R_2}^{R_3,\lambda}(x_1,x_2) f_{R_1,R_2}^{R_3,\lambda}(v_1,v_2,v_3|x_1,x_2)\ ,
\label{clcf}
\end{align}
where $C_{R_1,R_2}^{R_3,\lambda}(x_1,x_2)$ is a model-dependent \textbf{\boldmath structure function}\index{structure function}, and 
the universal quantity $f_{R_1,R_2}^{R_3,\lambda}(v_i|x_j)$ is a solution of the symmetry equations, which for given values of $R_i$ should be understood as equations on the space of functions of $(v_i,x_j)$.
The index $\lambda$ labels elements of a basis of solutions of the symmetry equations.
The number $N_{R_1R_2}^{R_3}\in {\mathbb{N}} \cup \{\infty\}$ of independent solutions is the \textbf{\boldmath fusion multiplicity}\index{fusion multiplicity}. 
In particular, the field $V_{\sigma_3}$ can appear in a $V_{\sigma_1}V_{\sigma_2}$ OPE only if $N_{R_1R_2}^{R_3}\neq 0$.

\begin{hyp}[\textbf{\boldmath Fusion product}\index{fusion product} or \textbf{\boldmath fusion rules}\index{fusion rules}]
 ~\label{ax:fp}
 There is a bilinear, commutative, associative product of representations, such that the decomposition of $R_1\times R_2$ into indecomposable representations is 
 \begin{align}
 R_1 \times R_2  = \sum_{R_3} N_{R_1R_2}^{R_3} R_3 \ . 
\label{rrnr}
\end{align}
\end{hyp} 
\noindent
In some cases, the fusion product can be constructed explicitly \cite{gab99}. However, all we will need is that it is commutative and associative. 

The fusion product $R_1\times R_2$ is said to have nontrivial multiplicities if $N_{R_1R_2}^{R_3}\geq 2$ for some $R_3$, and trivial multiplicities if $N_{R_1R_2}^{R_3}\in \{0,1\}$, in which case the sum over $\lambda$ in eq. \eqref{clcf} can be omitted.
A field is called a \textbf{\boldmath simple current}\index{simple current} if the corresponding representation $R$ is such that $R\times R'$ is indecomposable for any $R'$, so that $\sum_{R''} N_{RR'}^{R''} =1$. 
The fusion product may seem quite similar to a tensor product, but there is an essential difference: while the tensor product is a purely algebraic notion, the definition of the fusion product involves the state-field correspondence, and therefore the space on which the field theory lives. 

Using the decomposition \eqref{clcf} of the OPE coefficients, where we assume that $f_{R_1,R_2}^{R_3,\lambda}(v_i|x_j)$ is known, the 
associativity equation \eqref{cccc} reduces to an equation for the structure function $C_{R_1,R_2}^{R_3,\lambda}(x_1,x_2)$, and the sums over states $\sigma_s$ and $\sigma_t$ reduce to sums over representations $R_s$ and $R_t$.
If the symmetry algebra is large enough or the model simple enough, the number of representations in the spectrum can be small enough for the associativity equation to become tractable.
To summarize,
\begin{center}
\fbox{
\begin{minipage}{0.9\textwidth}
OPE coefficients obey linear equations from symmetry and quadratic equations \eqref{cccc} from consistency.
The numbers of OPE coefficients, consistency equations, and terms in these equations, are determined by the dimension of the spectrum and are therefore in general very large.
With the help of symmetry, these numbers can be reduced to the number of representations in the spectrum.
\end{minipage}
}
\end{center}


\subsection{So what is the Lagrangian of your model? \label{seclagr}}

In order to construct and to solve conformal field theories, we will only use the bootstrap approach.
In quantum field theory, this method is less widely used than the Lagrangian method, which is based on functional integrals over spaces of fields.
In two-dimensional conformal field theory, however, the bootstrap approach is particularly effective, while the Lagrangian method is often needlessly complicated, lacking in rigor, or downright not applicable. 
There are nevertheless cases when the Lagrangian method is useful, in particular for 
\begin{enumerate}
\item suggesting, and sometimes proving, the existence of conformal field theories,
\item  and analyzing their classical limits, when such limits exist. 
\end{enumerate}

In the Lagrangian method, correlation functions are represented as functional integrals
\begin{align}
 \left\langle\prod_{i=1}^n V_{\sigma_i}(x_i)\right\rangle = \int D\phi\ e^{\int dx L[\phi](x)} \ \prod_{i=1}^n \tilde{V}_{\sigma_i}[\phi](x_i)\ ,
\end{align}
where  
\begin{itemize}
 \item the integration variable is the fundamental field (or set of fields) $\phi(x)$,
\item the \textbf{\boldmath Lagrangian}\index{Lagrangian} $L[\phi](x)$ of the model is a functional of $\phi(x)$,
\item the functional $\tilde{V}_{\sigma_i}[\phi](x_i)$ of $\phi(x)$ corresponds to the field $ V_{\sigma_i}(x_i)$,
\item the integration measure $D\phi$ is usually characterized by axioms on functional integrals. 
\end{itemize}
An important advantage of the Lagrangian method is the existence of the Lagrangian itself, a relatively simple object which is not tied to any specific correlation function and encodes much information about the model.
The Lagrangian is the most common, but not the only object of this type: in certain integrable models or supersymmetric quantum field theories, much information is encoded in the geometry of a spectral curve.

In the Lagrangian method, we are thus in principle given all the correlation functions of a specific model from the start.
What we do not a priori know are the symmetry properties of the model.
Of course, we may try to choose the Lagrangian in order to ensure that certain symmetries are present.
However, the symmetries of the model also depend on the integration measure.
Axioms requiring functional integrals to behave as ordinary integrals often leave no choice for the integration measure, and 
it can happen that a transformation leaves the Lagrangian invariant, but changes the integration measure.
This transformation is then called anomalous, and is not a symmetry of the model.

Such an anomaly can also be described as a symmetry of the classical theory, which is not present in the corresponding quantum theory.
This is because the Lagrangian method can be interpreted as the quantization of the classical theory which is defined by the Lagrangian.
The classical theory consists in the dynamics of the fundamental field, subject to the equations of motion associated with the Lagrangian, 
\begin{align}
 \frac{\delta }{\delta \phi(x')} \int dx L[\phi](x) = 0 \ ,
\end{align}
 where $\frac{\delta}{\delta\phi(x') } $ is a functional derivative.
The integration measure then contains the additional information which is necessary for building a quantum theory from the classical theory. 

This contrasts with the bootstrap approach, which does not assume a classical theory to exist.
Models constructed with the bootstrap approach may nevertheless have one or several classical limits. (See Section \ref{seclld} for the case of Liouville theory.)

\section{Conformal symmetry in two dimensions \label{secconf}}

Our subject of two-dimensional conformal field theory is defined by the existence of a space-time symmetry, namely local conformal invariance. 
We consider a two-dimensional space, and assume it comes equipped with a \textbf{\boldmath metric}\index{metric}.
The metric plays very little role in conformal field theory, because conformal invariance will allow us to fix it once and for all.
But we need the metric in order to explain what conformal invariance is.
We assume that the metric has Euclidean signature, not considering the other option that it is Minkowskian.
The Euclidean signature brings important technical simplifications, and does not necessarily prevent the observables from having an interpretation in Minkowski space after analytic continuation.

\subsection{Global conformal transformations\label{secglob}}

Let us assume that the metric is the flat two-dimensional Euclidean metric, which we write in terms of complex coordinates $x=(z,\bar{z})$,
\begin{align}
 ds^2 = dz d\bar{z} \ .
\end{align}
A transformation $(z,\bar{z}) \mapsto (f(z),\overline{f(z)})$ leaves the metric invariant, provided $ds^2 = dfd\bar{f}$.  
Our metric is invariant under the familiar \textbf{\boldmath translations}\index{translation} and \textbf{\boldmath rotations}\index{rotation},
\begin{align}
f_\text{translation}(z) &= z+b \ ,
\\ 
f_\text{rotation}(z) &=a z \ , \ |a|=1\ ,
\end{align}
where $a$ and $b$ are complex constants.
Moreover, if we lift the restriction $|a|=1$ in rotations, we obtain transformations which do not leave the metric invariant, but rescale it by a factor of $|a|^2$.
For $a\in{\mathbb{R}}$, these transformations are called \textbf{\boldmath dilatations}\index{dilatation} or scale transformations,
\begin{align}
 f_\text{dilatation}(z) &= a z\ , \ a\in {\mathbb{R}}\ .
\end{align}
While the laws of physics are (mostly) invariant under translations and rotations, they are not invariant under dilatations, and the structures of matter and of the universe are strongly scale-dependent.
It is nevertheless interesting to study scale-invariant models, for at least two reasons.
Firstly, some particular systems are invariant under scale transformations, for instance certain materials at critical points.
Secondly, by rescaling a quantum field theory to very small or large scales in a controlled way, one often reaches a scale-invariant theory (called a fixed point of the renormalization group flow).
That new theory can be nontrivial, and helpful for the understanding of the original theory.

It may seem reasonable to study quantum field theories that are invariant under translations, rotations and dilatations. 
Surprisingly, many interesting systems have much more symmetry, which makes them accessible to the powerful methods that are the subject of this review.
In the absence of physically compelling reasons for these further symmetries, we will try to provide formal justifications.

A first formal consideration is that translations, rotations and dilatations are all \textbf{\boldmath conformal transformations}\index{conformal transformation}, that is transformations which preserve angles, and therefore which rescale the metric by a real factor.
But they are not the only conformal transformations: another one is the inversion
\begin{align}
 f_\text{inversion}(z) = \frac{1}{z}\ .
\end{align}
It may seem unwise to take this transformation as a symmetry, as it is singular at $z=0$.
This is however not a problem, if we enlarge our space with the addition of a point at $z=\infty$.
This actually amounts to compactifying the space, and working not on the complex plane but on the \textbf{\boldmath Riemann sphere}\index{Riemann sphere}.
This does not even prevent us from studying models on the complex plane, as such models are equivalent to models on the sphere, with one field inserted at $z=\infty$.
Combining the inversion with translations, rotations and dilatations, we obtain the group of the \textbf{\boldmath global conformal transformations}\index{global conformal transformation} of the Riemann sphere,
\begin{align}
 \boxed{f_\text{global conformal}(z)  = \frac{az+b}{cz+d}}\ ,
\end{align}
and this group is isomorphic to the group $PSL_2({\mathbb{C}})=\frac{SL_2({\mathbb{C}})}{{\mathbb{Z}}_2}$ of the complex matrices $g$ of size $2$ and determinant one where $g$ and $-g$ are identified, through the map
\begin{align}
 g = \left(\begin{array}{cc} a & b \\ c & d \end{array}\right) \in SL_2({\mathbb{C}}) \quad \longmapsto\quad f_g(z) = \frac{az+b}{cz+d}\ .
\label{gisl}
\end{align}
(See Exercise \ref{exoiso}.) 


\subsection{Local conformal transformations \label{secloc}}

Actually, any holomorphic function $h(z)$ defines a conformal transformation,
\begin{align}
 f_\text{local conformal}(z) = h(z) \ , \ h(z)\ \text{holomorphic}\ , 
\label{flc}
\end{align}
which transforms the metric into $dfd\bar{f} = |h'(z)|^2 dzd\bar{z}$, and is therefore angle-preserving.
One may object that the only holomorphic functions on the sphere are the functions $f_g$ \eqref{gisl} which encode the global conformal transformations.
And indeed, any further conformal transformation must have singularities, and cannot be one-to-one.
We could consider transformations that would be defined only on some subset of the Riemann sphere, where there would be no singularities.
We will adopt a different point of view, and interpret a singularity of $h(z)$ at $z=z_0$ as meaning that a field $V_\sigma(z_0)$ transforms non-trivially.
This makes sense not only with a correlation function $\left\langle V_{\sigma}(z_0)\cdots \right\rangle $ which manifestly involves a field at $z=z_0$, 
but also with arbitrary correlation functions.
We can indeed always assume the presence at $z_0$ of a trivial field, called the identity field, which can however become non-trivial after a conformal transformation is performed.
To summarize,
\begin{center}
\fbox{
\begin{minipage}{0.9\textwidth}
Global conformal transformations only move fields around, while local conformal transformations also modify them.
\end{minipage}
}
\end{center}
So, we assume that the symmetries include the infinitely many independent \textbf{\boldmath local conformal transformations}\index{local conformal transformation}, in addition to the global conformal transformations, which are parametrized by the six real coordinates of $PSL_2({\mathbb{C}})$.
Let us now describe the mathematical structure of the resulting space of all conformal transformations.
This space is an infinite-dimensional Lie group, which must include $PSL_2({\mathbb{C}})$.
For technical simplicity, we will instead describe the associated Lie algebra of infinitesimal transformations.
The structure of this algebra is worked out by considering transformations close to the identity, 
\begin{align}
 f_{\epsilon}(z) = z + \epsilon(z) \quad \text{with} \quad \epsilon(z) = \sum_{n\in{\mathbb{Z}}} \epsilon_n z^{n+1} \quad 
 \text{where} \quad \epsilon_n\in\mathbb{C}\ .
\label{sen}
\end{align}
To each transformation $f_\epsilon$ we associate an infinitesimal differential operator $D_\epsilon$ such that for any function $F(z)$ we have 
\begin{align}
 F(f_\epsilon(z)) = \left(1- D_\epsilon -\overline{D_\epsilon} \right)F(z) + O(\epsilon^2)\ ,
\label{ffe}
\end{align}
and we find
\begin{align}
 D_\epsilon = \sum_{n\in {\mathbb{Z}}} \epsilon_n\ell_n  \quad \text{where} \quad \boxed{\ell_n= -z^{n+1}{\frac{\partial}{\partial z}}} \ .
\label{elln}
\end{align}
The differential operators $(\ell_n)_{n\in {\mathbb{Z}}}$ generate the \textbf{\boldmath Witt algebra}\index{Witt algebra}, whose commutation relations are
\begin{align}
 \boxed{[\ell_n,\ell_m]=(n-m)\ell_{n+m}}\ .
\end{align}
Differential operators $D_\epsilon +\overline{D_\epsilon}$ that correspond to local conformal transformations are linear combinations (with real coefficients) of the operators
\begin{align}
 \ell_n + \bar\ell_n \quad , \quad i(\ell_n-\bar\ell_n) \ .
 \label{ilml}
\end{align}
Generators with $n\in\{-1,0,1\}$ correspond to global transformations, and the rest to local transformations. (See Exercise \ref{exomoz}.) 

The assumption of local conformal symmetry drastically restricts the dependence of the theory on the metric.
Let us restrict our attention to theories on compact \textbf{\boldmath Riemann surfaces}\index{Riemann surface}, where a Riemann surface is a two-dimensional orientable smooth manifold.
The topology of a compact Riemann surface is characterized by a natural number $g$ called the genus, which is the number of holes.
In the case $g=0$, the uniformization theorem states that all simply-connected compact Riemann surfaces are conformally equivalent. 
This implies that the observables of a conformal field theory on any such manifold can be obtained from their values on the sphere by a change of coordinates.
In the next simplest case $g=1$, manifolds are not all conformally equivalent, but any manifold with $g=1$ is conformally equivalent to a torus $\frac{{\mathbb{C}}}{{\mathbb{Z}}+\tau{\mathbb{Z}}}$ for some value of the
complex structure modulus $\tau \in {\mathbb{C}}$.
Similarly, for $g\geq 2$, a conformal field theory depends on the metric only through $3g-3$ complex structure moduli. 

Local conformal symmetry is a natural symmetry assumption in string theory, where the world-sheet metric is an unphysical variable, and in two-dimensional gravity, where we expect background independence.
The assumption is less natural in models of condensed-matter physics, where only flat metrics are usually considered.
In any case, theories with local conformal symmetry, which we will simply call conformal field theories, should be thought of as exceptional points in the vast and unchartered space of the \textbf{\boldmath global conformal field theories}\index{global conformal field theory}.
We will encounter a global conformal field theory in Section \ref{seclld}, namely the light asymptotic limit of Liouville theory.
Another example is the long-range Ising model. 


\subsection{The Virasoro algebra \label{secvir}}

We have studied the algebra of local conformal transformations, which acts on the geometry. 
We will now complexify and centrally extend that algebra, in order to obtain the symmetry algebra of conformal field theory, which acts on the spectrum. 
In quantum theories, symmetry algebras should be complex because spectrums are complex vector spaces. And symmetry algebras should have central extensions, because the action of a symmetry group on space, which obeys $g\cdot(g'\cdot x) = (gg')\cdot x$, needs only translate into a projective action on states, which obeys $g\cdot(g'\cdot|\sigma\rangle) = \lambda(g,g') (gg')\cdot |\sigma\rangle$ for some scalar factor $\lambda(g,g')$. 
But a projective action of a symmetry algebra is equivalent to an action of the corresponding centrally-extended algebra. 

Complexifying the algebra of local conformal transformations amounts to taking complex linear combinations of the generators \eqref{ilml}. So the complexified algebra has the complex basis $(\ell_n,\bar\ell_n)_{n\in\mathbb{Z}}$, and is the product of two commuting Witt algebras. Elements of the complexified algebras do not act on our complex plane $\mathbb{C}=\mathbb{R}^2$, where $z$ and $\bar z$ are conjugates of one another, but on the complexified complex plane ${\mathbb{C}}^2$, where $z$ and $\bar z$ are independent coordinates. 
We must however insist that the correlation functions, which are the $z$-dependent observables of the theory, do live on $\mathbb{C}$ and not on ${\mathbb{C}}^2$.
Differential operators such as $\frac{\partial}{\partial z}$, that act on functions on ${\mathbb{C}}^2$, will appear at intermediate steps of calculations, but correlation functions only involve functions such as $|z|$, that are well-defined on $\mathbb{C}$. 

The central extension of the Witt algebra is the 
\textbf{\boldmath Virasoro algebra}\index{Virasoro algebra} $\mathfrak{V}$.
Its generators are $(L_n)_{n\in {\mathbb{Z}}}$, and its commutation relations are 
\begin{align}
 \boxed{[L_n,L_m]=(n-m)L_{n+m} + \frac{c}{12} (n-1)n(n+1) \delta_{n+m,0}}\ .
\label{vir}
\end{align}
The parameter $c$ is called the \textbf{\boldmath central charge}\index{central charge}, and the central term $\frac{c}{12} (n-1)n(n+1) \delta_{n+m,0}$ should be understood as the coefficient of an extra generator, which commutes with all $L_n$.
It can be checked that these commutation relations define a Lie algebra, and that the Virasoro algebra is the only central extension of the Witt algebra. (See Exercise \ref{exovir}.) Notice that the presence of the central term does not affect the generators $L_{-1},L_0,L_1$ of global conformal transformations. 

Therefore, the symmetry algebra of conformal field theory is made of two commuting copies of the Virasoro algebra. It has
\begin{itemize}
 \item \textbf{\boldmath left-moving}\index{left-moving}, chiral or holomorphic
generators $L_n$,  and
\item  \textbf{\boldmath right-moving}\index{right-moving}, anti-chiral or antiholomorphic generators $\bar{L}_n$,
\end{itemize}
 with
$[L_n,\bar{L}_m]=0$.
We assume for simplicity that both Virasoro algebras have the same central charge, which is then called the central charge of the model:
\begin{align}
\renewcommand{\arraystretch}{1.3}
 \begin{tabular}{|c|c|c|c|}
 \hline
Notation &  Name & Generators &  Central\ charge
\\
\hline\hline
 $\mathfrak{V}$ & left-moving & $L_n$ & $c$
\\
\hline
$\overline{\mathfrak{V}}$ & right-moving & $\bar{L}_n$ & $c$
\\
\hline
$\mathfrak{V}\times \overline{\mathfrak{V}}$ & full & $(L_n,\bar{L}_m)$ & $(c,c)$
\\  
\hline
 \end{tabular}
\end{align}

\begin{hyp}[Symmetry algebra of two-dimensional conformal field theory]
 ~\label{ax:sa}
 We have a $\mathfrak{V}\times \overline{\mathfrak{V}}$ symmetry algebra, such that $L_n$ and $\bar{L}_n$ generate conformal transformations. 
\end{hyp} 
\noindent
The assumption about the geometrical interpretation of $L_n$ and $\bar{L}_n$ is important, as it is the only link between the symmetry algebra and the two-dimensional space.
Some conformal field theories have several Virasoro symmetry algebras, only one of which corresponds to conformal symmetry.
In the free boson theory, it is even possible to find Virasoro algebras with all possible values of the central charge. (See Section \ref{secaua}.)


\section{Basic consequences of conformal symmetry}

\subsection{Structure of the spectrum \label{secsots}}

We know that the spectrum is a representation of the 
$\mathfrak{V}\times \overline{\mathfrak{V}}$ symmetry algebra.
Let us make further assumptions on its structure.

\begin{hyp}[Structure of the spectrum]
 ~\label{ax:sots}
 The spectrum decomposes into irreducible, factorizable representations of $\mathfrak{V}\times \overline{\mathfrak{V}}$, where $L_0+\bar L_0$ is bounded from below.
\end{hyp} 
\noindent
Let us comment on the three parts of this axiom:
\begin{itemize}
 \item 
 Factorizable representations are of the type $R\otimes \bar{R'}$, where $R$ and $R'$ are representations of $\mathfrak{V}$, and the bar in $\overline{\mathfrak{V}}$ and $\bar{R'}$ distinguishes right-moving from left-moving objects. 
Then the decomposition \eqref{somr} takes the form
\begin{align}
 \boxed{S = \bigoplus_{(R,R')\in \text{Rep}(\mathfrak{V})^2} m_{R,R'} R\otimes \bar{R'}}\ ,
\label{sorr}
\end{align}
where $\text{Rep}(\mathfrak{V})$ is some set of irreducible representations of the Virasoro algebra.
% Many, but not all interesting spectrums are of this type: for example, the spectrum of the $GL_{1|1}$ WZW model involves indecomposable, non-factorizable representations \cite{ss05}. -- This example involves an extended symmetry algebra.
\item
The assumption that the spectrum decomposes into irreducible representations excludes indecomposable, reducible representations. 
There exist \textbf{\boldmath logarithmic conformal field theories}\index{logarithmic conformal field theory} whose spectrums involve such representations, where moreover $L_0$ is not diagonalizable. 
But we will not consider such theories (except in Exercise \ref{exolog}).
\item 
By $L_0+\bar L_0$ being bounded from below, we mean that the real parts of its eigenvalues are bounded from below, which implies that the real parts of the eigenvalues of $L_0$ are bounded from below in each $R\in\text{Rep}(\mathfrak{V})$. 
This is motivated by the interpretation of the dilatation generator $L_0+\bar L_0$ as the Hamiltonian, if we consider the radial coordinate $|z|$ as the Euclidean time. 
\end{itemize}

Two important special cases are
\begin{itemize}
\item \textbf{\boldmath rational models}\index{rational model}, where the spectrum involves only finitely many irreducible representations,
 \item \textbf{\boldmath diagonal models}\index{diagonal model}, where the spectrum is of the type $S=\bigoplus_{R\in \text{Rep}(\mathfrak{V})} m_R R\otimes \bar{R}$, i.e. $m_{R,R'}\neq 0 \Rightarrow R=R'$ in eq. \eqref{sorr}.
\end{itemize}

\begin{hyp}[Closure under fusion]
~\label{ax:cuf}
If the irreducible representations $R_1$ and $R_2$ of $\mathfrak{V}$ appear in the spectrum, then any representation $R_3$ with a non-vanishing fusion multiplicity $N_{R_1R_2}^{R_3}\neq 0$ also appears in the spectrum. 
\end{hyp} 
\noindent
In other words, we assume that if Virasoro symmetry allows a representation of $\mathfrak{V}$ to appear in an OPE, then that representation does appear.
There are two similar-looking axioms, which should not be adopted:
\begin{itemize}
 \item Closure under fusion of $\mathfrak{V}\times \overline{\mathfrak{V}}$ representations, instead of $\mathfrak{V}$ representations, would rule out most non-trivial models, and in particular diagonal models. 
\item Closure under tensor product, instead of fusion, would not make sense, as the tensor product of two representations of $\mathfrak{V}_c$ is a representation of $\mathfrak{V}_{2c}$ -- central charges behave additively in a tensor product. 
\end{itemize}

Let us further discuss the roles of the operators $L_0$ and $\bar L_0$. Their eigenvalues are called \textbf{\boldmath conformal dimensions}\index{conformal dimension} or conformal weights. If 
two states $v_1$ and $v_2$ are related by the action of Virasoro generators,
\begin{align}
 v_2 = \left(\prod_i L_{n_i}\right) v_1\ ,
\label{vovt}
\end{align}
and if $v_1$ is an $L_0$-eigenstate with conformal dimension $\Delta_1$, then $v_2$ is also an eigenstate with the conformal dimension
\begin{align}
 \Delta_2 = \Delta_1 - \sum_i n_i\ ,
\label{ddsn}
\end{align}
as a consequence of the Virasoro algebra's commutation relations \eqref{vir}. Therefore, in any indecomposable representation of the Virasoro algebra, all conformal dimensions differ by integers. (See Exercise \ref{exodiffint}.)

For a quantum field theory to have a probabilistic interpretation, 
we should assume the spectrum to be a Hilbert space, i.e. to have a positive definite Hermitian form. 
In conformal field theory, we are only interested in Hermitian forms that are compatible with the action of the symmetry algebra, in the sense that Hermitian conjugation acts linearly on $\mathfrak{V}$ and $\overline{\mathfrak{V}}$. 
Interpreting the dilatation generator $L_0+\bar L_0$ as the Hamiltonian, we assume that it is self-adjoint.
This implies 
\begin{align}
 L^\dagger_n = L_{-n} \quad , \quad \bar L_n^\dagger = \bar L_{-n}\ ,
\label{ldn}
\end{align}
(see Exercise \ref{exolnd}), and it follows that
\begin{align}
 c\in {\mathbb{R}}\ .
\label{cir}
\end{align}
It also follows that the Hermitian form is compatible with the decomposition \eqref{sorr} of the spectrum as a sum of $\mathfrak{V}\times \overline{\mathfrak{V}}$ representations, in the sense that two different irreducible representations must be orthogonal to each other.
So the the positivity of the Hermitian form can be examined within each representation.
A representation of the Virasoro algebra is called \textbf{\boldmath unitary}\index{unitary} if it has a positive definite Hermitian form such that 
$L^\dagger_n = L_{-n}$, and a model whose spectrum is unitary is itself called unitary. 

Finally, let us illustrate the power of local conformal symmetry by thinking of a model in terms of global conformal symmetry only. 
We then decompose each Virasoro representation $R$ into representations of the $\mathfrak{sl}_2$ algebra of global conformal transformations with generators $(L_0,L_1,L_{-1})$,
\begin{align}
 R=\bigoplus_{n\in{\mathbb{N}}} m_{R,n} D_{\Delta+n}\ ,
\label{rbd}
\end{align}
where $m_{R,n}\in {\mathbb{N}}$ is a multiplicity, $\Delta$ is the lowest $L_0$-eigenvalue of the indecomposable Virasoro representation $R$, and $D_{\Delta+n}$ is a representation of $\mathfrak{sl}_2$ whose lowest $L_0$-eigenvalue is $\Delta+n$.
(See Exercise \ref{exodis}.)
The above decomposition is universal data of the Virasoro algebra, and 
model-dependent information from the point of view of global conformal symmetry.
This shows how constraining local conformal symmetry is, and how much more freedom there is in the spectrum of global conformal field theories.
In particular, in a global conformal field theory, there is no reason for the spectrum to contain series of
$\mathfrak{sl}_2$ representations, whose lowest $L_0$-eigenvalues differ by integers. 


\subsection{Conformal bootstrap}

The application of the bootstrap approach to conformal field theories, called the \textbf{conformal bootstrap}\index{conformal bootstrap}, 
is particularly powerful in two dimensions.
This is because the algebra of conformal transformations is infinite-dimensional, 
so that the spectrum can be decomposed into a small number of large representations.
Moreover, the factorization of the symmetry algebra into two copies of the Virasoro algebra, and the decomposition of the spectrum into factorizable representations,
imply that symmetry equations factorize into $z$-dependent equations from the left-moving Virasoro algebra, and $\bar{z}$-dependent equations from the right-moving Virasoro algebra.
It follows that all universal quantities, for example $f_{R_1,R_2}^{R_3,\lambda}(v_i|x_j)$ from \eqref{clcf}, can be factorized into $z$-dependent and $\bar{z}$-dependent functions. 
This is called \textbf{\boldmath holomorphic factorization}\index{holomorphic factorization}, where the term ``holomorphic''
should be understood as \textbf{\boldmath locally holomorphic}\index{locally holomorphic}: the $z$-dependent factors are supposed to be $\bar{z}$-independent, but they can have singularities such as poles and branch cuts, like the function $\sqrt{z}$.
We will see in more detail in Section \ref{secaco} how holomorphic factorization simplifies the condition \eqref{cccc} of OPE associativity.

In two-dimensional conformal field theory, the assumption of the existence of an OPE has a natural generalization: the assumption that on any closed contour $C$, one can insert a decomposition of the identity operator,
\begin{align}
 \mathbf{1} = \sum_{\sigma\in S} |\sigma \rangle \langle \sigma| \ ,
\label{oss}
\end{align}
where the sum runs over an orthonormal basis of the spectrum.
Let us schematically explain why this implies the existence of an OPE.
Considering a contour $C$ around the positions $x_1,x_2$ of two fields $V_{\sigma_1}(x_1),V_{\sigma_2}(x_2)$, and inserting the decomposition of the identity, we obtain
\begin{align}
V_{\sigma_1}(x_1)V_{\sigma_2}(x_2)  =  \sum_{\sigma\in S} \left\langle \sigma \left| V_{\sigma_1}(x_1)V_{\sigma_2}(x_2) \right. \right\rangle  V_{\sigma}(x_2) \ ,
\end{align}
where we used the state-field correspondence in a cavalier way: we replaced the field $V_{\sigma_1}(x_1)V_{\sigma_2}(x_2)$ with the corresponding state $|V_{\sigma_1}(x_1)V_{\sigma_2}(x_2)\rangle$, and the state $|\sigma\rangle$ with the corresponding field $V_{\sigma}(x_2)$.
This can be drawn as follows:
\begin{align}
\newcommand{\myoval}[2]{\draw[dashed] (#1, #2 + 2) to [out = 0, in = 0] (#1, #2 - 2); 
			\draw (#1, #2 + 2) to [out = 180, in = 180] (#1, #2 - 2);}
\begin{tikzpicture}[scale = .45, baseline=(current  bounding  box.center)]
  \myoval{0}{0};
  \myoval{4}{0};
  \draw (0, 2) -- (6, 2);
  \draw (0, -2) -- (6, -2);
  \draw[dashed] (0, 2) -- (-2, 2);
  \draw[dashed] (0, -2) -- (-2, -2);
  \draw (6, 2) arc (90 : -90 : 2);
  \node at (2.4, 0) {$C$};
  \filldraw (7.4, 1) circle [radius = 3pt] node [left] {$V_{\sigma_1}$};
  \filldraw (7.4, -1) circle [radius = 3pt] node [left] {$V_{\sigma_2}$};
 \end{tikzpicture}
\quad
= \ \ \sum_{\sigma\in S} 
\quad
\begin{tikzpicture}[scale = .45, baseline=(current  bounding  box.center)]
  \myoval{0}{0};
  \draw[dashed] (0, 2) -- (-2, 2);
  \draw[dashed] (0, -2) -- (-2, -2);
  \draw (0, 2) -- (2, 2);
  \draw (0, -2) -- (2, -2);
  \draw (2, 2) arc (90 : -90 : 2);
  \filldraw (3.7, 0) circle [radius = 3pt] node [left] {$V_{\sigma}$};
  \draw (8, 0) circle (2);
  \filldraw (9.4, 1) circle [radius = 3pt] node [left] {$V_{\sigma_1}$};
  \filldraw (9.4, -1) circle [radius = 3pt] node [left] {$V_{\sigma_2}$};
  \filldraw (6.3, 0) circle [radius = 3pt] node [right] {$V_{\sigma}$};
 \end{tikzpicture}
\end{align}
We thus obtain an OPE whose coefficient $\left\langle \sigma \left| V_{\sigma_1}(x_1)V_{\sigma_2}(x_2) \right. \right\rangle $ is essentially a three-point function.
We will see the relation between OPE coefficients and three-point functions in more detail in Section \ref{secope}. 

Inserting the decomposition of the identity \eqref{oss} on a contour $C$ amounts to cutting the space into two pieces, and in each piece replacing the resulting hole with a puncture -- an insertion of a field $V_{\sigma}(x)$ for some $x$.
If we view the space near the contour $C$ as a cylinder, this can be drawn as follows:
\begin{align}
\newcommand{\myoval}[2]{\draw[dashed] (#1, #2 + 2) to [out = 0, in = 0] (#1, #2 - 2); 
			\draw (#1, #2 + 2) to [out = 180, in = 180] (#1, #2 - 2);}
\begin{tikzpicture}[scale = .45, baseline=(current  bounding  box.center)]
  \myoval{0}{0};
  \myoval{4}{0};
  \myoval{8}{0};
  \node at (2.4, 0) {$C$};
  \draw (0, 2) -- (8, 2);
  \draw (0, -2) -- (8, -2);
  \draw[dashed] (0, 2) -- (-2, 2);
  \draw[dashed] (0, -2) -- (-2, -2);
  \draw[dashed] (8, 2) -- (10, 2);
  \draw[dashed] (8, -2) -- (10, -2);
 \end{tikzpicture}
\quad
= \ \ \sum_{\sigma\in S} 
\quad
\begin{tikzpicture}[scale = .45, baseline=(current  bounding  box.center)]
  \myoval{0}{0};
  \myoval{8}{0};
  \draw[dashed] (0, 2) -- (-2, 2);
  \draw[dashed] (0, -2) -- (-2, -2);
  \draw[dashed] (8, 2) -- (10, 2);
  \draw[dashed] (8, -2) -- (10, -2);
  \draw (1.5, 2) arc (90 : -90 : 2);
  \draw (6.5, -2) arc (90 : -90: -2);
  \draw (0, 2) -- (1.5, 2);
  \draw (0, -2) -- (1.5, -2);
  \draw (6.5, 2) -- (8, 2);
  \draw (6.5, -2) -- (8, -2);
  \filldraw (4.8, 0) circle [radius = 3pt] node [right] {$V_{\sigma}$};
  \filldraw (3.2, 0) circle [radius = 3pt] node [left] {$V_{\sigma}$};
\end{tikzpicture}
\label{cscc}
\end{align}
In the case of a topologically trivial contour $C$, this equality amounts to using OPEs for replacing all fields within $C$ with one field $V_\sigma(x)$.
If on the other hand $C$ is a non-contractible cycle, then this equality is nontrivial even in the absence of fields.
If we studied a model on a torus with complex modulus $\tau$, then we could obtain a nontrivial constraint on the spectrum by applying eq. \eqref{cscc} to the partition function (the zero-point function) using two topologically inequivalent contours.
The study of constraints of this type is called the \textbf{\boldmath modular bootstrap}\index{modular bootstrap}. 

We will only consider conformal field theories on the sphere, which are consistent if they have commutative, associative OPEs. For consistency on arbitrary Riemann surfaces, we would need to impose the further condition that torus one-point functions are invariant under modular transformations \cite{ms89b}.


\subsection{Sketching the space of simple models \label{secmomo}}

After discussing the general properties of two-dimensional conformal field theory, we will now describe some simple models which are known to satisfy the consistency conditions of the conformal bootstrap.
These simple models also turn out to be the most commonly encountered in applications.  

We first introduce diagonal models, where representations of $\mathfrak{V}\times \overline{\mathfrak{V}}$ have multiplicities no higher than one:
\begin{itemize}
 \item For any value $c\in\mathbb{C}$ of the central charge, \textbf{\boldmath Liouville theory}\index{Liouville theory} 
has a diagonal spectrum that is made of a continuum of representations.
Liouville theory is unitary if $c\geq 1$. 
\item For any $c\in\mathbb{C}$, the \textbf{\boldmath generalized minimal model}\index{generalized minimal model} has a diagonal spectrum that is made of a discrete infinity of representations.
\item \textbf{\boldmath A-series minimal models}\index{A-series minimal model} are diagonal, rational models that exist for central charges of the type
\begin{align}
 c = 1 - 6 \frac{(p-q)^2}{pq}  \quad \text{with} \quad \left\{\begin{array}{l}  p,q \ \text{coprime  integers}\ , \\ 2\leq p<q\ , \end{array}\right.  
\label{cpq}
\end{align}
in particular $c <1$.
There are $\frac{(p-1)(q-1)}{2}$ distinct representations in the spectrum.
The model is unitary if $q=p+1$, then $c=1-\frac{6}{p(p+1)}=0,\frac12,\frac{7}{10},\cdots$.
\end{itemize}
Let us locate these models in the $c$-complex plane, with unitary models signalled by more intense colors:
\begin{align}
 \begin{tikzpicture}[scale = 4.5, baseline=(current  bounding  box.center)]
 \filldraw [blue!50!red, opacity = .15] (2.15, -.3) -- (2.15, .75) -- (-.6, .75) -- (-.6, -.3) -- cycle;
 \node [draw = red, fill = red!15, right] at (-.5, .65) {Liouville theory};
 \node [draw = blue, fill = blue!15, right] at (-.5, .49) {Generalized minimal models};
 \node[draw = green!70!black, fill = green!16!black!7, right] at (-.5, .12) {Minimal models};
 %\node[below] at (1.6, -.05) {Liouville theory};
  \filldraw [red] (.98, -.02) -- (.98, .02) -- (2.15, .02) -- (2.15, -.02) -- cycle;
  \filldraw [green!70!black, opacity = .15] (-.6, -.02) -- (-.6, .02) -- (.98, .02) -- (.98, -.02) -- cycle;
 \foreach \p in {2,...,20}
  {
  \draw [green!70!black, thick] ({1-6/(\p*(\p+1))}, -.03) -- ({1-6/(\p*(\p+1))}, .03);
  }
  \node [below] at (0, -.02) {$0$};  \node [below] at (.99, -.02) {$1$};
  \draw[-latex] (-.6, 0) -- (2.2, 0) node [below right] {$c$};
\end{tikzpicture}
\end{align}
Other simple models include:
\begin{itemize}
 \item the \textbf{\boldmath linear dilaton theory}\index{linear dilaton theory}, which like Liouville theory has a diagonal, continuous spectrum and is defined for any $c\in {\mathbb{C}}$, being unitary if $c\geq 1$.
The difference with Liouville theory is that the symmetry algebra is larger than $\mathfrak{V}\times \overline{\mathfrak{V}}$, so that representations of $\mathfrak{V}\times \overline{\mathfrak{V}}$ appear with multiplicity two in the spectrum, and the correlation functions are much simpler.
 \item 
(Virasoro) \textbf{\boldmath minimal models}\index{minimal model} are by definition rational models, and beyond the A-series there exist two other series, called the 
D- and E-series, which are not diagonal.
The corresponding values of the central charge are still of the type of eq. \eqref{cpq}.
\end{itemize}
Therefore,
the properties of conformal field theories, starting with their very existence, crucially depend on the value of the central charge $c$ of the underlying Virasoro algebra.
In the case of unitary theories, we observe that the size of the spectrum (as measured by the number of representations) increases with $c$, from the $c=0$ minimal model whose spectrum contains only one representation, to $c\geq 1$ Liouville theory whose spectrum contains infinitely many.
The central charge is actually additive: given two theories with spectrums $S$ and $S'$ and central charges $c$ and $c'$, there is a natural product theory with central charge $c+c'$ and spectrum $S\otimes S'$.
Moreover, for any rational theory which is consistent on a torus, 
the behaviour of the number $N(\Delta)$ of states with conformal dimension $\Delta$ is given by 
\begin{align}
\text{Cardy's formula:} \qquad \log N(\Delta) \underset{\Delta\to \infty}{\propto} \sqrt{c \Delta} \ ,
% Reference: see Wikipedia
\label{nds}
\end{align}
which quantitatively shows how the central charge $c$ controls the size of the spectrum.
It can be checked that Cardy's formula is compatible with the additivity of the central charge. (See Exercise \ref{exoacf}.)

\section{Exercises}


\begin{exo}[Irreducible and indecomposable representations] 
~\label{exoirr}
Consider the algebra with one generator $A$ such that $A^2 = 0$.
Consider a two-dimensional representation $R$ with a basis $(v_1,v_2)$ such that $Av_1=v_2$.
Write the matrix of $A$ in the basis $(v_1,v_2)$.
Show that $R$ is indecomposable, but not irreducible. 
\end{exo}

\begin{exo}[Associativity in a tensor category]
 ~\label{exoten}
Consider a set of objects $R_i$ with two binary operations $\oplus$ (addition) and $\otimes$ (multiplication), such that 
\begin{align}
 R_i \otimes R_j = \bigoplus_k c_{ij}^k R_k\ ,
\end{align}
where $c_{ij}^k$ is a number.
Assuming the objects $R_i$ are linearly independent, show that the associativity of the multiplication $\otimes$ amounts to a quadratic condition on the coefficients $c_{ij}^k$,
\begin{align}
 \sum_m c_{ij}^m c_{mk}^\ell = \sum_n c_{in}^\ell c_{jk}^n\ .
\end{align}
\end{exo}

\begin{exo}[Group of global conformal transformations]
 ~\label{exoiso}
Show that the map \eqref{gisl} is a group morphism whose kernel is the center of $SL_2({\mathbb{C}})$.
Show that the group of global conformal transformations of the sphere is isomorphic to $PSL_2({\mathbb{C}})$. 
\end{exo}

\begin{exo}[Algebra of infinitesimal global conformal transformations]
 ~\label{exomoz}
Show that the generators \eqref{ilml} with $n\in\{-1,0,1\}$ correspond to infinitesimal global conformal transformations.
To do this, expand the map $f_g$ of eq. \eqref{gisl} near the identity, following eq. \eqref{sen}.
\end{exo}


\begin{exo}[Central term of the Virasoro algebra]
~\label{exovir}
 Show that the commutation relations \eqref{vir} of the Virasoro algebra define a Lie algebra, which is the only possible central extension of the Witt algebra.
To do this, consider commutation relations of the type
\begin{align}
 [L_n,L_m] =(n-m)L_{n+m} + f(n,m) C  \quad , \quad [C,L_n]=0\ ,
\end{align}
where $C$ is a central generator and $f(n,m)$ an arbitrary antisymmetric function.
Show that these commutation relations obey the Jacobi identities if and only if 
\begin{align}
 f(n,m) = \lambda (n^3-n)\delta_{m+n,0} + (n-m)g(n+m)\ ,
\end{align}
for some constant $\lambda$ and function $g(n)$.
Observe that the second term can be absorbed by the redefinition $L_n\mapsto L_n-g(n)C$.
\end{exo}

\begin{exo}[Spectrum of $L_0$ in an indecomposable representation]
 ~\label{exodiffint}
Show that the eigenvalues of $L_0$ in an indecomposable representation $R$ of the Virasoro algebra differ by integers.
To do this, use the decomposition $R=\oplus_\Delta R_\Delta$ where $R_\Delta$ is the generalized eigenspace associated to the eigenvalue $\Delta$.
Given any value of $\Delta$, show that  $\oplus_{n\in{\mathbb{Z}}} R_{\Delta+n}$ is a subrepresentation, and conclude. 
\end{exo}

\begin{exo}[Hermitian conjugates of Virasoro generators]
 ~\label{exolnd}
Assuming that there is a Hermitian form such that $L_0^\dagger = L_0$, and that $L_n^\dagger$ belongs to the Virasoro algebra, show that $L_n^\dagger = L_{-n}$. To do this, use the Virasoro commutation relations \eqref{vir}, and the identity $[A,B]^\dagger = -[A^\dagger, B^\dagger]$. Show that $L_n^\dagger = \lambda_n L_{-n}$ for some coefficients $\lambda_n$, and that there is a simple redefinition of $L_n$ such that $\lambda_n=1$.
\end{exo}

\begin{exo}[Comparing Virasoro and $\mathfrak{sl}_2$ representations]
 ~\label{exodis}
Consider the $\mathfrak{sl}_2$ algebra with generators $(L_0,L_1,L_{-1})$, and a vector $|v\rangle$ such that $L_1|v\rangle = 0 $ and $L_0|v\rangle = \Delta |v\rangle$.
Repeatedly acting with $L_{-1}$ on $|v\rangle$, show that you obtain a representation of $\mathfrak{sl}_2$, where the eigenvalues of $L_0$ belong to $\Delta+{\mathbb{N}}$, and that this representation is irreducible if $\Delta\notin -\frac12 \mathbb{N}$.
If $R$ is an indecomposable representation of the Virasoro algebra where $L_0$ is diagonalizable with eigenvalues in $\Delta_0+\mathbb{N}$ for $\Delta_0\notin\frac12 \mathbb{Z}$, show that $R$ can be decomposed into irreducible $\mathfrak{sl}_2$ representations as in eq. \eqref{rbd}.
\end{exo}


\begin{exo}[Number of states and additivity of the central charge]
 ~\label{exoacf} 
Show that Cardy's formula \eqref{nds} is compatible with the additivity of the central charge.
To do this, construct the action of the Virasoro algebra on the spectrum $S\otimes S'$ of the product theory by 
\begin{align}
 L_n^\text{product} = L_n\otimes 1' + 1\otimes L_n'\ ,
\end{align}
where $L_n$ and $L_n'$ act on $S$ and $S'$ respectively.
Check the relation $c^\text{product} = c+c'$, and show $\Delta^\text{product} = \Delta+\Delta'$.
Assuming that Cardy's formula holds for $S$ and $S'$, show that computing the large $\Delta$ behaviour of the number of states $N^\text{product}(\Delta)$ in the product theory amounts to finding the maximum of the function $f(\Delta') = \sqrt{c\Delta'} +\sqrt{c'(\Delta-\Delta')}$.
Conclude that Cardy's formula holds for $S\otimes S'$.
\end{exo}



\chapter{From representation theory to differential equations \label{secccs}}

This chapter is devoted to studying the linear equations that symmetry constraints impose on correlation functions.
Such equations depend on the action of the symmetry algebra on the fields -- in mathematical terms, on the representations to which the corresponding states belong. 

\section{Representations of the Virasoro algebra \label{secrep}}

\subsection{Highest-weight representations}

According to Axiom \ref{ax:sots}, the spectrum can be decomposed into irreducible Virasoro representations, where $L_0$ is bounded from below. 
Let us study the structure of a representation $R$ of this type. 
Let $|\Delta\rangle$ be an $L_0$-eigenstate for the lowest $L_0$-eigenvalue $\Delta$ in $R$.
Since acting with $L_{n>0}$ decreases $L_0$-eigenvalues (see eq. \eqref{ddsn}), $|\Delta\rangle$ must be a \textbf{\boldmath primary state}\index{primary state}, that is
\begin{align}
 \boxed{\left\{\begin{array}{l}  L_{n>0}|\Delta\rangle = 0\ , \\ L_0 |\Delta\rangle = \Delta |\Delta\rangle\ .\end{array}\right. }
\label{lvlv}
\end{align}
Since $R$ is irreducible, it coincides with the subrepresentation $U(\mathfrak{V})|\Delta\rangle$ that is generated by $|\Delta\rangle$. Here we introduced the universal enveloping algebra $U(\mathfrak{V})$ of the Virasoro algebra, i.e. the associative algebra that is generated by the Virasoro generators $L_n$.
Since $|\Delta\rangle$ is a primary state, it is enough to consider the algebra $U(\mathfrak{V}^+)$ of the \textbf{\boldmath creation operators}\index{creation operator} that is generated by the creation modes $\{L_n\}_{n<0}$, 
\begin{align}
 R = U(\mathfrak{V})|\Delta\rangle =U(\mathfrak{V}^+)|\Delta\rangle\ .
\label{ruv}
\end{align}
(See Exercise \ref{exospan}.)
Representations of this type are called \textbf{\boldmath highest-weight representations}\index{highest-weight representation}.
A state of $R$ of the type $U|\Delta\rangle$ with $U\in U(\mathfrak{V}^+)$ is called a \textbf{\boldmath descendent state}\index{descendent state} if it is linearly independent from $|\Delta\rangle$.

The highest-weight representation $R$
comes with a natural surjective map
\begin{align}
\begin{array}{cclcl}
 \varphi_R & : & U(\mathfrak{V}^+) & \rightarrow & R 
\\
 &  & U & \mapsto & U|\Delta\rangle \ .
\end{array}
\label{pur}
\end{align}
Let us introduce a basis $\mathcal{L}$ of $U(\mathfrak{V}^+)$, which is parametrized by the ordered $p$-uples $(-n_1,\cdots -n_p)$ of decreasing, strictly negative integers:
\begin{align}
\mathcal{L} =   \left\{ L_{-n_1} \cdots L_{-n_p}  \right\}_{1\leq n_1\leq n_2\leq \cdots n_p} \ .
\label{lels}
\end{align}
The natural integer
\begin{align}
 N=\left|L_{-n_1} \cdots L_{-n_p}\right|=\sum_{i=1}^p n_i \ ,
\label{nsn}
\end{align}
is called the \textbf{level}\index{level (descendent state)} of the basis element $L_{-n_1} \cdots L_{-n_p}$, and also of the corresponding state $L_{-n_1} \cdots L_{-n_p}|\Delta\rangle$ in a highest-weight representation.
The conformal dimension of such a state is then $\Delta+N$. 

The dimension of the level-$N$ subspace of $U(\mathfrak{V}^+)$ is the number $p(N)$ of partitions of $N$.
The basis of $U(\mathfrak{V}^+)$ up to the level $N=5$ can be plotted as follows: 
\begin{align}
 \begin{tikzpicture}[scale = .3, baseline=(current  bounding  box.center)]
  \draw[-latex, very thick] (20, 0) -- (20, -33) node [right] {$N$};
  \foreach \x in {0, ..., 5}
  {
  \draw [dotted] (-20, {-6*\x}) -- (20, {-6*\x}) node [right] {${\x}$};
  }
  \node[fill = white] at (0, 0) (0) {$1$};
  \node[fill = white] at (-3.6,-6) (1) {$L_{-1}$};
  \node[fill = white] at (-7.2, -12) (11) {$L_{-1}^2$};
  \node[fill = white] at (-10.8, -18) (111) {$L_{-1}^3$};
  \node[fill = white] at (-14.4, -24) (1111) {$L_{-1}^4$};
  \node[fill = white] at (-18, -30) (11111) {$L_{-1}^5$};
  \node[fill = white] at (0,-12) (2) {$L_{-2}$};
  \node[fill = white] at (-4,-18) (12) {$L_{-1}L_{-2}$};
  \node[fill = white] at (-8,-24) (112) {$L_{-1}^2L_{-2}$};
  \node[fill = white] at (-12,-30) (1112) {$L_{-1}^3L_{-2}$};
  \node[fill = white] at (-2,-24) (22) {$L_{-2}^2$};
  \node[fill = white] at (-6,-30) (122) {$L_{-1}L_{-2}^2$};
  \node[fill = white] at (6,-18) (3) {$L_{-3}$};
  \node[fill = white] at (3,-24) (13) {$L_{-1}L_{-3}$};
  \node[fill = white] at (0,-30) (113) {$L_{-1}^2L_{-3}$};
  \node[fill = white] at (6,-30) (23) {$L_{-2}L_{-3}$};
  \node[fill = white] at (12,-24) (4) {$L_{-4}$};
  \node[fill = white] at (12,-30) (14) {$L_{-1}L_{-4}$};
  \node[fill = white] at (18,-30) (5) {$L_{-5}$};
  \draw[-latex] (0) -- (1);
  \draw[-latex] (1) -- (11);
  \draw[-latex] (11) -- (111);
  \draw[-latex] (111) -- (1111);
  \draw[-latex] (1111) -- (11111);
  \draw[-latex] (0) -- (2);
  \draw[-latex] (0) -- (3);
  \draw[-latex] (0) -- (4);
  \draw[-latex] (0) -- (5);
  \draw[-latex] (2) -- (12);
  \draw[-latex] (12) -- (112);
  \draw[-latex] (112) -- (1112);
  \draw[-latex] (2) -- (22);
  \draw[-latex] (22) -- (122);
  \draw[-latex] (3) -- (13);
  \draw[-latex] (13) -- (113);
  \draw[-latex] (4) -- (14);
  \draw[-latex] (3) -- (23);
 \end{tikzpicture}
\end{align}
In this diagram, each arrow stands for the action of a Virasoro generator $L_n$ with $n<0$.
Acting with generators that are not depicted on the diagram would produce linear combinations of our basis states, for example $L_{-2}L_{-1} = L_{-1}L_{-2} - L_{-3}$.

Our basis \eqref{lels}, while convenient for enumerating the states, is not distinguished by any particularly useful property.
Other bases can be used, starting with the ``reverse-ordered'' basis $\{ L_{-n_1} \cdots L_{-n_p} \}_{n_1\geq n_2\geq \cdots n_p\geq 1} $.
It can be tempting to use the fact that the two operators $\{L_{-1},L_{-2}\}$ algebraically generate $\{L_{n}\}_{n<0}$, and to consider $\{\prod_{i=1}^p L_{-n_i}\}_{n_i\in\{1,2\}}$.
While this set does span $U(\mathfrak{V}^+)$, it however does not provide a basis. (See Exercise \ref{exoot}.)

\subsection{Verma modules and degenerate representations \label{secvm}}

We define the \textbf{\boldmath Verma module}\index{Verma module} $\mathcal{V}_\Delta$ with conformal dimension $\Delta$ as the highest-weight representation which contains a primary state $|\Delta\rangle$ with conformal dimension $\Delta$, and which is linearly isomorphic to $U(\mathfrak{V}^+)$ via the map $\varphi_{\mathcal{V}_\Delta}$ of eq. \eqref{pur}.
In other words, $\mathcal{V}_\Delta$ is the representation whose basis is given by the states  $\left\{ L_{-n_1} \cdots L_{-n_p}|\Delta\rangle\right\}_{1\leq n_1\leq n_2\leq \cdots n_p}$.
Therefore, $\mathcal{V}_\Delta$ is the largest possible highest-weight representation with lowest conformal dimension $\Delta$. 

Any  highest-weight representation $R$ that is not a Verma module is called a \textbf{\boldmath degenerate representation}\index{degenerate representation}.
If $\Delta$ is the conformal dimension of the highest-weight state of $R$, we have a natural surjective morphism of representations from $\mathcal{V}_\Delta$ to $R$,
\begin{align}
\varphi_R \varphi_{\mathcal{V}_\Delta}^{-1}\ : \  \mathcal{V}_\Delta\ \rightarrow\ R \ .
\end{align}
Therefore, $R$ is a coset of $\mathcal{V}_\Delta$ by some subrepresentation $R'$,
\begin{align}
 R = \frac{\mathcal{V}_\Delta}{R'}\ .
\label{rvrp}
\end{align}
In other words, a degenerate representation is associated to a nontrivial subrepresentation of a Verma module.
Now, in any nontrivial subrepresentation of a highest-weight representation, the $L_0$ eigenvalues are bounded from below, and there is therefore a primary state $|\chi\rangle$.
This primary state $|\chi\rangle$ is also a descendent -- it is then called a \textbf{\boldmath singular vector}\index{singular vector} or \textbf{\boldmath null vector}\index{null vector} of the highest-weight representation.
While a highest-weight representation is by construction always indecomposable, it is irreducible if and only if it has no singular vectors.

Coming back to our Verma module $\mathcal{V}_\Delta$, and assuming that it has a singular vector $|\chi\rangle$, we can define the degenerate representation $R = \frac{\mathcal{V}_\Delta}{U(\mathfrak{V}^+)|\chi\rangle}$, which is a coset of two Verma modules.
If a Verma module has several singular vectors, then it also has several corresponding subrepresentations, and therefore a number of possible cosets, depending on which combination of these subrepresentations is chosen as the denominator representation $R'$ in eq. \eqref{rvrp}.

Let us look for singular vectors in Verma modules.
We start at the level $N=1$: is $|\chi\rangle=L_{-1}|\Delta\rangle$ a singular vector? The states $L_n|\chi\rangle$ with $n\geq 2$ automatically vanish because they have negative levels, and we are left with computing
\begin{align}
 L_1|\chi\rangle = L_1 L_{-1}|\Delta\rangle = [L_1,L_{-1}]|\Delta\rangle = 2L_0 |\Delta\rangle = 2\Delta|\Delta\rangle\ .
\end{align}
So the Verma module $\mathcal{V}_\Delta$ has a singular vector at the level $N=1$ if and only if $\Delta = 0$, and in particular $\mathcal{V}_0$ is reducible.
Let us now look for singular vectors at the level $N=2$.
The level-$2$ descendents of a primary state $|\Delta\rangle$ are of the type
\begin{align}
 |\chi\rangle = \left(a_{1,1} L_{-1}^2 + a_2 L_{-2}\right) |\Delta\rangle\ ,
\end{align}
where $a_{1,1}$ and $a_2$ are complex coefficients.
We compute 
\begin{align}
 L_1|\chi\rangle &= \left((4\Delta+2)a_{1,1} + 3a_2\right) L_{-1}|\Delta\rangle\ ,
\\
L_2 |\chi \rangle &= \left(6\Delta a_{1,1}+(4\Delta+\tfrac12 c) a_2\right)|\Delta\rangle\ .
\end{align}
The vanishing of these two vectors leads to a system of two linear equations for the two unknowns $(a_{1,1},a_2)$, whose determinant is 
\begin{align}
 D_2(\Delta) = 4(2\Delta+1)^2 +(c-13)(2\Delta+1) +9\ . 
\label{dud}
\end{align}
Singular vectors at the level $N=2$ exist if and only if
\begin{align}
D_2(\Delta)=0 \quad \Leftrightarrow \quad \Delta = \frac{5-c\pm \sqrt{(c-25)(c-1)}}{16}\ .
\label{dcscc}
\end{align}
As our last explicit example, we look for a singular vector at the level $N=3$,
\begin{align}
 |\chi\rangle = \left(a_{1,1,1} L_{-1}^3 + a_{1,2}L_{-1}L_{-2} + a_3 L_{-3}\right) |\Delta\rangle\ .
\end{align}
The nontrivial relations that $|\chi\rangle$ must obey in order to be a singular vector are $L_1|\chi\rangle =L_2|\chi\rangle= L_3 |\chi\rangle=0$.
However, since $L_3 = [L_2,L_1]$, the relation $L_3|\chi\rangle=0$ is actually redundant, and we need only compute
\begin{align}
 L_1|\chi\rangle &= \left((6\Delta+6)a_{1,1,1}+3a_{1,2}\right)L_{-1}^2|\Delta\rangle +\left((2\Delta+4)a_{1,2}+4a_3\right)L_{-2}|\Delta\rangle\ ,
\\
L_2|\chi\rangle &= \left((18\Delta+6)a_{1,1,1}+(4\Delta+\tfrac12c +9)a_{1,2}+5a_3\right)L_{-1}|\Delta\rangle\ .
\end{align}
This leads to a system of three linear equations for the three unknowns $(a_{1,1,1},a_{1,2},a_3)$, whose determinant is
\begin{align}
 D_3(\Delta) = 12\Big(3(\Delta+1)^2+(c-13)(\Delta+1)+12\Big)\ .
\end{align}
Singular vectors at the level $N=3$ exist if and only if 
\begin{align}
 D_3(\Delta) = 0 \quad \Leftrightarrow \quad \Delta = \frac{7-c\pm\sqrt{(c-25)(c-1)}}{6}\ .
\end{align}

Let us simplify these formulas by introducing Liouville notations for $c$ and $\Delta$.
We introduce two new notations for the central charge $c$: the \textbf{\boldmath background charge}\index{background charge} $Q$ and the \textbf{\boldmath Liouville coupling constant}\index{Liouville coupling constant} $b$,
\begin{align}
\boxed{ c= 1+6Q^2 }\quad , \quad \boxed{Q = b+\frac{1}{b}}\ ,
\label{cqb}
\end{align}
or equivalently
\begin{align}
 b = \sqrt{\frac{c-1}{24}} + \sqrt{\frac{c-25}{24}}\ .
\end{align}
The correspondences between the values of $c,Q$ and $b$ are 
\begin{align}
\renewcommand{\arraystretch}{1.5}
 \begin{array}{|l|c||c|c|c|c|c|c|}
  \hline
  \text{central\ charge} & c & \leq 1 & 1-6\frac{(p-q)^2}{pq} & 1 & [1,25] & 25 & \geq 25 
\\
\hline
\text{background\ charge} & Q & i{\mathbb{R}} & i\frac{p-q}{\sqrt{pq}} & 0 & [0,2] & 2 & \geq 2 
\\
\hline
\text{Liouville\ coupling\ constant} &
b& i{\mathbb{R}} & i\sqrt{\frac{p}{q}} & i & e^{i\mathbb{R}} & 1 & {\mathbb{R}}
\\
\hline
 \end{array}
\label{cqbval}
\end{align}
where for each generic value of $c$ we choose among two corresponding values $\pm Q$ for $Q$ and four corresponding values $\pm b^{\pm 1}$ for $b$.
The conformal dimension $\Delta$ can be written in terms of a 
new parameter $\alpha$ called the \textbf{\boldmath momentum}\index{momentum}, such that 
\begin{align}
 \boxed{\Delta(\alpha) = \alpha(Q-\alpha)}\ ,
\label{daq}
\end{align}
which is defined up to the \textbf{\boldmath reflection}\index{reflection}
\begin{align}
 \alpha \mapsto Q-\alpha\ ,
\label{arqa}
\end{align}
so that $\mathcal{V}_\alpha = \mathcal{V}_{Q-\alpha}$.

In terms of the Liouville notations, the singular vectors at the levels $N=1,2,3$, and the corresponding conformal dimensions $\Delta$ and momentums $\alpha$, are 
\begin{align}
\renewcommand{\arraystretch}{1.3}
\begin{array}{|c|c|c|c|c|}
\hline 
N & \langle r,s\rangle & \Delta_{\langle r,s\rangle} & \alpha_{\langle r,s\rangle} & L_{\langle r,s\rangle} 
\\
\hline\hline
1 & \langle 1,1\rangle & 0 & 0 & L_{-1}
\\
\hline
\multirow{2}{*}{2} & 
\langle 2,1\rangle & -\frac12 -\frac{3}{4} b^2 & -\frac{b}{2} & \frac{1}{b^2}L_{-1}^2 + L_{-2}
\\
\cline{2-5}
& \langle 1,2\rangle & -\frac12 - \frac{3}{4b^2} &  -\frac{1}{2b} & b^2L_{-1}^2 + L_{-2} 
\\
\hline
\multirow{2}{*}{3} &
\langle 3,1 \rangle &  -1 -2 b^2 & -b & \frac{1}{4b^2}L_{-1}^3 + L_{-1}L_{-2}+(b^2-\frac12)L_{-3}
\\
\cline{2-5}
& \langle 1,3 \rangle &  -1 - \frac{2}{b^2} &  -\frac{1}{b} & \frac14 b^2L_{-1}^3 + L_{-1}L_{-2} + (\frac{1}{b^2}-\frac12)L_{-3}
\\
\hline
\end{array}
\label{lot}
\end{align}
Singular vectors at levels $N\geq 4$ can similarly be computed. (See Exercises \ref{exolf} and \ref{exohl}.) The general result is \cite{fms97}: for any factorization $N=rs$ of $N$ into two positive integers, there is a number $\Delta_{\langle r,s \rangle}$ such that the Verma module $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$ has a singular vector at the level $N$, which we denote as
\begin{align}
 |\chi_{\langle r,s \rangle}\rangle = L_{\langle r,s \rangle} |\Delta_{\langle r,s \rangle}\rangle\ .
\label{lrs}
\end{align}
The general formula for $\Delta_{\langle r,s \rangle}$ is known, 
\begin{align}
 \Delta_{\langle r,s \rangle} = \frac14\left(Q^2-(rb+sb^{-1})^2\right)\ .
\label{drs}
\end{align}
This corresponds to the momemtums $\alpha_{\langle r,s \rangle}$ and $Q-\alpha_{\langle r,s \rangle}$, where
\begin{align}
 \boxed{\alpha_{\langle r,s \rangle} = \frac{Q}{2} -\frac{r}{2}b - \frac{s}{2}b^{-1} }\ . 
\label{ars}
\end{align}
(For a simple derivation using fusion rules, see Section \ref{secfr}.)
Conversely, any singular vector that is not itself a descendent of another singular vector is of the type $|\chi_{\langle r,s \rangle}\rangle$.
However, singular vectors that are descendents of other singular vectors are not necessarily of this type. (See 
Exercise \ref{exosv}.) We define the \textbf{\boldmath maximally degenerate representation}\index{maximally degenerate representation} $R_{\langle r,s \rangle}$ as the coset of $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$ by the subrepresentation generated by all the singular vectors. 
Then $R_{\langle r,s \rangle}$ is irreducible.
For generic values of $c$, $|\chi_{\langle r,s \rangle}\rangle$ is the only singular vector of $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$, and 
\begin{align}
 R_{\langle r,s\rangle} =\frac{\mathcal{V}_{\Delta_{\langle r,s \rangle}}}{U(\mathfrak{V}^+) |\chi_{\langle r,s \rangle}\rangle }
= \frac{\mathcal{V}_{\Delta_{\langle r,s \rangle}}}{\mathcal{V}_{\Delta_{\langle -r,s \rangle}} }\ ,
\end{align}
where $\Delta_{\langle -r,s \rangle}$ is actually the conformal dimension of $|\chi_{\langle r,s \rangle}\rangle$, due to the identity
\begin{align}
 \Delta_{\langle r,s \rangle} + rs = \Delta_{\langle -r,s \rangle}\ .
\label{dmr}
\end{align}
For particular values of $c$ such that $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$ has more than one singular vector, the structure of $ R_{\langle r,s\rangle}$ is more complicated, see Exercises \ref{exosv} and \ref{exochar}.



\subsection{Unitarity}\label{secuni}

Let us discuss which highest-weight representations of the Virasoro algebra are unitary, starting with the Verma module $\mathcal V_\Delta$ that is generated by a primary state $|\Delta\rangle$. Let us assume there is a Hermitian form (also called a scalar product) such that $L_n^\dagger = L_{-n}$ eq. \eqref{ldn}.
This conjugation rules allows us to deduce scalar products of descendent states, from the square norm of the primary state, which we normalize to $1$ and write  $\langle \Delta|\Delta\rangle =1$. 
For example,
\begin{align}
 \langle L_{-1} \Delta|L_{-1}\Delta\rangle = \langle \Delta |L_1 L_{-1}|\Delta\rangle = 2\langle \Delta|L_0|\Delta\rangle = 2\Delta\ . 
\label{levo} 
\end{align}
Since $L_0$ is self-conjugate, different $L_0$-eigenspaces are orthogonal, and $\mathcal V_\Delta$ is unitary if and only if the scalar product is positive definite on each eigenspace. 
Given a basis $\{v_i\}$ of the level-$N$ eigenspace $R_N$, the scalar product on $R_N$ is characterized by the \textbf{Gram matrix}\index{Gram matrix} $M^{(N)}$ defined by $M^{(N)}_{ij}=\langle v_i|v_j\rangle$, and in particular the scalar product is positive definite if and only if all the eigenvalues of $M^{(N)}$ are strictly positive.
To keep track of the signs of these eigenvalues, it is actually enough to know the determinant of $M^{(N)}$, which vanishes whenever an eigenvalue vanishes. 
We now make a useful remark:
\begin{center}
 \begin{minipage}{0.9\textwidth}
 $\det M^{(N)}=0$ if and only if there is a singular vector at a level $N'\leq N$.  
 \end{minipage}
\end{center}
(See Exercise \ref{exodmn}.) 
It is easy to see that $\det M^{(N)}$ must be a polynomial function of $\Delta$ and $c$.
Knowing the zeros $\Delta_{\langle r,s \rangle}$ of $\det M^{(N)}$ as a function of $\Delta$ eq. \eqref{drs}, we obtain the \textbf{\boldmath Kac formula}\index{Kac formula} 
\begin{align}
 \boxed{\det M^{(N)} \propto \prod_{\begin{smallmatrix} r,s\geq 1 \\ rs \leq N \end{smallmatrix}} (\Delta-\Delta_{\langle r,s \rangle})^{p(N-rs)}} \ ,
\end{align}
where the constant of proportionality is a $\Delta,c$-independent positive number, and $p(N')$ is the number of partitions of $N'$.
The multiplicity of the zero $\Delta_{\langle r,s \rangle}$ is $p(N-rs)$ because this is the number of linearly independent descendents at the level $N$ of a singular vector at the level $rs$.  

According to eq. \eqref{levo}, the positivity of $M^{(1)}$ implies $\Delta >0$. 
The unitarity of $\mathcal{V}_\Delta$ will now depend on the value of the central charge $c$, which must be real 
as we already saw in Section \ref{secsots}:
\begin{enumerate}
 \item 
If $c > 1$, then $\Delta_{\langle r,s \rangle}$ \eqref{drs} cannot be a real, strictly positive number. 
Therefore, eigenvalues of $\det M^{(N)}$ do not change signs on the half-line $c > 1$.
In the limit $c \to \infty$, the matrix $M^{(N)}$ is positive definite. (See Exercise \ref{exoun}.) 
Therefore, $\mathcal{V}_\Delta$ is unitary. 
\item 
If $c=1$, the Verma module $\mathcal{V}_\Delta$ is unitary if $\Delta > 0$ by continuity from the $c>1$ case, unless $\Delta=\Delta_{\langle r,s \rangle}$ for some $\langle r,s \rangle$, that is unless $\Delta =\frac14 n^2$ with $n\in {\mathbb{N}}$.
\item 
If $c<1$, then the Verma module $\mathcal{V}_\Delta$ is never unitary. 
This is because for a given $\Delta>0$, the values of $c$ such that $\Delta = \Delta_{\langle r,s \rangle}$ for some $\langle r,s \rangle$ accumulate at $c=1^-$.
\end{enumerate}

We still have to consider the unitarity of degenerate highest-weight representations of the type $R=\frac{\mathcal{V}_\Delta}{R'}$, where the subrepresentation $R'$ contains at least one singular vector. 
For $R$ to be unitary, the subrepresentation $R'$ must include all negative-norm states, that is all eigenstates of Gram matrices with negative eigenvalues.

If $c > 1$, the only degenererate representation with a positive conformal dimension is $R_{\langle 1,1 \rangle}$, and actually $\Delta_{\langle 1,1 \rangle}=0$. This representation is unitary, because all the zero-norm states in $\mathcal{V}_0 = \underset{\Delta \to 0^+}{\lim} \mathcal{V}_\Delta$ are descendents of the level one singular vector. If $c=1$, all degenerate representations have positive conformal dimensions, and again they are unitary.

If now $c<1$, it turns out that in order to have a unitary coset, a Verma module must have not only one but actually two independent singular vectors \cite{fms97}. 
Since the existence of a singular vector in $\mathcal{V}_\Delta$ implies a relation between $\Delta$ and the central charge $c$, the existence of two singular vectors implies a constraint on $c$. 
As we will see in Section \ref{secamm}, the corresponding values of $c$ correspond to the minimal models, whose central charges are given in eq. \eqref{cpq}. 
However, the existence of two singular vectors is a necessary, but not yet a sufficient condition for a Verma module to have a unitary coset.
The final result is that for $c<1$ unitary cosets exist only if the central charge $c$ takes values that correspond to the unitary minimal models,
\begin{align}
 c = 1-\frac{6}{p(p+1)}  \quad \text{with} \quad 2\leq p\ ,
\label{cpp}
\end{align}
For these values of $c$,
the conformal dimensions of Verma modules that have unitary cosets are $\Delta=\Delta_{\langle r,s \rangle}=\Delta_{\langle p-r, p+1-s \rangle}$ where
\begin{align}
   1\leq s\leq r\leq p-1 \ .
\label{srp}
\end{align}
These unitary cosets are the maximally degenerate representations $R_{\langle r,s \rangle}$, which take the form
\begin{align}
 R_{\langle r,s \rangle} = \frac{\mathcal{V}_{\Delta_{\langle r,s \rangle}}}{U(\mathfrak{V}^+)|\chi_{\langle r,s \rangle}\rangle + U(\mathfrak{V}^+)|\chi_{\langle p-r,p+1-s \rangle}\rangle}\ ,
\label{rrs}
\end{align}
where the sum of the two subrepresentations is not a direct sum, because their intersection is nonzero. 

These results are summarized in the following table:
\begin{align}
 \begin{tabular}{|c|c|c|c|}
  \hline
central charge & $c<1$ & $c=1$ & $c>1$
\\
\hline
$\mathcal{V}_\Delta$ unitary? & no & $\Delta>0$ and $\Delta \neq \frac14 n^2$ & $\Delta>0$
\\
\hline
$R_{\langle r,s\rangle}$ unitary? & see eqs. \eqref{cpp} and \eqref{srp} &  yes & $\langle r,s \rangle = \langle 1,1\rangle$
\\
\hline
 \end{tabular}
\end{align}


\section{Fields and correlation functions \label{secfcf}}

Using the state-field correspondence, the action of the Virasoro algebra on states gives rise to a natural action of the Virasoro algebra on fields at any given point $z$. We denote the action of a Virasoro generator as $L_n^{(z)}$ or $L_n$, so that 
\begin{align}
 L_nV_\sigma(z) = L_n^{(z)}V_\sigma(z) = V_{L_n\sigma}(z)\ .
\label{lnzv}
\end{align}
(By definition, $ L_n^{(z_2)} V_{\sigma_1}(z_1)V_{\sigma_2}(z_2) = V_{\sigma_1}(z_1) L_nV_{\sigma_2}(z_2)$.)
Let a \textbf{\boldmath primary field}\index{primary field} be a field that corresponds to a primary state.
A primary field
$V_\Delta(z)$ of conformal dimension $\Delta$ obeys
\begin{align}
\boxed{
 \left\{\begin{array}{l}  L_{n>0} V_\Delta(z) = 0 \ , 
\\
L_0 V_\Delta(z) = \Delta V_\Delta(z) \ .
\end{array}\right. 
}
\label{ldld}
\end{align}
Fields such as  $\left(\prod_{i=1}^p L_{-n_i}\right) V_\Delta(z)$ that correspond to descendents of a primary state are then called  \textbf{descendent fields}\index{descendent field}.

Having two Virasoro symmetry algebras $\mathfrak{V}$ and $\overline{\mathfrak{V}}$, we also introduce left and right primary fields $V_{\Delta,\bar\Delta}(z)$, that are primary with respect to both algebras. Then $\Delta$ and $\bar\Delta$ are respectively called the left and right conformal dimensions of $V_{\Delta,\bar\Delta}(z)$. A \textbf{diagonal primary field}\index{diagonal primary field} $V_{\Delta,\Delta}(z)$ is a primary field whose left and right dimensions coincide.

In order to solve a model whose spectrum is known, we should compute the correlation functions of primary and descendent fields.
An $N$-point function of primary fields $\left\langle \prod_{i=1}^N V_{\Delta_i,\bar\Delta_i}(z_i) \right\rangle$ is a function of their positions and conformal dimensions.
$N$-point functions of descendent fields are of the type $\left\langle \prod_{i=1}^N \left(\left(\prod_{j=1}^{p_i} L_{-n_{i,j}}\prod_{\bar j=1}^{\bar p_i} \bar L_{-\bar n_{i,\bar j}}\right)V_{\Delta_i,\bar\Delta_i}(z_i)\right) \right\rangle$, with $p_i,\bar p_i\geq 0$ and $n_{i,j},\bar n_{i,\bar j}\geq 1$. 

\begin{hyp}[Single-valuedness of correlation functions]
 ~\label{ax:svcf}
 Correlation functions are single-valued functions, and in particular have trivial monodromies when the fields move around one another.
\end{hyp}
\noindent
This axiom is important enough that it deserves an explicit statement, although strictly speaking it follows from our definition of correlation functions.
Relaxing this axiom can be fruitful, in particular by allowing the existence of parafermionic fields.


\subsection{The energy-momentum tensor \label{secem}}

In order to derive equations that constrain the correlation functions, we will now explain how the action of conformal symmetry is encoded in a field, the energy-momentum tensor.

\begin{hyp}[Dependence of fields on the position]
 ~\label{ax:dvz}
 For any field $V_\sigma(z)$,
 \begin{align}
 \boxed{{\frac{\partial}{\partial z} V_\sigma(z)} = L_{-1} V_\sigma (z) }  \quad \text{and} \quad {\frac{\partial}{\partial \bar z} V_\sigma(z)} = \bar L_{-1} V_\sigma (z)\ ,
\label{lvpv}
\end{align}
consistently with the interpretation of $L_{-1},\bar L_{-1}$ as generators of translations. 
\end{hyp}
\noindent
The action of the left-moving Virasoro algebra will therefore give rise to holomorphic derivatives $\frac{\partial}{\partial z}$, and the solutions of the corresponding differential equations will be locally holomorphic functions of $z$. The analogous results for the right-moving Virasoro algebra are obtained by $z\to \bar z$ and $\frac{\partial}{\partial z} \to \frac{\partial}{\partial \bar z}$. 

From Axiom \ref{ax:dvz} we can immediately deduce how $L_n^{(z)}$ depends on $z$. Applying the axiom to the two fields $V_\sigma(z)$ and $L_n^{(z)}V_\sigma(z)$, we find $\frac{\partial}{\partial \bar z} L_n^{(z)}=0$ and 
\begin{align}
 \frac{\partial}{\partial z} L_n^{(z)} = [L_{-1},L_n^{(z)}] = -(n+1)L_{n-1}^{(z)}\ .
 \label{pll}
\end{align}
(See Exercise \ref{exowitt} for the corresponding Witt algebra identity.)
This shows that the Virasoro generators at different points $(L_n^{(z_1)})_{n\in \mathbb{Z}}$ and $(L_n^{(z_2)})_{n\in \mathbb{Z}}$ are linearly related, and should be understood of two bases of the same space of symmetry generators.
And this is equivalent to $\frac{\partial}{\partial z} T(y) = \frac{\partial}{\partial \bar z} T(y) = 0$, where we define the \textbf{\boldmath energy-momentum tensor}\index{energy-momentum tensor} $T(y)$ as 
\begin{align}
 \boxed{T(y) = \sum_{n\in{\mathbb{Z}}} \frac{L_n^{(z)}}{(y-z)^{n+2}}}\ .
\label{tsl}
\end{align}
(The series is supposed to converge if $y$ is close enough to $z$.) Calling $T(y)$ a tensor is an abuse of terminology: strictly speaking, the energy-momentum tensor is actually 
$\left(\begin{smallmatrix} T_{yy} = T(y) & T_{y\bar y} \\ T_{\bar y y} & T_{\bar y \bar y} = \bar T(y) \end{smallmatrix}\right)$, where in particular $\bar T(y)= \sum_{n\in{\mathbb{Z}}} \frac{\bar L_n^{(z)}}{(\bar y-\bar z)^{n+2}}$. 
%(We refrain from using the notation $\bar T(\bar y)$ for a locally antiholomorphic field and reserving $T(y)$ for a locally holomorphic field, while fields that are neither holomorphic nor antiholomorphic would have to be written as $V_\sigma(z,\bar z)$.)

The energy-momentum tensor encodes the action of the Virasoro algebra at all points $z$. 
From $T(y)$, we can indeed recover the Virasoro generators at any point,
\begin{align}
\boxed{ L_n^{(z)} = \frac{1}{2\pi i}\oint_{z} dy (y-z)^{n+1} T(y)} \ .
\label{lit}
\end{align}
So, for any field $V_\sigma(z)$, we have
\begin{align}
 T(y)V_\sigma(z) = \sum_{n\in{\mathbb{Z}}} \frac{L_n V_\sigma(z)}{(y-z)^{n+2}}\ .
\label{tv}
\end{align}
This is actually a special case of the general OPE \eqref{ope}, where the sum over the spectrum of the theory reduces to a combination of fields of the type of $L_n V_\sigma(z)$, as follows from the definition of $T(y)$ as a combination of symmetry generators.
This OPE simplifies if $V_\sigma(z)$ is a primary field, 
\begin{align}
 \boxed{T(y) V_\Delta(z) = \frac{\Delta V_\Delta(z)}{(y-z)^2} + \frac{\partial V_\Delta(z)}{y-z} + O(1)}\ ,
\label{tvp}
\end{align}
where $O(1)$ is regular in the limit $y\to z$.
This regular term is in general not needed, and $T(y)$ is determined by its poles and residues. This is because by definition $T(y)$ is holomorphic at any point $y\in\mathbb{C}$ where no field is present.
Since our field theory lives on the Riemann sphere, $T(y)$ should be holomorphic at $y=\infty$ as well. Let us specify what this means. (See Exercise \ref{exoti} for a justification.)

\begin{hyp}[Holomorphy of the energy-momentum tensor at infinity]
 \label{ax:hti}
 \begin{align}
 \boxed{T(y) \underset{y\to \infty}{=} O\left(\frac{1}{y^4}\right)}\ ,
\label{tyi}
\end{align}
\end{hyp} 
\noindent

The field $T(y)$ is a \textbf{\boldmath symmetry field}\index{symmetry field}: a field that encodes the action of symmetry transformations, but does not necessarily correspond to a state in the spectrum. 
That field nevertheless obeys the same assumptions of commutativity, associativity, and existence of an OPE, as the fields $V_\sigma(z)$.
The commutation relations \eqref{vir} of the Virasoro algebra are equivalent to the following OPE of the field $T(y)$ with itself,
\begin{align}
 \boxed{T(y)T(z) = \frac{\frac{c}{2}}{(y-z)^4} + \frac{2T(z)}{(y-z)^2} + \frac{\partial T(z)}{y-z} + O(1)}\ .
\label{tt}
\end{align}
The proof of this equivalence is sketched in Exercise \ref{exott}. 
The term $\frac{c}{2}$ should be understood as $\frac{c}{2}I$ where $I$ is the
central generator of the Virasoro algebra.
We are now considering this generator as a field called the 
\textbf{\boldmath identity field}\index{identity field}, whose presence does not affect correlation functions, and which is in particular $z$-independent,
\begin{align}
 \left\langle I \cdots \right\rangle = \left\langle \cdots \right\rangle \ .
\label{ivac}
\end{align}
The energy-momentum tensor itself can be seen as a descendent of the identity field. (See Exercise \ref{exoit}.)

Let a \textbf{Virasoro field}\index{Virasoro field} be a locally holomorphic field $T(y)$ that obeys the OPE \eqref{tt}. 
From such a field, we can deduce a Virasoro symmetry algebra via eq. \eqref{lit}, so $T(y)$ is a symmetry field. However, that Virasoro symmetry is a priori unrelated to conformal symmetry, and in particular does not obey Axiom \ref{ax:dvz}. 
Most results in Section \ref{secccs} will hold for Virasoro fields and non-conformal Virasoro symmetries, including: Ward identities, nontrivial factors of conformal blocks, and fusion rules. We will however work under Axiom \ref{ax:dvz}, as this simplifies some calculations.
% The right place for dealing with Virasoro fields would be a part on W algebras.

Finally, notice that all our formulas are consistent with dimensional analysis, if we adopt the following dimensions:
\begin{align}
 \boxed{[z]=-1,\quad [T]=2, \quad [L_n]=-n, \quad [V_\Delta]=\Delta}\ .
\label{zaz}
\end{align}
Here we anticipate that the dimension of $V_\Delta$ is given by the eigenvalue of $L_0$ when acting on that primary field.


\subsection{Ward identities \label{secswi}}

We now derive linear equations for correlation functions of primary and/or descendent fields $V_{\sigma_i}(z_i)$, called the Virasoro \textbf{\boldmath Ward identities}\index{Ward identity} or conformal Ward identities.
These identities follow from the properties of the energy-momentum tensor $T(z)$, which translate into the following properties of the correlation function $\left\langle T(z)\prod_{i=1}^N V_{\sigma_i}(z_i) \right\rangle$ as a function of $z$:
\begin{itemize}
 \item it is holomorphic on ${\mathbb{C}}-\{z_1,\cdots z_N\}$,
\item its behaviour at $z=z_i$ is controlled by the OPE \eqref{tv},
\item its behaviour at $z=\infty$ is controlled by Axiom \ref{ax:hti}.
\end{itemize}
For any meromorphic function $\epsilon(z)$, with no poles outside $\{z_1,\cdots z_N\}$, we therefore have
\begin{align}
 \oint_\infty dz\ \epsilon(z) \left\langle T(z)\prod_{i=1}^N V_{\sigma_i}(z_i) \right\rangle = 0 \quad \text{provided} \quad \epsilon(z)\underset{z\to\infty}{=} O(z^2)\ ,
\label{oiz}
\end{align}
where the contour of integration encloses all the points $z_1,\cdots z_N$.
We will distinguish two types of symmetry equations:
\begin{itemize}
 \item \textbf{\boldmath global Ward identities}\index{global Ward identity}, which are obtained if $\epsilon(z)$ is holomorphic, thus a polynomial of degree two, 
\item \textbf{\boldmath local Ward identities}\index{local Ward identity}, which are obtained if $\epsilon(z) \underset{z\to\infty}{=} O(\frac{1}{z})$, so that $\epsilon(z)$ must have poles.
\end{itemize}
All symmetry equations can be obtained as linear combinations of such local and global Ward identities.

\subsubsection{Local Ward identities}

A spanning set of local Ward identities can be obtained by taking $\epsilon(z) = \frac{1}{(z-z_i)^{n-1}}$ with $n\geq 2$ and $i=1, \cdots N$ in eq. \eqref{oiz}. 
Since the integrand has singularities only at $z_1,\cdots z_N$, we have $\oint_\infty=\sum_{i=1}^N \oint_{z_i}$.
Using the 
$TV_\sigma$ OPE \eqref{tv}, we obtain
\begin{align}
 \left\langle \left( L_{-n}^{(z_i)} + (-1)^{n+1}\sum_{j\neq i}\sum_{p=-1}^\infty \frac{\binom{p+n-1}{p+1}}{(z_i-z_j)^{n+p}} L_p^{(z_j)}\right)  \prod_{j=1}^N V_{\sigma_j}(z_j) \right\rangle = 0\ ,
\label{lwi}
\end{align}
where $\binom{p+n-1}{p+1}$ is a binomial coefficient.
The sum over $p$ has finitely many nonzero terms, because $L_p^{(z_j)}V_{\sigma_j}(z_j)=0$ if $p$ exceeds the level $N_j$ of the descendent state $\sigma_j$. 
Using eq. \eqref{lvpv}, and the fact that $\sigma_j$ is an $L_0$-eigenstate, the terms with $p=-1,0$ involve differential operators, whereas the terms with $p\geq 1$ involve annihilation operators. 
Therefore, the local Ward identity amounts to writing $\left\langle  L_{-n}^{(z_i)} \prod_{j=1}^N V_{\sigma_j}(z_j) \right\rangle$, whose total level is $n+\sum_j N_j$, in terms of correlation functions whose total level does not exceed $\sum_jN_j$. By induction on the total level,
\begin{quote}
 the repeated use of local Ward identities yields an expression for any $N$-point function of descendent fields, as a differential operator of the corresponding $N$-point function of primary fields.
\end{quote}
In particular, if the fields with indices $j\neq i$ are primary, the local Ward identity simplifies to
\begin{align}
 \boxed{\left\langle L_{-n}^{(z_i)}V_{\sigma_i}(z_i)\prod_{j\neq i} V_{\Delta_j}(z_j) \right\rangle =
\sum_{j\neq i} \left(-\frac{1}{z_{ji}^{n-1}} {\frac{\partial}{\partial z_j}}  + \frac{n-1}{z_{ji}^n} \Delta_j\right)
\left\langle V_{\sigma_i}(z_i)\prod_{j\neq i} V_{\Delta_j}(z_j) \right\rangle} \ ,
\label{lmn}
\end{align}
where we assume $n\geq 1$, and we use the notation $z_{ji}=z_j-z_i$. (See Exercise \ref{exodma}.) Actually, inserting $T(z)$ in an $N$-point function of primary fields also amounts to acting with a differential operator. This operator is uniquely determined by its poles and residues, which are given by the $TV_\Delta$ OPE \eqref{tvp}, and we find
\begin{align}
 \boxed{\left\langle T(z) \prod_{i=1}^N V_{\Delta_i}(z_i)\right\rangle = \sum_{i=1}^N \left(\frac{\Delta_i}{(z-z_i)^2} + \frac{1}{z-z_i}{\frac{\partial}{\partial z_i}}\right)\left\langle  \prod_{i=1}^N V_{\Delta_i}(z_i)\right\rangle }\ .
\label{dtz}
\end{align}

\subsubsection{Global Ward identities}

Taking $\epsilon(z)\in \{1,z,z^2\}$ in eq. \eqref{oiz}, we find 
\begin{align}
\left\langle \sum_{i=1}^N L_{-1}^{(z_i)} \prod_{i=1}^N V_{\sigma_i}(z_i) \right\rangle &= 0 \ ,
\label{slz}
\\
\left\langle \sum_{i=1}^N \left( L_0^{(z_i)} + z_i L_{-1}^{(z_i)}\right) \prod_{i=1}^N V_{\sigma_i}(z_i) \right\rangle & = 0 \ ,
\label{sllz}
\\
\left\langle \sum_{i=1}^N \left( L_1^{(z_i)} + 2z_i L_0^{(z_i)} + z_i^2 L_{-1}^{(z_i)}\right) \prod_{i=1}^N V_{\sigma_i}(z_i) \right\rangle & = 0\ .
\label{slllz}
\end{align}

\subsection{Global conformal symmetry}\label{secgcs}

\subsubsection{Infinitesimal global conformal transformations}

We will now study the consequences of the global Ward identities, under the assumption that the fields $V_{\sigma_i}(z_i)$ are primary fields. Since however $L_{n\geq 2}$ do not appear in the global Ward identities, the results will also be valid if the fields $V_{\sigma_i}(z_i)$ are quasi-primary fields, where we define a \textbf{\boldmath quasi-primary field}\index{quasi-primary field} or $\mathfrak{sl}_2$-primary field with conformal dimension $\Delta$ as a field $V_\Delta(z)$ such that 
\begin{align}
 \left\{\begin{array}{l}  L_1 V_\Delta(z) = 0 \ , 
\\
L_0 V_\Delta(z) = \Delta V_\Delta(z) \ .
\end{array}\right. 
\label{lolz}
\end{align}
For example, the energy-momentum tensor $T(z)$ is a quasi-primary field with conformal dimension two, but not a primary field. (See Exercise \eqref{exoit}.) 

Using Axiom \ref{ax:dvz}, the global Ward identities for an $N$-point function $\left\langle \prod_{i=1}^N V_{\Delta_i}(z_i)\right\rangle$ of quasi-primary fields reduce to a system of three differential equations, 
\begin{align}
\forall a \in \{0,+,-\}\quad , \quad 
 \left(\sum_{i=1}^N D_{z_i}^{-\Delta_i}(t^a)\right) \left\langle \prod_{i=1}^N V_{\Delta_i}(z_i)\right\rangle & = 0\ ,
\label{spz}
\end{align}
where we define the differential operators
\begin{align}
\renewcommand{\arraystretch}{1.3}
 \left\{ \begin{array}{rl} D_x^{j}(t^-) & = -{\frac{\partial}{\partial x}}\ ,
\\
D_x^{j}(t^0) &  = x{\frac{\partial}{\partial x}} -j\ ,
\\
D_x^{j}(t^+) & = x^2{\frac{\partial}{\partial x}} - 2j x \ .
\end{array}\right. 
\label{ddz}
\end{align}
These operators form a representation of the Lie algebra \textbf{\boldmath $\mathfrak{sl}_2$} \index{sl2@$\mathfrak{sl}_2$} with the generators $(t^0,t^+,t^-)$ and commutation relations 
\begin{align}
 [t^0,t^\pm ] =\pm t^\pm \quad , \quad [t^+,t^-]=2t^0\ .
\label{ttpm}
\end{align}
The algebra $\mathfrak{sl}_2$ also has a representation in terms of traceless matrices of size two,
\begin{align}
\renewcommand{\arraystretch}{1.3}
\left\{ \begin{array}{rl}
 M(t^+)& = \left(\begin{smallmatrix} 0 & 1 \\ 0& 0 \end{smallmatrix} \right) \ , 
\\
 M(t^0) &= \frac12\left(\begin{smallmatrix} 1 & 0 \\ 0 & -1 \end{smallmatrix}\right)\ ,
\\
M(t^-) & = \left(\begin{smallmatrix} 0 & 0 \\ 1 & 0 \end{smallmatrix} \right) \ .
\end{array} \right.
\label{mta}
\end{align}
In the case $j=0$, the differential operators $D^j_x(t^a)$ correspond to the generators $(\ell_{-1},\ell_0,\ell_1)$ \eqref{elln} of global conformal transformations.
This shows that global Ward identities correspond to infinitesimal global conformal transformations.


\subsubsection{Finite global conformal transformations}

The global Ward identities for 
finite global conformal transformations \eqref{gisl} are found by exponentiating the $\mathfrak{sl}_2$ matrices $M(t^a)$ into elements of the Lie group $SL_2({\mathbb{C}})$,
\begin{align}
\left\langle \prod_{i=1}^N V_{\Delta_i,\bar\Delta_i}(z_i)\right\rangle  = \left\langle \prod_{i=1}^N T_g V_{\Delta_i,\bar\Delta_i}(z_i) \right\rangle \ , 
\label{vtv}
\end{align}
where we define the image $T_gV_{\Delta,\bar\Delta}(z)$ of a quasi-primary field by
\begin{align}
 \boxed{T_g V_{\Delta,\bar\Delta}(z) = (cz+d)^{-2\Delta} (\bar c\bar z+\bar d)^{-2\bar\Delta}V_{\Delta,\bar\Delta}\left(\frac{az+b}{cz+d}\right)} \quad \text{with} \quad g = \left(\begin{smallmatrix} a & b \\ c & d \end{smallmatrix}\right) \in SL_2({\mathbb{C}})\ .
\label{tgv}
\end{align}
(See Exercise \ref{exoqp} for an interpretation in terms of representations of $\mathfrak{sl}_2$.) Writing this equation for a left and right quasi-primary field $V_{\Delta,\bar\Delta}(z)$ instead of a left quasi-primary field $V_\Delta(z)$ allows us to specify the locally antiholomorphic factor $(\bar c\bar z+\bar d)^{-2\bar\Delta}$, instead of leaving it undetermined.

We can now determine the behaviour of a quasi-primary field $V_{\Delta,\bar\Delta}(z)$ at $z=\infty$, as this is the same as the behaviour of $T_{\left(\begin{smallmatrix} 0 & 1 \\ -1 & 0 \end{smallmatrix}\right)}V_{\Delta,\bar\Delta}(z)= (-z)^{-2\Delta}(-\bar z)^{-2\bar\Delta}V_{\Delta,\bar\Delta}(-\frac{1}{z})$.
Since $V_{\Delta,\bar\Delta}(-\frac{1}{z})$ is smooth at $z=\infty$, we obtain
\begin{align}
 \boxed{V_{\Delta,\bar\Delta}(z) \underset{z\to \infty}{=} O\left(z^{-2\Delta}\bar z^{-2\bar\Delta}\right)}\ .
\label{vdz}
\end{align}
This is consistent with the assumed behaviour \eqref{tyi} of the energy-momentum tensor, which is a quasi-primary field of dimension $\Delta=2$.
Moreover, this suggests that we may define a field at $z=\infty$ by 
\begin{align}
 V_{\Delta,\bar\Delta}(\infty) = \underset{z\to \infty}{\lim} z^{2\Delta}\bar z^{2\bar\Delta} V_{\Delta,\bar\Delta}(z)\ . 
\end{align}
The behaviour \eqref{vdz} of $V_{\Delta,\bar\Delta}(z)$ at $z=\infty$ holds provided no other field is present at $z=\infty$.
To determine the behaviour of a correlation function $\left\langle V_{\Delta,\bar\Delta}(z) V_\sigma(\infty)\cdots \right\rangle$ at $z=\infty$, we would need to know the OPE $V_{\Delta,\bar\Delta}(z) V_{\sigma}(\infty)$.

One may then wonder whether local Ward identities are infinitesimal expressions of the covariance of correlation functions under local conformal transformations \eqref{flc}.
For any holomorphic function $h(z)$, we can define the image of a primary field by
\begin{align}
 T_h V_{\Delta,\bar\Delta}(z) = h'(z)^{\Delta}\overline{h'(z)}^{\bar \Delta}V_{\Delta,\bar\Delta}(h(z))\ ,
\label{thv}
\end{align}
which generalizes the image of a quasi-primary field under a global conformal transformation \eqref{tgv}.
However, unlike a global transformation, a local transformation $h(z)$ must have a singularity at some point $z_0$, in which case our formula for $T_hV_{\Delta,\bar\Delta}(z_0)$ does not make sense. And local Ward identities involve not only $V_{\Delta,\bar\Delta}(z_0)$ and its derivatives, but also its $L_{n\leq -2}$ descendents.
So a covariance equation for the transformation $h(z)$ would have to involve creation operators at the singularities of $h(z)$, and would be more complicated than eq. \eqref{vtv}.


\subsubsection{Solving global Ward identities}

Let us discuss the solutions of the three global Ward identities \eqref{spz} for an $N$-point function of primary fields
$
\left\langle \prod_{i=1}^N V_{\Delta_i}(z_i) \right\rangle\ .
$
Viewing the derivatives $\frac{\partial}{\partial z_i}\left\langle \prod_{i=1}^N V_{\Delta_i}(z_i) \right\rangle$ as $N$ unknowns, the properties of the system depend a lot on whether $N<3, N=3$ or $N>3$:
\begin{itemize}
 \item $\boxed{N=0}$\ : The global Ward identities are trivial ($0=0$).
The zero-point function, which may be called the sphere partition function, is actually a number rather than a function, and carries no useful information.

\item $\boxed{N=1}$\ :  The global Ward identities amount to $\frac{\partial}{\partial z_1}\left\langle V_{\Delta_1}(z_1)\right\rangle  =\Delta_1 \left\langle V_{\Delta_1}(z_1)\right\rangle =0$.
This implies $\left\langle V_{\Delta_1,\bar\Delta_1}(z_1)\right\rangle$ is constant, and that this constant vanishes unless $\Delta_1=\bar\Delta_1=0$.

\item $\boxed{N=2}$\ : We still have more Ward identities than unknowns, and we can obtain a condition on $\Delta_i$ by eliminating the derivatives from the Ward identities.
The elegant way to do this is to use $\epsilon(z)=(z-z_1)(z-z_2)$ in eq. \eqref{oiz}, which leads to 
\begin{align}
 (z_1-z_2)(\Delta_1-\Delta_2)\left\langle V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)\right\rangle =0\ .
\end{align}
Assuming $\left\langle V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)\right\rangle\neq 0$, we must have 
\begin{align}
 \Delta_1 = \Delta_2 \ . 
\label{ded}
\end{align}
The remaining Ward identities then amount to 
\begin{align}
 \frac{\partial}{\partial z_1}\left\langle V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)\right\rangle = - \frac{\partial}{\partial z_2}\left\langle V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)\right\rangle = -\frac{2\Delta_1}{z_1-z_2} \left\langle V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)\right\rangle\ .
\end{align}
Using the notation $z_{12}=z_1-z_2$, the solution is
\begin{align}
 \left\langle V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)\right\rangle \propto z_{12}^{-2\Delta_1}\ ,
 \label{fzz}
\end{align}
where the proportionality factor is an arbitrary antiholomorphic function. We determine this function by assuming that our fields are not only left primaries but also right primaries, and find
\begin{align}
 \boxed{ \left\langle V_{\Delta_1,\bar{\Delta}_1}(z_1) V_{\Delta_2,\bar{\Delta}_2}(z_2)\right\rangle = \delta_{\Delta_1,\Delta_2}\delta_{\bar{\Delta}_1,\bar{\Delta}_2} z_{12}^{-2\Delta_1}\bar z_{12}^{-2\bar \Delta_1} }\ .
 \label{eq:2pt}
\end{align}
Here the symbol $\delta_{\Delta_1,\Delta_2}$ is a Kronecker delta or a Dirac delta function, depending on whether the conformal dimensions take discrete or continuous values, and we have set the overall $z_i$-independent prefactor to one by a field renormalization.

\item $\boxed{N=3}$\ : The three global Ward identities determine the dependence of three-point functions on the three coordinates $z_i$, without constraining the conformal dimensions $\Delta_i$. Using $\epsilon(z)= (z-z_2)(z-z_3)$ in eq. \eqref{oiz}, we indeed obtain
\begin{align}
  \left(  \frac{\partial}{\partial z_1} + \frac{\Delta_1+\Delta_2-\Delta_3}{z_1-z_2} +\frac{\Delta_1-\Delta_2+\Delta_3}{z_1-z_3} \right) \left\langle V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)V_{\Delta_3}(z_3)\right\rangle= 0\ .
\end{align}
A solution of this equation, and of the analogous equations for the dependences on $z_2$ and $z_3$, is 
\begin{align}
 \boxed{\mathcal{F}^{(3)}(\Delta_1,\Delta_2,\Delta_3|z_1,z_2,z_3) = z_{12}^{\Delta_3-\Delta_1-\Delta_2} z_{23}^{\Delta_1-\Delta_2-\Delta_3} z_{31}^{\Delta_2-\Delta_3-\Delta_1}}\ .
\label{fzzz}
\end{align}
(See Exercise \ref{exolog} for the generalization to logarithmic conformal field theory.)
A three-point function of left and right primary fields is therefore of the type
\begin{align}
 \left\langle \prod_{i=1}^3 V_{\Delta_i,\bar{\Delta}_i}(z_i) \right\rangle = C_{123}
 \left|\mathcal{F}^{(3)}(\Delta_1,\Delta_2,\Delta_3|z_1,z_2,z_3)\right|^2\ ,
\label{cff}
\end{align}
where the modulus square notation means $|f(\Delta,z)|^2 = f(\Delta,z)f(\bar{\Delta},\bar{z})$, and the $z_i$-independent factor
$C_{123}$ is called a \textbf{\boldmath three-point structure constant}\index{three-point structure constant}.

\item $\boxed{N\geq 4}$\ : The three differential equations are not enough for controlling the dependence on the $N\geq 4$ variables $z_i$, and their general solution is 
\begin{align}
 \left\langle\prod_{i=1}^N V_{\Delta_i,\bar\Delta_i}(z_i)\right\rangle = \left|\prod_{i<j} z_{ij}^{\delta_{ij}}\right|^2 F(x_1,x_2,\cdots x_{N-3}) \ ,
\label{xfxn}
\end{align}
where the exponents $\delta_{ij}$ are numbers such that 
\begin{align}
 \sum_{j< i} \delta_{ji} +\sum_{i<j}\delta_{ij} = -2\Delta_i\ ,
 \label{sdd}
\end{align}
and $F(x_1,x_2,\cdots x_{N-3})$ is an arbitrary function of the \textbf{\boldmath cross-ratios}\index{cross-ratio}
\begin{align}
 x_i = \frac{(z_i-z_{N-2})(z_{N-1}-z_N)}{(z_i-z_{N-1})(z_{N-2}-z_N)}\ ,
\end{align}
which are invariant under the global conformal transformations \eqref{gisl}.
The function $F(x_1,x_2,\cdots x_{N-3})$ is related to an $N$-point function with $(z_{N-2},z_{N-1},z_N)=(0,\infty,1)$, as we now illustrate in the case $N=4$.

\item $\boxed{N=4}$\ : In this case there is only one cross-ratio 
\begin{align}
 x=\frac{z_{12}z_{34}}{z_{13}z_{24}}\ ,
\label{xe}
\end{align}
and the general solution is 
\begin{align}
 \left\langle\prod_{i=1}^4 V_{\Delta_i,\bar\Delta_i}(z_i)\right\rangle = \left|\mathcal{F}^{(3)}(\Delta_1,\Delta_2,0|z_1,z_2,z_3) \mathcal{F}^{(3)}(\Delta_3,\Delta_4,0|z_3,z_4,z_2)\right|^2 F(x)\ ,
\label{zgg}
\end{align}
where we built the prefactor as a combination of three-point functions, so as to satisfy eq. \eqref{sdd}.
With this choice of prefactor, $F(x)$ is related to a four-point function with $(z_2,z_3,z_4)=(0,\infty,1)$ by
\begin{align}
 F(x) =\left| x^{\Delta_1+\Delta_2} \right|^2 \left\langle V_{\Delta_1,\bar\Delta_1}(x)V_{\Delta_2,\bar\Delta_2}(0)V_{\Delta_3,\bar\Delta_3}(\infty) V_{\Delta_4,\bar\Delta_4}(1)\right\rangle \ .
\label{fx}
\end{align}
\end{itemize}

\subsubsection{Conformal spins and single-valuedness}

Let us define the \textbf{conformal spin}\index{spin (conformal)} of the field $V_{\Delta,\bar\Delta}(z,\bar z)$ to be the number $s=\Delta-\bar\Delta$. This number determines how that field behaves under rotations, 
\begin{align}
 T_{\left(\begin{smallmatrix} e^{i\theta} & 0 \\ 0 & e^{-i\theta} \end{smallmatrix}\right)} V_{\Delta,\bar{\Delta}}(z) = e^{2i\theta(\Delta-\bar\Delta)} V_{\Delta,\bar{\Delta}}(e^{2i\theta} z)\ .
\end{align}
A primary field is diagonal if and only if its conformal spin is zero.

In order for the three-point function \eqref{cff} to be single-valued as required by Axiom \ref{ax:svcf}, we need $s_1\pm s_2\pm s_3 \in\mathbb{Z}$, equivalently
\begin{align}
 \boxed{s_i \in \frac12{\mathbb{Z}} \qquad \text{and} \qquad s_1+s_2+s_3\in\mathbb{Z}}\ .
\label{dbdz}
\end{align}
Primary fields with spins $s\in\frac12+\mathbb{Z}$ are called fermionic. Allowing fermionic fields would require us to modify our commutativity Axiom \ref{ax:col}, as fermions anticommute. Considering indeed a two-point function \eqref{eq:2pt} of a fermionic field with itself, we have $\left< V(z_1)V(z_2)\right> = -\left<V(z_2)V(z_1)\right>$, which suggests $\{V(z_1),V(z_2)\}=0$.
It is actually possible to relax the single-valuedness axiom, and have fields with spins $s\notin \frac12\mathbb{Z}$, such as parafermionic fields. But we will only consider bosonic fields with spins $s\in\mathbb{Z}$.

The conformal spin then controls how three-point structure constants behave under permutations. For $\sigma$ a permutation of $(1,2,3)$, we indeed have 
\begin{align}
 \left|\mathcal{F}^{(3)}(\Delta_{\sigma(1)},\Delta_{\sigma(2)},\Delta_{\sigma(3)}|z_{\sigma(1)},z_{\sigma(2)},z_{\sigma(3)})\right|^2 = \operatorname{sgn}(\sigma)^{s_1+s_2+s_3} \left|\mathcal{F}^{(3)}(\Delta_1,\Delta_2,\Delta_3|z_1,z_2,z_3)\right|^2\ .
\end{align}
Since the three-point function is invariant under permutations of the fields, the structure constant must therefore behave as 
\begin{align}
 C_{\sigma(1)\sigma(2)\sigma(3)} = \operatorname{sgn}(\sigma)^{s_1+s_2+s_3} C_{123}\ .
\end{align}
For example, if fields $1$ and $2$ are identical, then $C_{123}=C_{213}$, and the three-point function can only be nonzero if the third field has even spin $s_3\in 2\mathbb{Z}$.


\subsection{Operator product expansions \label{secope}}

Let us study how local conformal symmetry constrain OPEs. We start with a generic OPE of the type $V_{\sigma_1}(z_1)V_{\sigma_2}(z_2) = \sum_{\sigma_3} C_{\sigma_1,\sigma_2}^{\sigma_3}(z_1,z_2) V_{\sigma_3}(z_2)$. Let us insert $\oint_C dz (z-z_2)^{n+1} T(z)$ on both sides of the OPE, where the contour $C$ encircles both $z_1$ and $z_2$. Assuming $n\geq -1$, this yields the \textbf{OPE Ward identity}\index{Ward identity!---for OPEs}
\begin{align}
 \left(L_n^{(z_2)}+\sum_{m=-1}^{n}\binom{m+1}{n+1} z_{12}^{n-m}L_{m}^{(z_1)}\right)V_{\sigma_1}(z_1)V_{\sigma_2}(z_2) = \sum_{\sigma_3} C_{\sigma_1,\sigma_2}^{\sigma_3}(z_1,z_2) L_n V_{\sigma_3}(z_2)\ .
\end{align}

\subsubsection{Global Ward identities $n\in\{-1,0\}$}

Using Axiom \ref{ax:dvz}, the $n=-1$ identity becomes 
 \begin{align}
  \left(\frac{\partial}{\partial z_1} +\frac{\partial}{\partial z_2}\right) V_{\sigma_1}(z_1)V_{\sigma_2}(z_2) = \sum_{\sigma_3} C_{\sigma_1,\sigma_2}^{\sigma_3}(z_1,z_2) \frac{\partial}{\partial z_2} V_{\sigma_3}(z_2)\ .
 \end{align}
Using the OPE again on the left-hand side, this implies $\left(\frac{\partial}{\partial z_1} +\frac{\partial}{\partial z_2}\right) C_{\sigma_1,\sigma_2}^{\sigma_3}(z_1,z_2)=0$ -- translation invariance of the OPE coefficients. 
Assuming the fields $V_{\sigma_1}, V_{\sigma_2}$ and $V_{\sigma_3}$ are  $L_0,\bar L_0$-eigenvectors with the left dimensions $\Delta_{\sigma_1}, \Delta_{\sigma_2}$ and $\Delta_{\sigma_3}$, the $n=0$ identity becomes 
\begin{align}
 \left(z_{12}\frac{\partial}{\partial z_1} + \Delta_{\sigma_1}+\Delta_{\sigma_2}\right) V_{\sigma_1}(z_1)V_{\sigma_2}(z_2) = \sum_{\sigma_3} C_{\sigma_1,\sigma_2}^{\sigma_3}(z_1,z_2) \Delta_{\sigma_3} V_{\sigma_3}(z_2)\ .
\end{align}
This determines how OPE coefficients behave under dilatations. 
Therefore, the two global Ward identities determine the dependence of OPE coefficients on $z_1,z_2$,
\begin{align}
 C_{\sigma_1,\sigma_2}^{\sigma_3}(z_1,z_2) = C_{\sigma_1,\sigma_2}^{\sigma_3} 
 \left| z_{12}^{\Delta_{{\sigma_3}}-\Delta_{\sigma_1}-\Delta_{\sigma_2}} \right|^2 
 \ ,
 \label{eq:coz}
\end{align}
in agreement with dimensional analysis eq. \eqref{zaz}.

\subsubsection{Local Ward identities $n\geq 1$}

Let us for simplicity specialize to an OPE of two primary fields $V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)$. Using the form \eqref{eq:coz} of the OPE coefficients, where we now write $C^{\sigma_3}_{\sigma_1,\sigma_2}=C^{\sigma_3}_{12}$,
the local Ward identities read 
\begin{align}
 \sum_{\sigma_3} C^{\sigma_3}_{12}(\Delta_{\sigma_3} + n\Delta_1-\Delta_2) 
 \left| z_{12}^{\Delta_{{\sigma_3}}-\Delta_1-\Delta_2}\right|^2 z_{12}^n V_{\sigma_3}(z_2) 
 = 
 \sum_{\sigma_3} C^{\sigma_3}_{12} 
 \left| z_{12}^{\Delta_{{\sigma_3}}-\Delta_1-\Delta_2} \right|^2 L_nV_{\sigma_3}(z_2)\ .
\end{align}
Focussing on the right-hand side terms that come from descendents $V_{\sigma_3}= V_{L|\Delta_3\rangle}= LV_{\Delta_3}$ of a given primary field at a level $|L|=N\geq n$, we find the identities of elements of $U(\mathfrak{V}^+)$ 
\begin{align}
 \sum_{|L|=N-n} C^{L|\Delta_3\rangle}_{12}(\Delta_3+N-n+n\Delta_1-\Delta_2)L 
 = 
 \sum_{|L|=N} C^{L|\Delta_3\rangle}_{12}(L_nL)_-\ ,
 \label{eq:lwo}
\end{align}
where $(L_nL)_-$ is the element of $U(\mathfrak{V}^+)$ such that $L_nL-(L_nL)_-\in U(\mathfrak{V})\text{Span}(L_m)_{m>0}$, for instance $(L_nL_m)_- = [L_n, L_m]$ if $1\leq n\leq -m$.
This system of linear equations determines the coefficients $C^{L|\Delta_3\rangle}_{12}$ of descendent fields in terms of the coefficient $C^{|\Delta_3\rangle}_{12}=C^3_{12}$ of the primary field,
\begin{align}
 C^{L|\Delta_3\rangle}_{12} 
 = 
 C^{3}_{12} f^{\Delta_3,L}_{\Delta_1,\Delta_2}\ ,
\end{align}
where  $f^{\Delta_3,L}_{\Delta_1,\Delta_2}$ are universal coefficients such that $f^{\Delta_3,1}_{\Delta_1,\Delta_2} =1$.
Let us show this for $|L|\leq 2$. The cases $(N,n)=(1,1),(2,2),(2,1)$ of \eqref{eq:lwo} respectively yield 
\begin{align}
 \Delta_3 + \Delta_1-\Delta_2 & = 2\Delta_3 f^{L_{-1}} \ ,
 \label{flfo}
 \\
 \Delta_3+ 2\Delta_1-\Delta_2 & = 6\Delta_3 f^{L_{-1}^2} + (4\Delta_3+\tfrac{c}{2})f^{L_{-2}}\ ,
 \\
 (\Delta_3+1+\Delta_1-\Delta_2) f^{L_{-1}} & = 2(2\Delta_3+1) f^{L_{-1}^2} + 3 f^{L_{-2}}\ ,
 \label{flff}
\end{align}
where we temporarily use the notation $f^L=f^{\Delta_3,L}_{\Delta_1,\Delta_2}$.
The first equation determines $f^{L_{-1}}$, unless $\Delta_3=0$. The next two equations determine
$f^{L_{-1}^2}$ and $f^{L_{-2}}$, unless $\Delta_3 \in \{\Delta_{\langle 1,2 \rangle}, \Delta_{\langle 2,1 \rangle}\}$.
More generally, given a value of the level $N\geq 2$, the equations with $n=1,2$ determine $\{f^L\}_{|L|=N}$, unless $\Delta_3\in\{\Delta_{\langle r,s \rangle}\}_{rs=N}$. (See Exercise \ref{exohf}.) If $\Delta_3=\Delta_{\langle r,s \rangle}=$, then for generic values of $\Delta_1,\Delta_2$ there is no solution for $\{f^L\}$, which means that $V_{\Delta_3}$ cannot appear in the OPE $V_{\Delta_1}V_{\Delta_2}$.


\subsubsection{Structure of the OPE}

Let us write the OPE of two left and right primary fields, while neglecting the contributions of descendent fields:
\begin{align}
 V_{\Delta_1,\bar\Delta_1}(z_1) V_{\Delta_2,\bar\Delta_2}(z_2) 
 = 
 \sum_{\Delta_3,\bar\Delta_3} C^{3}_{12}
 \left| z_{12}^{\Delta_3-\Delta_1-\Delta_2}\right|^2 \Big( V_{\Delta_3,\bar\Delta_3}(z_2) + O(z_1-z_2)\Big)\ .
\end{align}
Inserting this in a three-point function, and using the two-point function \eqref{eq:2pt}, this leads to
\begin{align}
 \left<  \prod_{i=1}^3 V_{\Delta_i,\bar\Delta_i}(z_i) \right> 
 = 
 C^3_{12} \left| z_{12}^{\Delta_3-\Delta_1-\Delta_2} \Big( z_{23}^{-2\Delta_3} + O(z_1-z_2) \Big) \right|^2\ .
\end{align}
Comparing this with the expression \eqref{cff} for the three-point function, we find that our OPE coefficient coincides with the three-point structure constant, 
\begin{align}
 C^3_{12}= C_{123}\ .
 \label{cftt}
\end{align}
Let us now write the complete expression of the OPE of two primary fields:
\begin{align}
 \boxed{ V_{\Delta_1,\bar\Delta_1}(z_1) V_{\Delta_2,\bar\Delta_2}(z_2) 
 = 
 \sum_{\Delta_3,\bar\Delta_3} C_{123} \left| z_{12}^{\Delta_3-\Delta_1-\Delta_2}\sum_{L\in\mathcal{L}} z_{12}^Lf^{\Delta_3,L}_{\Delta_1,\Delta_2} L \right|^2 V_{\Delta_3,\bar\Delta_3}(z_2)
 }\ ,
 \label{vvs}
\end{align}
where $\mathcal{L}$ is a basis of the space of creation operators $U(\mathfrak{V}^+)$, and the modulus square notation means a product of left-moving $z,\Delta,L$ and right-moving $\bar z, \bar \Delta, \bar L$ quantities.

That OPE Ward identities uniquely determine the contributions of the descendents of a given primary field, means that fusion multiplicities are trivial in fusion products of highest-weight representations of the Virasoro algebra. By definition, the multiplicity of the Verma module $\mathcal{V}_{\Delta_3}$ in the fusion product $\mathcal{V}_{\Delta_1}\times \mathcal{V}_{\Delta_2}$ indeed coincides with the dimension of the space of solutions of the OPE Ward identities, and that dimension is one or zero.


\subsection{Conformal blocks \label{secaco}}

We will now define \textbf{\boldmath conformal blocks}\index{conformal block} as the universal constituents of correlation functions. 
We want correlation functions to be decomposable as combinations of the model-dependent three-point structure constant, and conformal blocks.
In this sense, a simple example of a conformal block is the three-point block $\mathcal{F}^{(3)}(\Delta_1,\Delta_2,\Delta_3|z_1,z_2,z_3)$ \eqref{fzzz}. (On the torus, there exist nontrivial zero-point blocks, which are also known as the characters of representations.)

Using the OPE of $V_{\sigma_1}(z_1)V_{\sigma_2}(z_2)$ and Ward identities, any four-point function of descendent fields can be decomposed as 
\begin{align}
 \left\langle \prod_{i=1}^4 V_{\sigma_i}(z_i)\right\rangle 
 = \sum_{\Delta_s,\bar{\Delta}_s} C_{12s} C_{s34} \left| \mathcal{F}^{(s)}_{\Delta_s}(\sigma_i|z_i)\right|^2\ ,
\label{fsd}
\end{align}
where all quantities which are not three-point structure constants have been combined into the \textbf{\boldmath $s$-channel}\index{s-channel@$s$-channel} four-point conformal block $\mathcal{F}^{(s)}_{\Delta_s}(\sigma_i|z_i)$.
The appearance of the factorized quantity $\left| \mathcal{F}^{(s)}_{\Delta_s}(\sigma_i|z_i)\right|^2$ is a manifestation of holomophic factorization, and the conformal block $\mathcal{F}^{(s)}_{\Delta_s}(\sigma_i|z_i)$ is a locally holomorphic function of $z_i$. 

\subsubsection{Crossing symmetry}

Our decomposition of the four-point function followed from the OPE of $V_{\sigma_1}(z_1)V_{\sigma_2}(z_2)$: what if we used the OPE of $V_{\sigma_2}(z_2)V_{\sigma_3}(z_3)$ instead? We would then obtain a decomposition involving \textbf{\boldmath $t$-channel}\index{t-channel@$t$-channel} four-point conformal blocks  $\mathcal{F}^{(t)}_{\Delta_t}(\sigma_i|z_i)$.
The equality of the two decompositions is called the \textbf{\boldmath crossing symmetry}\index{crossing symmetry} of the four-point function.
Introducing two diagrammatic notations for conformal blocks, 
\begin{align}
 \mathcal{F}^{(s)}_{\Delta_s}  =  
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .3]
\draw (-1,2) node [left] {$2$} -- (0,0) -- node [above] {$s$} (4,0) -- (5,2) node [right] {$3$};
\draw (-1,-2) node [left] {$1$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$4$};
\end{tikzpicture}
=
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .4]
\draw (0, -2) -- node [below left] {$1$} (-2, 0) -- node [above left] {$2$} (0, 2) -- node [above right] {$3$} (2, 0) -- node [below right] {$4$} (0, -2) -- node [left] {$s$} (0, 2); 
\end{tikzpicture}
\quad\ ,\quad\
 \mathcal{F}^{(t)}_{\Delta_t}  =  
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .3]
 \draw (-2,3) node [left] {$2$} -- (0,2) -- node [left] {$t$} (0,-2) -- (-2, -3) node [left] {$1$};
\draw (0,2) -- (2,3) node [right] {$3$};
\draw (0,-2) -- (2, -3) node [right] {$4$};
\end{tikzpicture}
=
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .4]
\draw (-2, 0) -- node [above left] {$2$} (0, 2) -- node [above right] {$3$} (2, 0) -- node [below right] {$4$} (0, -2) -- node [below left] {$1$} (-2, 0) -- node [below] {$t$} (2, 0); 
\end{tikzpicture}
\ \ ,
\end{align}
we can write crossing symmetry of the four-point function as the equation
\begin{align}
 \sum_{\Delta_s,\bar{\Delta}_s} C_{12s} C_{s34} \left| 
 \begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .3]
\draw (-1,2) node [left] {$2$} -- (0,0) -- node [above] {$s$} (4,0) -- (5,2) node [right] {$3$};
\draw (-1,-2) node [left] {$1$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$4$};
\end{tikzpicture} 
\right|^2 = \sum_{\Delta_t,\bar{\Delta}_t} C_{23t}C_{t41} \left|
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .3]
 \draw (-2,3) node [left] {$2$} -- (0,2) -- node [left] {$t$} (0,-2) -- (-2, -3) node [left] {$1$};
\draw (0,2) -- (2,3) node [right] {$3$};
\draw (0,-2) -- (2, -3) node [right] {$4$};
\end{tikzpicture}
\right|^2\ .
\label{csd}
\end{align}
Assuming the conformal blocks to be known, this is a quadratic equation for the three-point structure constant.
This equation is equivalent to the associativity of the OPE \eqref{cccc}. $N$-point functions on the sphere can similarly be decomposed into three-point structure constants and $N$-point conformal blocks, but the cases $N\geq 5$ do not yield more equations for the three-point structure constant. 

Conformal blocks obey the same local and global Ward identities as the corresponding correlation functions.
In particular, given a four-point function of primary fields, the holomorphic global Ward identities \eqref{spz} are linear differential equations for locally holomorphic functions of $(z_1,z_2,z_3,z_4)$.
Then
$s$-channel and $t$-channel four-point blocks each provide a basis of solutions of these equations, whose elements are respectively parametrized by $\Delta_s$ and $\Delta_t$.
So there must exist a linear, invertible fusing relation between the two bases, 
\begin{align}
 \mathcal{F}^{(s)}_{\Delta_s}(\sigma_i|z_i) = \sum_{\Delta_t}\ F_{\Delta_s,\Delta_t}\begin{bmatrix} \Delta_2 & \Delta_3 \\ \Delta_1 & \Delta_4 \end{bmatrix}\ \mathcal{F}^{(t)}_{\Delta_t}(\sigma_i|z_i)\ ,
\end{align}
whose $z_i$-independent kernel $F_{\Delta_s,\Delta_t}\begin{bmatrix} \Delta_2 & \Delta_3 \\ \Delta_1 & \Delta_4 \end{bmatrix}$ is called the \textbf{\boldmath fusing matrix}\index{fusing matrix} of the Virasoro algebra.
The parameters of the fusing matrix are in principle representations of the Virasoro algebra: the conformal dimensions which we wrote stand for the corresponding Verma modules.
A diagrammatic notation for the fusing matrix is 
\begin{align}
 F_{\Delta_s,\Delta_t}\begin{bmatrix} \Delta_2 & \Delta_3 \\ \Delta_1 & \Delta_4 \end{bmatrix} = \ \ 
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .55]
\draw (0, -2) -- node [below left] {$1$} (-2, 0) -- node [above left] {$2$} (0, 2) -- node [above right] {$3$} (2, 0) -- node [below right] {$4$} (0, -2) -- (0, 2);
\draw (-2, 0) -- (-.2, 0) node [below left] {$t$}; \draw (.2, 0) -- (2, 0);
\node [above left] at (0, .2) {$s$};
\end{tikzpicture}
\ \ .
\end{align}
It is possible to eliminate the conformal blocks from the crossing symmetry equation \eqref{csd}, using the fusing relation and the linear independence of blocks within a given basis,
\begin{align}
 \sum_{\Delta_s,\bar{\Delta}_s} C_{12s} C_{s34}
F_{\Delta_s,\Delta_t}\begin{bmatrix} \Delta_2 & \Delta_3 \\ \Delta_1 & \Delta_4 \end{bmatrix}
F_{\bar{\Delta}_s,\bar{\Delta}_t}\begin{bmatrix} \bar{\Delta}_2 & \bar{\Delta}_3 \\ \bar{\Delta}_1 & \bar{\Delta}_4 \end{bmatrix}
=  C_{23t}C_{t41}\ .
\end{align}
This can be further simplified if the theory is diagonal.
In this case, we have $\Delta_i=\bar{\Delta}_i$ for $i=1,2,3,4$, and we should insert factors $\delta_{\Delta_s,\bar\Delta_s}$ (left) and $\delta_{\Delta_t,\bar\Delta_t}$ (right) in the above formula.
Using the inverse fusing matrix, we obtain 
\begin{align}
 C_{12s} C_{s34}
F_{\Delta_s,\Delta_t}\begin{bmatrix} \Delta_2 & \Delta_3 \\ \Delta_1 & \Delta_4 \end{bmatrix}
= C_{23t}C_{t41} 
F^{-1}_{\Delta_t,\Delta_s}\begin{bmatrix} \Delta_2 & \Delta_3 \\ \Delta_1 & \Delta_4 \end{bmatrix}
\ .
\end{align}
This can be useful, because the fusing matrix is usually a simpler object than the conformal blocks, as we will see in a special case in Section \ref{sechcb}.
% F^{-1} is related to F by a permutation of the arguments.
Explicit formulas for $F_{\Delta_s,\Delta_t}\begin{bmatrix} \Delta_2 & \Delta_3 \\ \Delta_1 & \Delta_4 \end{bmatrix}$ with generic values of $\Delta_i$ can be found in \cite{tv12}.


\subsubsection{Pedestrian computation of conformal blocks}

Let us sketch how conformal blocks can be computed. 
For simplicity, we assume that our four fields are primary.
Thanks to global conformal symmetry, we furthermore restrict our attention to the case $(z_1,z_2,z_3,z_4)=(x,0,\infty, 1)$. 
We therefore want to compute the conformal blocks 
\begin{align}
 \mathcal{F}^{(s)}_{\Delta_s}(\Delta_i|x)=\mathcal{F}^{(s)}_{\Delta_s}(\Delta_i|x,0,\infty,1)\ ,
\end{align}
from which $\mathcal{F}^{(s)}_{\Delta_s}(\Delta_i|z_i)$ can be recovered  using eqs. \eqref{zgg} and \eqref{fx}.
Inserting the OPE \eqref{vvs} in our four-point function, we obtain
\begin{multline}
 \Big< V_{\Delta_1,\bar\Delta_1}(x) V_{\Delta_2,\bar\Delta_2}(0)V_{\Delta_3,\bar\Delta_3}(\infty)V_{\Delta_4,\bar\Delta_4}(1)\Big>
 \\
 = 
 \sum_{\Delta_s,\bar\Delta_s} C_{12s} 
 \left| x^{\Delta_s-\Delta_1-\Delta_2}\sum_{L\in\mathcal{L}} x^Lf^{\Delta_s,L}_{\Delta_1,\Delta_2} \right|^2
 \Big< L\bar L V_{\Delta_s,\bar\Delta_s}(0) V_{\Delta_3,\bar\Delta_3}(\infty) V_{\Delta_4,\bar\Delta_4}(1) \Big>\ .
 \label{4ope}
\end{multline}
Then, using Ward identities, we write three-point functions of descendent fields as three-point functions of primary fields, times the universal factors
\begin{align}
g^{L}_{\Delta_1,\Delta_2,\Delta_3} = 
 \frac{ \left< L V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right> }{  \left<  V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right>}\ .
\end{align}
In the case of $L_{-1}^n$ descendents, this only involves taking derivatives of three-point conformal blocks, 
\begin{align}
 g^{L_{-1}^n}_{\Delta_1,\Delta_2,\Delta_3} & =\left. \frac{\frac{\partial^n}{\partial z_1^n} \mathcal{F}^{(3)}(\Delta_i|z_i)}{\mathcal{F}^{(3)}(\Delta_i|z_i)}\right|_{(z_1,z_2,z_3)=(0,\infty,1)} =(\Delta_1-\Delta_2+\Delta_3)_n \ ,
\end{align}
where we use the notation
\begin{align}
 (x)_n = \frac{\Gamma(x+n)}{\Gamma(x)} = \prod_{i=0}^{n-1}(x+i)\ .
\label{xn}
\end{align}
For more general descendents, we use local Ward identities \eqref{lmn}. For example,
\begin{align}
 g^{L_{-2}}_{\Delta_1,\Delta_2,\Delta_3}
 = \Delta_1-\Delta_2+2\Delta_3\ .
\end{align}
Using the universal factors $g^L_{\Delta_s,\Delta_3,\Delta_4}$, the expression \eqref{4ope} of our four-point function can be written as a conformal block decomposition \eqref{fsd}, where the blocks are 
\begin{align}
 \mathcal{F}^{(s)}_{\Delta_s}(\Delta_i|x) = \sum_{L\in\mathcal{L}} f_{\Delta_1,\Delta_2}^{\Delta_s,L} g^{L}_{\Delta_s,\Delta_3,\Delta_4}x^{|L|+\Delta_s-\Delta_1-\Delta_2}\ .
\label{gsd}
\end{align}
Explicitly, using eqs. \eqref{flfo}-\eqref{flff} for $f_{\Delta_1,\Delta_2}^{\Delta_s,L}$, we find 
\begin{multline}
 \mathcal{F}^{(s)}_{\Delta_s}(\Delta_i|x) 
= x^{\Delta_s - \Delta_1 - \Delta_2}\Bigg\{ 1 
+ \frac{(\Delta_s+\Delta_1-\Delta_2)(\Delta_s+\Delta_4-\Delta_3)}{2\Delta_s} x  
\\
+ \frac{1}{D_2(\Delta_s)}
\begin{bmatrix} (\Delta_s+\Delta_1-\Delta_2)_2 \\ \Delta_s+2\Delta_1-\Delta_2 \end{bmatrix}^T
\begin{bmatrix} 2+\frac{c}{4\Delta_s} & -3 \\ -3 & 4\Delta_s+2 \end{bmatrix}
\begin{bmatrix} (\Delta_s+\Delta_4-\Delta_3)_2 \\ \Delta_s+2\Delta_4-\Delta_3 \end{bmatrix}
 x^2 + O(x^3)\Bigg\}\ ,
\end{multline}
where the level-$2$ determinant $D_2(\Delta_s)$ was defined in eq. \eqref{dud}.
Once $s$-channel blocks are known, $t$-channel blocks can be obtained by a permutation of the arguments, as suggested by the diagrammatic notations,
\begin{align}
 \mathcal{F}^{(t)}_{\Delta_t}(\Delta_1,\Delta_2,\Delta_3,\Delta_4|z_1,z_2,z_3,z_4) = \mathcal{F}^{(s)}_{\Delta_t}(\Delta_2,\Delta_3,\Delta_4,\Delta_1|z_2,z_3,z_4,z_1)\ . 
\label{gtgs}
\end{align}
Taking global conformal symmetry into account, this becomes
\begin{align}
 \mathcal{F}^{(t)}_{\Delta_t}(\Delta_1,\Delta_2,\Delta_3,\Delta_4|x) = (1-x)^{\Delta_2+\Delta_3-\Delta_1-\Delta_4}\mathcal{F}^{(s)}_{\Delta_t}(\Delta_2,\Delta_3,\Delta_4,\Delta_1|1-x)\ .
\end{align}

\subsubsection{Zamolodchikov's recursion}

For practical computations of conformal blocks, the formula \eqref{gsd} is not very efficient: the number of terms grows quickly with the level $|L_s|$, and the cofficients $f_{\Delta_1,\Delta_2}^{\Delta_s,L_s} g^{L_s}_{\Delta_s,\Delta_3,\Delta_4}$ are not known explicitly.
Fortunately, there is also Al.
Zamolodchikov's recursion representation \cite{zz90}
\begin{align}
 \mathcal{F}^{(s)}_{\Delta_s}(\Delta_i|x) 
=  (16q)^{\Delta_s -\frac{Q^2}{4}} x^{\frac{Q^2}{4}-\Delta_1-\Delta_2} (1-x)^{\frac{Q^2}{4}-\Delta_1-\Delta_4} \theta_3(q)^{3Q^2-4(\Delta_1+\Delta_2+\Delta_3+\Delta_4)} H_{\Delta_s}(\Delta_i|q)\ ,
\end{align}
which uses the \textbf{elliptic nome}\index{elliptic nome} $q$ and elliptic function $\theta_3(q)$,
\begin{align}
 q = \exp -\pi \frac{F(\frac12,\frac12,1,1-x)}{F(\frac12,\frac12,1,x)}  \quad , \quad \theta_3(q) = \sum_{n\in{\mathbb{Z}}} q^{n^2}\ ,
\end{align}
where $F(\frac12,\frac12,1,x)$ is a special case of the hypergeometric function \eqref{fsn}, and $|q|<1$ for any $x\in\mathbb{C}$.
The nontrivial factor is the function
\begin{align}
 H_{\Delta_s}(\Delta_i|q) = \sum_{k=0}^\infty \prod_{j=1}^k \sum_{m_j,n_j=1}^\infty \frac{(16q)^{m_jn_j}R_{m_j,n_j}}{\Delta_{\langle m_{j-1},-n_{j-1} \rangle}-\Delta_{\langle m_j,n_j\rangle}}
\label{hdq}
\end{align}
where by convention $\Delta_{\langle m_0,-n_0\rangle} = \Delta_s$, and we introduce the coefficients
\begin{align}
 R_{m,n} = \frac{-2P_{\langle 0,0\rangle} P_{\langle m,n\rangle}}{\prod_{r=1-m}^m \prod_{s=1-n}^n 2P_{\langle r,s\rangle}}
\prod_{r\overset{2}{=}1-m}^{m-1} \prod_{s\overset{2}{=}1-n}^{n-1} \prod_\pm (P_2\pm P_1 + P_{\langle r,s\rangle}) (P_3\pm P_4 +P_{\langle r,s\rangle})\ .
\end{align}
In this formula $P$ is yet another notation for the momentum, which is related to the notations $\Delta$ and $\alpha$ by
\begin{align}
 \Delta = \frac{Q^2}{4} + P^2 \quad \text{and} \quad \alpha = \frac{Q}{2}+iP\ , \quad \text{so that} \quad P_{\langle r,s\rangle} = \frac{i}{2}\left(rb+sb^{-1}\right)\ .
 \label{pdef}
\end{align}
The recursion representation owes its name to the original definition of the function $H_{\Delta_s}(\Delta_i|q)$ \eqref{hdq} by a recursive formula,
\begin{align}
 H_{\Delta_s}(\Delta_i|q) = 1 + \sum_{m,n=1}^\infty \frac{(16q)^{mn}}{\Delta_s-\Delta_{\langle m,n\rangle}} R_{m,n} H_{\Delta_{\langle m,-n\rangle}}(\Delta_i|q)\ .
\end{align}
The recursion representation has the following properties:
\begin{itemize}
 \item it converges very fast,
\item it uses the elliptic nome $q$ instead of the natural variable $x$,
\item it manifestly has the correct poles as a function of $\Delta_s$, namely $\Delta_s \in \{\Delta_{\langle r,s\rangle}\}_{r,s\in {\mathbb{N}}^*}$,
\item it is manifestly invariant under reflections of all momentums,
\item it has no known interpretation as a sum over descendents in some basis.
\end{itemize}
Alternatively, conformal blocks have a combinatorial representation which follows from the AGT relation \cite{aflt10}, and which has the opposite properties. 

\subsubsection{Degenerate fields and momentums}

The general crossing symmetry equation \eqref{csd}, while it may in principle determine the three-point structure constant, is in practice often intractable, because
\begin{enumerate}
 \item it can involve sums over large sets of possible conformal dimensions in the $s$- and $t$-channels, 
 \item the general conformal blocks are rather complicated. 
\end{enumerate}
So, while the general crossing equation is useful for testing the consistency of proposals for the spectrum and three-point structure constant, it is often useless for deriving specific proposals in the first place. However, it is possible to restrict the $s$- and $t$-channels conformal dimensions to finite sets, and to simplify the conformal blocks, by taking one of the four fields to be degenerate. If the other three fields remain generic, this still leads to constraints on the generic three-point structure constant. 

We will study conformal blocks which involve degenerate fields, and therefore obey differential equations. 
Notice however that the conformal block $\mathcal{F}^{(s)}_{\Delta_s}(\Delta_i|z_i)$ is a smooth function of $\Delta_i$, which has a finite value for $\Delta_1 = \Delta_{\langle r,s\rangle}$ -- irrespective of the values of $\Delta_2,\Delta_3,\Delta_4,\Delta_s$. 
If however $\Delta_2$ and $\Delta_s$ happen to be related as dictated by the fusion rule of the degenerate field $V_{\langle r,s\rangle}$, then this value obeys a differential equation of order $rs$.
In other words, a conformal block involving a degenerate representation coincides with the conformal block involving the corresponding Verma module.
The degenerate representation manifests itself in the decompositions of correlation functions, where fusion rules dictate which conformal blocks contribute.
On the other hand, conformal blocks involving a degenerate representation in the $s$-channel are not mere limits of $\mathcal{F}^{(s)}_{\Delta_s}(\Delta_i|z_i)$, which is actually singular at $\Delta_s = \Delta_{\langle r,s\rangle}$.
The sum over descendents in eq. \eqref{gsd} is valid only if the $s$-channel representation is a Verma module, and must be modified otherwise. 


\section{Degenerate fields}

And a primary field that has a vanishing descendent is called a \textbf{\boldmath degenerate field}\index{degenerate field}.
In other words, a degenerate field corresponds to the highest-weight state of a degenerate representation.
The degenerate field that corresponds to the highest-weight state of the degenerate representation $R_{\langle r,s \rangle}$ will be denoted $V_{\langle r,s\rangle}(z)$, and obeys the equation 
\begin{align}
 L_{\langle r,s \rangle} V_{\langle r,s \rangle}(z) = 0 \ , 
\label{lrsv}
\end{align}
where $L_{\langle r,s \rangle}$ is defined in eq. \eqref{lrs}.
This field differs from the field $V_{\Delta_{\langle r,s \rangle}}(z)$, which corresponds to the highest-weight state of the Verma module $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$, and obeys no such equation.

\begin{align}
 \boxed{C_{\Delta_1,\bar{\Delta}_1,\Delta_2,\bar{\Delta}_2}^{\Delta_3,\bar{\Delta}_3}(z_1,\bar{z}_1,z_2,\bar{z}_2) = C_{\Delta_1,\bar{\Delta}_1,\Delta_2,\bar{\Delta}_2,\Delta_3,\bar{\Delta}_3}\ z_{12}^{\Delta_3-\Delta_1-\Delta_2}  \bar{z}_{12}^{\bar{\Delta}_3-\bar{\Delta}_1-\bar{\Delta}_2}}\ ,
\label{ccz}
\end{align}


\subsection{Fusion rules}\label{secfr}

The Ward identities are the only linear equations which are obeyed by general correlation functions.
However, more equations appear if a correlation function involves degenerate fields, as a consequence of $L_{\langle r,s \rangle} V_{\langle r,s \rangle} = 0$ eq. \eqref{lrsv}.
Inserting this into correlation functions, we obtain linear equations called \textbf{\boldmath null vector equations}\index{null vector equation}. 

In the case of three-point functions, correlation functions of descendent fields are related to correlation functions of primary fields by universal ratios, such as the function $g^{L}_{\Delta_1,\Delta_2,\Delta_3}(z_1,z_2,z_3)$ of eq. \eqref{lzgz}.
We thus have 
\begin{align}
 g^{L_{\langle r,s \rangle}}_{\Delta_{\langle r,s \rangle},\Delta_2,\Delta_3}(z_1,z_2,z_3) = 0 \ .
\end{align}
This must hold for any values of the positions $z_i$, which leads to constraints on $\Delta_2$ and $\Delta_3$.
These constraints can be interpreted as the fusion rules of the degenerate representation $R_{\langle r,s \rangle}$, using the relation between OPE structure functions and three-point functions.

For example, let us consider the case $\langle r,s \rangle = \langle 1,1 \rangle$.
Using eq. \eqref{lot} for $\Delta_{\langle 1,1 \rangle}$ and $L_{\langle 1,1 \rangle}$, we obtain
$g^{L_{-1}}_{0,\Delta_2,\Delta_3} = 0$.
Using eq. \eqref{glp} for $g^{L_{-1}}$, this implies 
$
 \Delta_2=\Delta_3
$,
which is equivalent to the fusion rule
\begin{align}
 \boxed{R_{\langle 1,1\rangle} \times \mathcal{V}_\Delta = \mathcal{V}_\Delta} \ .
\end{align}
Next, let us consider the case $\langle r,s \rangle = \langle 2,1 \rangle$.
Using eq. \eqref{lot}, we obtain 
$g^{L_{-2} +\frac{1}{b^2} L_{-1}^2 }_{-\frac12 -\frac34 b^2,\Delta_2,\Delta_3} = 0$.
Using eqs. \eqref{gloo} and \eqref{glt} for $g^{L_{-1}^2}$ and $g^{L_{-2}}$, this implies
\begin{align}
 2(\Delta_2-\Delta_3)^2 + b^2 (\Delta_2+\Delta_3) - \frac12 - b^2 -\frac38 b^4= 0\ .
\end{align}
Given a value of $\Delta_2$, we therefore have two solutions for $\Delta_3$.
The actual solutions are most easily found by rewriting the equation in terms of the momentum $\alpha$ \eqref{daq} instead of the conformal dimension $\Delta$,
\begin{align}
 \left((\alpha_2-\alpha_3)^2 -\frac14 b^2\right)\left((Q-\alpha_2-\alpha_3)^2 -\frac14 b^2\right) = 0\ .
\end{align}
Up to reflections of $\alpha_2$ or $\alpha_3$, we must therefore have
$
 \alpha_3 = \alpha_2 \pm \frac{b}{2}
$.
We would similarly find $\alpha_3 = \alpha_2 \pm \frac{1}{2b}$ if we considered the case $\langle r,s\rangle = \langle 1,2\rangle$. 
The resulting fusion rules are 
\begin{align}
\boxed{ R_{\langle 2,1 \rangle}\times \mathcal{V}_\alpha = \sum_\pm \mathcal{V}_{\alpha \pm \frac{b}{2}} }\quad , \quad 
\boxed{ R_{\langle 1,2 \rangle}\times \mathcal{V}_\alpha = \sum_\pm \mathcal{V}_{\alpha \pm \frac{1}{2b}} }\ .
\label{rot}
\end{align}
These fusion rules could be derived by directly analyzing OPEs, instead of three-point functions. (See Exercise \ref{exooit}.) 

We now assume that the fusion rules are associative, and proceed to deduce $R_{\langle r,s \rangle}\times \mathcal{V}_\alpha$.
Due to null vector equations, we expect this product to be a sum of a finite number of Verma modules.
By associativity, this implies that the fusion product of two degenerate representations must itself be a sum of degenerate representations.
In the case of  
$R_{\langle 2,1\rangle}\times R_{\langle r,s\rangle}$, the conformal dimensions of the resulting degenerate representations are given by eq. \eqref{rot}, and we find
\begin{align}
R_{\langle 2,1\rangle}\times R_{\langle r,s\rangle} = R_{\langle r-1,s\rangle} + R_{\langle r+1,s\rangle }\ , \quad (r\geq 1)\ .
\end{align}
We could similarly compute $R_{\langle 1,2\rangle}\times R_{\langle r,s\rangle}$.
Then, using the associativity of the fusion products $R_{\langle 2,1\rangle}\times R_{\langle r,s\rangle}\times \mathcal{V}_\alpha$ and $R_{\langle 1,2\rangle}\times R_{\langle r,s\rangle}\times \mathcal{V}_\alpha$, a recursion on $r$ and $s$ leads to
\begin{align}
 \boxed{R_{\langle r,s \rangle}\times \mathcal{V}_\alpha = \sum_{i=0}^{r-1} \sum_{j=0}^{s-1} \mathcal{V}_{\alpha + \alpha_{\langle r,s \rangle}+ ib+jb^{-1}}}\ ,
\label{rtv}
\end{align}
where the momentum $\alpha_{\langle r,s \rangle}$ is given by eq. \eqref{ars}. 
In particular, the two ``extremal'' representations, which are obtained for $(i,j)=(0,0)$ and $(i,j)=(r-1,s-1)$, have the momentums
$\alpha \pm \alpha_{\langle r,s \rangle} $.

The fusion product of two degenerate representations must of course obey the fusion rules of both, and we find
\begin{align}
 \boxed{R_{\langle r_1,s_1 \rangle} \times R_{\langle r_2,s_2 \rangle} = \sum_{r_3\overset{2}{=}|r_1-r_2|+1}^{r_1+r_2-1}\ \sum_{s_3\overset{2}{=}|s_1-s_2|+1}^{s_1+s_2-1} R_{\langle r_3,s_3 \rangle}}\ ,
\label{rrsr}
\end{align}
where a superscript $\overset{2}{=}$ indicates that the corresponding sums run by increments of $2$.
So the fusion product $R_{\langle r_1,s_1 \rangle} \times R_{\langle r_2,s_2 \rangle}$ is a sum of $\min(r_1,r_2)\min(s_1,s_2)$ degenerate representations.
This can be rewritten as 
\begin{align}
R_{\langle r_1,s_1 \rangle} \times R_{\langle r_2,s_2 \rangle} = \sum_{r_3,s_3=1}^\infty f_{r_1,r_2,r_3} f_{s_1,s_2,s_3}\ R_{\langle r_3,s_3 \rangle}\ ,
 \label{rrrsss}
\end{align}
using the permutation-symmetric coefficients
\begin{align}
f_{r_1,r_2,r_3} = \left\{\begin{array}{l}  1 \quad \text{if} \quad 
 \forall i\neq j\neq k \ , \quad r_i+r_j-r_k \in 1 + 2{\mathbb{N}}\ .
\\ 0 \quad \text{otherwise} \ .\end{array}\right.  
\label{frrr}
\end{align}

\vspace{2mm} 
 
\textit{We could already derive the spectrums and fusion rules of minimal models, and readers who are impatient to learn about particular models may proceed to Section \ref{secvmm}, where they will however have to skip the bits about correlation functions.} 


\subsection{BPZ differential equations \label{secbpz}}

Using the representation \eqref{lmn} of creation operators as differential operators, null vector equations for correlation functions of primary fields become differential equations, called \textbf{\boldmath BPZ equations}\index{BPZ equation} after Belavin, Polyakov and Zamolodchikov. 
For example, in the cases of the degenerate fields $V_{\langle 1,1 \rangle}(x)$ and $V_{\langle 2,1 \rangle}(x)$, eq. \eqref{lrsv} gives rise to the following BPZ equations: 
\begin{align}
 {\frac{\partial}{\partial x}} \left\langle V_{\langle 1,1 \rangle}(x) \prod_{i=1}^{N-1} V_{\Delta_i}(z_i) \right\rangle = 0 \ ,
\label{pvoo} 
\end{align}
\begin{align}
\boxed{\left( \frac{\partial^2}{\partial x^2}  +b^2 \sum_{j=1}^{N-1} \left[\frac{1}{x-z_j}{\frac{\partial}{\partial z_j}}+ \frac{\Delta_j}{(x-z_j)^2} \right]\right)\left\langle V_{\langle 2,1 \rangle}(x) \prod_{i=1}^{N-1} V_{\Delta_i}(z_i) \right\rangle = 0} \ .
\label{pvot}
\end{align}
More generally, a degenerate field $V_{\langle r,s \rangle}(x)$ with a vanishing descendent at level $rs$ leads to a BPZ equation of order $rs$. 

In the case of a three-point function ($N=3$), the dependence on $z_i$ is already completely determined by global conformal symmetry, see eq. \eqref{fzzz}.
The BPZ equation therefore leads to constraints on the conformal dimensions $\Delta_1$ and $\Delta_2$ -- that is, to the fusion rules. (See Exercise \ref{exotob}.) If $N\geq 4$, taking the global conformal symmetry into account as in eq. \eqref{xfxn}, it is possible to rewrite a BPZ equation as a differential equation for a function of $N-3$ variables.
In particular, a BPZ equation for a four-point function boils down to an ordinary differential equation -- a differential equation for a function of a single variable.  

Let us derive the ordinary differential equation for $\left\langle V_{\langle 2,1 \rangle}(x)\prod_{i=1}^3 V_{\Delta_i}(z_i)\right\rangle$.
Inserting the identity $\oint_\infty dz\ \epsilon(z) T(z) =0$ with $\epsilon(z) = \frac{(z-z_1)(z-z_2)(z-z_3)}{z-x}$, and using eq. \eqref{lrsv}, we obtain a differential equation with derivatives only with respect to $x$, 
\begin{multline}
  \left\{ \prod_{i=1}^3(x-z_i)\left(-\frac{1}{b^2}\frac{\partial^2}{\partial x^2} +\sum_{i=1}^3 \frac{1}{x-z_i} {\frac{\partial}{\partial x}} \right) + (3x-z_1-z_2-z_3)\Delta_{\langle 2,1 \rangle} \right.
  \\
\left.  +\frac{z_{12}z_{13}}{z_1-x}\Delta_1 + \frac{z_{21}z_{23}}{z_2-x}\Delta_2+\frac{z_{31}z_{32}}{z_3-x}\Delta_3\right\} 
\left\langle V_{\langle 2,1 \rangle}(x)\prod_{i=1}^3 V_{\Delta_i}(z_i)\right\rangle  = 0\ . 
\end{multline}
Setting $(z_1,z_2,z_3)=(0,\infty,1)$, this amounts to the equation 
\begin{align}
  \left\{ \frac{x(1-x)}{b^2}\frac{\partial^2}{\partial x^2} + (2x-1){\frac{\partial}{\partial x}} +\Delta_{\langle 2,1 \rangle} +\frac{\Delta_1}{x}-\Delta_2 + \frac{\Delta_3}{1-x}\right\} \mathcal{F}(x)=0\ ,
\label{sode}
\end{align}
for 
\begin{align}
 \mathcal{F}(x) = \left\langle V_{\langle 2,1 \rangle}(x)V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right\rangle\ .
\label{fxv}
 \end{align}
(The $s$-th order differential equation for $\left\langle V_{\langle s,1 \rangle}(x)V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right\rangle $ can be found in \cite{flno09}.)

Before solving our second-order differential equation, let us discuss its qualitative properties.
The coefficients of the equation diverge, and the solutions can therefore be non-analytic, at the singularities $x=0,1,\infty$.
These singularities are regular singular points, where a \textbf{regular singular point}\index{regular singular point} $x_0$ is characterized by the existence of a basis of solutions of the type  
\begin{align}
 \mathcal{F}(x)=(x-x_0)^\lambda\left(1+\sum_{n=0}^\infty c_n (x-x_0)^n\right)\ ,
\label{zxl}
\end{align}
where $\lambda$ is called a \textbf{\boldmath characteristic exponent}\index{characteristic exponent}.
The characteristic exponents of the equation \eqref{sode} at the regular singular point $x=0$ are obtained by inserting the ansatz $\mathcal{F}(x) = x^\lambda(1+O(x))$, which leads to 
\begin{align}
 \lambda^2 - bQ\lambda + b^2 \Delta_1 = 0 \ .
\end{align}
The roots of this equation are 
\begin{align}
 \lambda_\pm = b\alpha_1^\pm \ , 
\label{lpm}
\end{align}
where for a given momentum $\alpha$ we define 
\begin{align}
 \alpha^+ = \alpha \quad , \quad \alpha^- = Q-\alpha\ .
\label{apm}
\end{align}
In conformal field theory, singularities of a correlation function correspond to coincidences of fields, and characteristic exponents are constrained by the corresponding OPEs.
In the case of our four-point function \eqref{fxv} at $x=0$, the fusion rule \eqref{rot} leads to an OPE of the type
\begin{align}
 V_{\langle 2,1 \rangle}(x)V_{\alpha}(0) = \sum_\pm C_\pm(\alpha) x^{\Delta\left(\alpha\mp \frac{b}{2}\right) -\Delta(\alpha) - \Delta_{\langle 2,1 \rangle}} \left(V_{\alpha\mp\frac{b}{2}}(0) + O(x)\right)\ ,
\end{align}
where $C_\pm(\alpha)$ are some constants, and the powers of $x$ are dictated by eq. \eqref{ccz}. 
Computing these powers,
\begin{align}
 \Delta\left(\alpha\mp \frac{b}{2}\right) -\Delta(\alpha) - \Delta_{\langle 2,1 \rangle}  = b \alpha^{\pm}\ ,
\end{align}
we recover the characteristic exponents $\lambda_\pm$, so that each characteristic exponent corresponds to a primary field in the OPE.
(See also Exercise \ref{exotbf}.) The corresponding solutions are called \textbf{\boldmath $s$-channel}\index{s-channel@$s$-channel} degenerate \textbf{conformal blocks}\index{conformal block}, denoted $\mathcal{F}^{(s)}_\pm(x)$, and depicted
\begin{align}
 \mathcal{F}^{(s)}_\pm(x)  =  
 \begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .4]
\draw (-1,2) node [left] {$\alpha_1$} -- (0,0) -- node [above] {$\alpha_1\mp \frac{b}{2}$} (4,0) -- (5,2) node [right] {$\alpha_2$};
\draw[dashed] (-1,-2) node [left] {$\langle 2,1 \rangle$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$\alpha_3$};
\end{tikzpicture}
\ =\ 
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .7]
\draw[dashed] (0, -2) -- node [below left] {$\langle 2,1 \rangle$} (-2, 0); 
\draw (-2, 0) -- node [above left] {$\alpha_1$} (0, 2) -- node [above right] {$\alpha_2$} (2, 0) -- node [below right] {$\alpha_3$} (0, -2) -- node [left] {$\alpha_1\mp \frac{b}{2}\! \! $} (0, 2); 
\end{tikzpicture}
\  \ ,
\label{gpic}
\end{align}
where the degenerate field is represented as a dashed line.
These degenerate conformal blocks are special cases of the more general conformal blocks of Section \ref{secaco}.


\subsection{Hypergeometric conformal blocks \label{sechcb}}

 Let us define the \textbf{\boldmath hypergeometric equation}\index{hypergeometric equation} with parameters $A,B,C$, 
\begin{align}
 \left\{ x(1-x) \frac{\partial^2}{\partial x^2} +\left[C-(A+B+1)x\right]{\frac{\partial}{\partial x}} - AB \right\} \mathcal{G}(x)= 0\ .
\label{dzp}
\end{align}
Using a change of notations and unknown function,
\begin{align}
 \mathcal{H}(x)= x^{\frac{C}{2}} (x-1)^{\frac{A+B+1-C}{2}}\mathcal{G}(x)\ , \quad \renewcommand{\arraystretch}{1.3}\left\{\begin{array}{l}  j_1 = -\frac{C}{2} \ , \\ j_2=\frac{B-A-1}{2} \ , \\  j_3= \frac{C-A-B-1}{2}\ , \end{array}\right.    
\quad \left\{\begin{array}{l}  A = -1-j_1-j_2-j_3\ , \\ B = -j_1+j_2-j_3\ , \\ C = -2j_1\ , \end{array}\right. 
\end{align}
the hypergeometric equation is equivalent to the twisted hypergeometric equation,
\begin{align}
 \left\{ x(1-x) \frac{\partial^2}{\partial x^2}  -\frac{j_1(j_1+1)}{x}+ j_2(j_2+1)+\frac{j_3(j_3+1)}{x-1}\right\} \mathcal{H}(x) = 0\ .
\label{hj}
\end{align}
The characteristic exponents of the hypergeometric equation at the regular singular point $x=0$ are $\lambda\in \{0,1-C\}$, and the solution $\mathcal{G}(x)$ which corresponds to $\lambda=0$
 is the \textbf{\boldmath hypergeometric function}\index{hypergeometric function}
\begin{align}
 F(A,B,C,x) = \sum_{n=0}^\infty \frac{(A)_n(B)_n}{n!(C)_n}x^n\ ,
\label{fsn}
\end{align}
where $(A)_n = \frac{\Gamma(A+n)}{\Gamma(A)}$.
The solution with the characteristic exponent $\lambda=1-C$ is $x^{1-C}F(A-C+1,B-C+1,2-C,x)$.
The hypergeometric function obeys the identities 
\begin{align}
 F(A,B,C,x) = F(B,A,C,x) = (1-x)^{C-A-B} F(C-A,C-B,C,x)\ .
\label{fff}
\end{align}

In the case of four-point functions, we have the following equivalences of differential equations:
\begin{align}
  \text{BPZ equation \eqref{sode} for}\quad  & \mathcal{F}(x)
\\ 
\Leftrightarrow\quad  \text{hypergeometric\ equation\ for\quad }&  \mathcal{G}(x)= x^{-b\alpha_1}(1-x)^{-b\alpha_3}\mathcal{F}(x) 
\\
\Leftrightarrow\quad  \text{twisted\ hypergeometric\ equation\ for\quad }& \mathcal{H}(x)=(x(1-x))^{-\frac{b^2}{2}}\mathcal{F}(x) \ ,
\label{fgs}
\end{align}
provided the parameters are related as
\begin{align}
\renewcommand{\arraystretch}{1.3}
\left\{\begin{array}{l}   A = \frac12 + b(\alpha_1+\alpha_3-Q) + b(\alpha_2-\tfrac{Q}{2}) \ , \\
      B = \frac12 + b(\alpha_1+\alpha_3-Q) - b(\alpha_2-\tfrac{Q}{2}) \ , \\
      C = 1 + b(2\alpha_1-Q) \ ,
\end{array}\right. 
\label{abc}
\end{align}
or equivalently $\alpha_i = -b^{-1}j_i +\frac{b}{2}$.
(See Exercise \ref{exohge}.) 
Therefore, the solutions of the equation \eqref{sode} which correspond to the characteristic exponents $\lambda_\pm$ \eqref{lpm} at $x=0$ are 
\begin{align}
\left\{\begin{array}{l}  \mathcal{F}^{(s)}_+(x) = x^{b\alpha_1} (1-x)^{b\alpha_3} F(A,B,C,x)\ ,
\\ \mathcal{F}^{(s)}_-(x)  =x^{b(Q-\alpha_1)} (1-x)^{b\alpha_3} F(A-C+1,B-C+1,2-C,x)= \left. \mathcal{F}^{(s)}_+(x) \right|_{\alpha_1\to Q-\alpha_1} \ ,
\end{array}\right. 
\label{gpm}
\end{align}
where the superscript in $\mathcal{F}^{(s)}_\pm(x)$ stands for the $s$-channel basis of solutions.
These formulas are consistent with the invariance of the original differential equation \eqref{sode} under reflections of $\alpha_i$: reflection of $\alpha_1$ exchanges the two solutions, and reflections of $\alpha_2$ and $\alpha_3$ leave each solution invariant, as follows from eq. \eqref{fff}.
The corresponding solutions of the twisted equation \eqref{hj} are 
\begin{align}
\left\{\begin{array}{l}  \mathcal{H}^{(s)}_+(x)  = x^{-j_1}(1-x)^{-j_3} F(-j_1-j_2-j_3-1,-j_1+j_2-j_3,-2j_1,x)\ ,
\\
 \mathcal{H}^{(s)}_-(x)  = x^{j_1+1}(1-x)^{-j_3} F(j_1-j_2-j_3,j_1+j_2-j_3+1,2j_1+2,x)\ .
\end{array}\right. 
\label{fpm}
\end{align}

We can also define the \textbf{\boldmath $t$-channel}\index{t-channel@$t$-channel} basis of solutions, whose elements are associated to the characteristic exponents at the regular singular point $x=1$.
Such solutions are obtained from the $s$-channel solutions by the exchange $\left\{\begin{smallmatrix} 1\leftrightarrow 3\\ x\leftrightarrow 1-x \end{smallmatrix}\right.$, and we find 
\begin{align}
 \left\{\begin{array}{l}  \mathcal{F}^{(t)}_+(x) = x^{b\alpha_1} (1-x)^{b\alpha_3} F(A,B,A+B-C+1,1-x) \ ,
\\ \mathcal{F}^{(t)}_-(x) =x^{b\alpha_1} (1-x)^{b(Q-\alpha_3)} F(C-A,C-B,C-A-B+1,1-x)\ ,
\end{array}\right.  
\end{align}
whose diagrammatic representations are 
\begin{align}
 \mathcal{F}^{(t)}_\pm(x)  =  
 \begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .4]
 \draw (-2,3) node [left] {$\alpha_1$} -- (0,2) -- node [left] {$\alpha_3\mp \frac{b}{2}$} (0,-2);
 \draw[dashed] (0, -2) -- (-2, -3) node [left] {$\langle 2,1 \rangle$};
\draw (0,2) -- (2,3) node [right] {$\alpha_2$};
\draw (0,-2) -- (2, -3) node [right] {$\alpha_3$};
\end{tikzpicture}
\ =\
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .7]
\draw (-2, 0) -- node [above left] {$\alpha_1$} (0, 2) -- node [above right] {$\alpha_2$} (2, 0) -- node [below right] {$\alpha_3$} (0, -2);
\draw[dashed] (0, -2) -- node [below left] {$\langle 2,1 \rangle$} (-2, 0);
\draw (-2, 0) -- node [below] {$\alpha_3\mp \frac{b}{2}$} (2, 0); 
\end{tikzpicture}
\ \ .
\label{tpic}
\end{align}
In order to find the relation between our two bases of solutions, we need the formula
\begin{multline}
 F(A,B,C,x) = \frac{\Gamma(C)\Gamma(C-A-B)}{\Gamma(C-A)\Gamma(C-B)} F(A,B,A+B-C+1,1-x) 
\\
 + \frac{\Gamma(C)\Gamma(A+B-C)}{\Gamma(A)\Gamma(B)} (1-x)^{C-A-B}F(C-A,C-B,C-A-B+1,1-x)\ .
\end{multline}
Together with eq. \eqref{fff}, this implies 
\begin{align}
 \mathcal{F}^{(s)}_i(x) = \sum_{j=\pm} F_{ij} \mathcal{F}^{(t)}_j(x)\ ,
\label{gfg}
\end{align}
where we introduce the \textbf{fusing matrix}\index{fusing matrix} 
\begin{align}
 F = \left[\begin{array}{cc} F_{++} & F_{+-} \\ F_{-+} & F_{--} \end{array}\right] 
= \left[\renewcommand{\arraystretch}{1.3}\begin{array}{cc}
         \frac{\Gamma(C)\Gamma(C-A-B)}{\Gamma(C-A)\Gamma(C-B)} & \frac{\Gamma(C)\Gamma(A+B-C)}{\Gamma(A)\Gamma(B)} 
       \\   \frac{\Gamma(2-C)\Gamma(C-A-B)}{\Gamma(1-A)\Gamma(1-B)} & \frac{\Gamma(2-C)\Gamma(A+B-C)}{\Gamma(A-C+1)\Gamma(B-C+1)}
        \end{array}\right]\ ,
\label{fmd}
\end{align}
whose determinant is 
\begin{align}
 \det F = \frac{1-C}{A+B-C}\ ,
\label{detf}
\end{align}
and whose elements can be represented diagrammatically as
\begin{align}
F_{ij} =
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .7]
\draw (-2, 0) -- node [above left] {$\alpha_1$} (0, 2) -- node [above right] {$\alpha_2$} (2, 0) -- node [below right] {$\alpha_3$} (0, -2) -- (0, 2);
\draw[dashed] (0, -2) -- node [below left] {$\langle 2,1 \rangle$} (-2, 0);
\draw (-2, 0) -- (-.2, 0) node [below left] {$j$}; \draw (.2, 0) -- (2, 0);
\node [above left] at (0, .2) {$i$};
\end{tikzpicture}
\ .
\label{fpic}
\end{align}

Now how can the single-valued four-point function $\left\langle V_{\langle 2,1 \rangle}(x,\bar{x})V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right\rangle$ be decomposed as a combination of our solutions? We assume that we are dealing with a diagonal model, so that the four-point function obeys not only the BPZ equation \eqref{sode}, but also the complex conjugate equation, and must be of the type 
\begin{align}
 \left\langle V_{\langle 2,1 \rangle}(x,\bar{x})V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right\rangle = \sum_{i,j=\pm} c^{(s)}_{ij} \mathcal{F}_i^{(s)}(x) \mathcal{F}_j^{(s)}(\bar{x}) = \sum_{i,j=\pm} c^{(t)}_{ij} \mathcal{F}_i^{(t)}(x) \mathcal{F}_j^{(t)}(\bar{x})\ ,
\end{align}
where $c^{(s)}_{ij}$ and $c^{(t)}_{ij}$ are $x,\bar{x}$-independent coefficients.
These two sets of coefficients are related by the change of basis \eqref{gfg},
\begin{align}
 \sum_{i,j=\pm} c^{(s)}_{ij} F_{ii'} F_{jj'} = c^{(t)}_{i'j'}\ .
\end{align}
Now, single-valuedness near $x=0$ implies $c^{(s)}_{+-}=c^{(s)}_{-+}=0$, and single-valuedness near $x=1$ similarly implies $c^{(t)}_{+-}=c^{(t)}_{-+}=0$.
Thus we can write
\begin{align}
 \left\langle V_{\langle 2,1 \rangle}(x,\bar{x})V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right\rangle = \sum_{i=\pm} c^{(s)}_i \mathcal{F}_i^{(s)}(x) \mathcal{F}_i^{(s)}(\bar{x}) = \sum_{i=\pm} c^{(t)}_i \mathcal{F}^{(t)}_i(x) \mathcal{F}^{(t)}_i(\bar{x})\ ,
\label{zsc}
\end{align}
where the coefficients $c^{(s)}_\pm$ and $c^{(t)}_\pm$ obey the relations 
\begin{align}
 \frac{c^{(s)}_+}{c^{(t)}_-} & = -\frac{F_{-+}}{F_{+-}} \frac{1}{\det F} 
= \frac{\gamma(A)\gamma(B)}{\gamma(C)\gamma(A+B-C)}\ ,
\label{csp}
\\
 \frac{c^{(s)}_+}{c^{(t)}_+} &= \frac{F_{--}}{F_{++}} \frac{1}{\det F}
= \frac{\gamma(C-A)\gamma(C-B)}{\gamma(C)\gamma(C-A-B)}\ , 
\label{csm}
\\
 \frac{c^{(s)}_+}{c^{(s)}_-} & = -\frac{F_{-+}F_{--}}{F_{++}F_{+-}}
 = \frac{\gamma(A)\gamma(B)\gamma(C-A)\gamma(C-B)}{\gamma(C)\gamma(C-1)}\ ,
\label{spsm}
\end{align}
where we introduce the function
\begin{align}
 \gamma(x) = \frac{\Gamma(x)}{\Gamma(1-x)}\ .
\label{gx}
\end{align}
This determines $\left\langle V_{\langle 2,1 \rangle}(x,\bar{x})V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right\rangle$ up to an $x,\bar{x}$-independent factor. 


\section{Exercises}

\begin{exo}[Spanning set for a highest-weight representation]
 ~\label{exospan}
Assuming $|\Delta\rangle$ to be a primary state, prove the equality $U(\mathfrak{V})|\Delta\rangle =U(\mathfrak{V}^+)|\Delta\rangle$ in eq. \eqref{ruv}.
To do this, prove that any state of the type $\prod_{i=1}^p L_{n_i}|\Delta\rangle$ with $n_1,\cdots n_p\in {\mathbb{Z}}$ belongs to $U(\mathfrak{V}^+)|\Delta\rangle$.
The proof can be done by hand in the cases $p=0,1,2$, and then by induction on $p$.
\end{exo}

\begin{exo}[Alternative spanning set for a Verma module]
 ~\label{exoot}
In $U(\mathfrak{V}^+)$, write the states belonging to  $\{\prod_{i=1}^p L_{-n_i}\}_{n_i\in\{1,2\}}$ up to the level $N=5$, and compare with the known basis \eqref{lels}.
For which levels do we obtain a basis? Explain the observed results by studying whether $L_{-1}$ and $L_{-2}$ are algebraically independent.
In particular, show that the Virasoro commutation relations \eqref{vir} imply a relation of the type
\begin{align}
 [L_{-1},[L_{-1},[L_{-1},L_{-2}]]] \propto [L_{-2},[L_{-1},L_{-2}]]\ .
 \label{llll}
\end{align}
\end{exo}

\begin{exo}[Singular vectors at the level $N=4$]
~\label{exolf}
 Compute the singular vectors at the level $N=4$, and write the results in a table analogous to \eqref{lot}.
In particular, show that the five coefficients of the singular vectors obey five linear equations, and that the determinant of the system is a polynomial of degree three in the conformal dimension $\Delta$. 
If $\Delta_{\langle 2,2 \rangle} = \Delta_{\langle 4, 1\rangle}$, do the corresponding singular vectors coincide?
% Answer: yes.
\end{exo}

\begin{exo}[Singular vectors at higher levels]
~\label{exohl}
 For a null vector $|\chi\rangle$ at level $N$ with $p(N)$ coefficients, how many equations do the constraints $L_1|\chi\rangle = L_2|\chi\rangle = 0$ provide? Count the excess equations using the pentagonal number theorem, and explain their existence using eq. \eqref{llll}.
 
 Write a computer program for computing singular vectors at arbitrary levels, and check that at level $N$ the number of Verma modules which have a singular vector is the number of factorizations of $N$ into two positive integers.
The program should preferably be written using free, open-source software.
\end{exo}

\begin{exo}[Singular vectors that are not of the type $|\chi_{\langle r,s \rangle}\rangle$]
 ~\label{exosv}
Show that the existence of two singular vectors in the same Verma module implies the rationality of $b^2$. 
From now on we assume $b^2=-\frac{q}{p}$ where $p,q$ are strictly positive integers.
Prove the identities 
\begin{align}
 \Delta_{\langle r,s \rangle}=\Delta_{\langle r+p,s+q \rangle}=\Delta_{\langle p-r,q-s \rangle}\ .
\end{align}
Under suitable assumptions on $r$ and $s$, show that $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$ has two singular vectors $|\chi_{\langle r,s \rangle}\rangle$ and $|\chi_{\langle p-r,q-s \rangle}\rangle$.
Show that each one of the two states  $|\chi_{\langle r,s \rangle}\rangle$ and $|\chi_{\langle p-r,q-s \rangle}\rangle$ has a descendent which is itself a singular vector at the level $pq+qr-ps$ in $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$.
Assuming that these two singular vectors, which live at the same level $pq+qr-ps$, are in fact identical, enumerate all the singular vectors of $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$.
Which ones are of the type $|\chi_{\langle r',s' \rangle}\rangle$? In particular, show that the singular vector at the level $pq+qr-ps$ is not of this type in $\mathcal{V}_{\Delta_{\langle r,s \rangle}}$, although it is of this type when considered as a singular vector of the Verma modules generated by $|\chi_{\langle r,s \rangle}\rangle$ and $|\chi_{\langle p-r,q-s \rangle}\rangle$.
\end{exo}

\begin{exo}[Characters of Virasoro representations]
 ~\label{exochar}
For a representation $R$ of the Virasoro algebra, let us define the character 
\begin{align}
 \operatorname{ch}_R(y) = \operatorname{Tr}_R y^{L_0-\frac{c}{24}}\ .
\end{align}
Show that the character of a Verma module is 
\begin{align}
 \operatorname{ch}_{\mathcal{V}_P}(y) = \frac{y^{P^2}}{\eta(y)}\ ,
\end{align}
where $\eta(y) = y^{\frac{1}{24}}\prod_{n=1}^\infty(1-y^n)$ is the Dedekind eta function, and the notation $P$ for the momentum is defined in eq. \eqref{pdef}. 
Deduce that for generic values of the central charge, the character of a maximally degenerate representation is 
\begin{align}
 \operatorname{ch}_{R_{\langle r,s\rangle}} = \frac{y^{P^2_{\langle r,s\rangle}} - y^{P^2_{\langle -r,s\rangle}}}{\eta(y)}\ .
\end{align}
Finally, let $b^2=-\frac{q}{p}$ where $p,q$ are strictly positive integers, and let $1\leq r\leq p-1$ and $1\leq s\leq q-1$. Using the results of Exercise \ref{exosv}, show that 
\begin{align}
 \operatorname{ch}_{R_{\langle r,s\rangle}} = 
 \sum_{k\in\mathbb{Z}} \frac{y^{P^2_{\langle r, s+2qk\rangle}} - y^{P^2_{\langle r, -s+2qk\rangle}}}{\eta(y)}\ .
\end{align}
\end{exo}

\begin{exo}[Singular vectors and Gram matrices]
 ~\label{exodmn}
 In a Verma module with a Hermitian form, let $M^{(N)}$ be the level $N$ Gram matrix. Show that the following statements are equivalent:
 \begin{itemize}
  \item $\det M^{(N)}=0$,
  \item there is a level $N$ state that is orthogonal to all states,
  \item there is a nontrivial subrepresentation that has a nonzero state at the level $N$,
  \item there is a singular vector at a level $N'\leq N$.
 \end{itemize}
(To construct the nontrivial subrepresentation, consider the space of states that are orthogonal to all states in the Verma module.)
\end{exo}


\begin{exo}[Unitarity of Virasoro representations]
~\label{exoun}
Show that the Gram matrix $M^{(N)}$ of the level-$N$ subspace of the Verma module $\mathcal{V}_\Delta$ is positive definite in the limit $c\to \infty$, provided  $\Delta >0$. 
To do this, show that in this limit the diagonal elements of $M^{(N)}$ coincide with its eigenvalues, provided $M^{(N)}$ is written in a basis of creation operators of the type $(\prod_i L_{-n_i}) L_{-1}^p$ with $n_i\geq 2$.
In other words, the Virasoro algebra \eqref{vir} effectively reduces to a sum of commuting finite-dimensional subalgebras, 
\begin{align}
 \underset{c\to \infty}{\lim} \mathfrak{V}  
=  \operatorname{Span}(L_{-1},L_0,L_1) \oplus \bigoplus_{n=2}^\infty \operatorname{Span} (L_{-n}, L_n)\ .
\end{align}
\end{exo}

\begin{exo}[Derivatives of Witt algebra generators]
 ~\label{exowitt}
On which space of functions can the Witt algebra generators \eqref{elln} act? 
Show that the point $z_0=0$ plays a special role. Performing a translation, show that the Witt algebra has the representation
\begin{align}
 \ell_n^{(z_0)} = -(z-z_0)^{n+1}{\frac{\partial}{\partial z}}\ ,
\end{align}
and deduce a Witt algebra version of the Virasoro algebra relation \eqref{pll}.
\end{exo}

\begin{exo}[Behaviour of the energy-momentum tensor at infinity]
 ~\label{exoti}
 If $z$ has dimension $-1$, what is the dimension of $L_{-1}$ according to eq. \eqref{lvpv}? Then what is the dimension of $T(y)$? Deduce that the differential $T(y)dy^2$ is dimensionless, and should be holomorphic at infinity. Taking $\frac{1}{y}$ to be the natural coordinate at infinity, compare $T(y)dy^2$ with the holomorphic differential $\left(d(\frac{1}{y})\right)^2$, and deduce eq. \eqref{tyi}.
\end{exo}


\begin{exo}[Virasoro algebra and OPE] 
~\label{exott}
Show that the $T(y)T(z)$ OPE \eqref{tt}, the commutativity axiom $T(y)T(z) = T(z)T(y)$, and the expansion \eqref{tsl} of $T(y)$ into modes $L_n^{(z_0)}$, imply that such modes obey the Virasoro commutation relations \eqref{vir} for any choice of $z_0$.
To do this, write 
\begin{align}
 [L_n^{(z_0)},L_m^{(z_0)}] = -\frac{1}{4\pi^2} \left(\oint_{z_0} dy \oint_{z_0} dz - \oint_{z_0} dz \oint_{z_0} dy\right) (y-z_0)^{n+1}(z-z_0)^{m+1} T(y)T(z)\ ,
\end{align}
and use contour manipulations to show that 
\begin{align}
 \oint_{z_0} dy \oint_{z_0} dz - \oint_{z_0} dz \oint_{z_0} dy = \oint_{z_0} dy \oint_y dz\ .
\end{align}
Explain why regular terms in the $T(y)T(z)$ OPE do not contribute to the result.
\end{exo}

\begin{exo}[From the identity field to the energy-momentum tensor]
 ~\label{exoit}
By comparing it with the general $T(y)V_\sigma(z)$ OPE \eqref{tv}, show that the $T(y)T(z)$ OPE \eqref{tt} encodes the equations
\begin{align}
 L_{-1}T(z) &= \partial T(z) \ ,
\label{lmt}
\\
L_0 T(z) &= 2 T(z)\ ,
\\
L_1 T(z) &= 0 \ ,
\\
L_2 T(z) &= \frac{c}{2} I\ ,
\\
L_{n\geq 3} T(z) &= 0 \ .
\label{lgt}
\end{align}
With the help of eq. \eqref{pll}, show that these equations follow from 
\begin{align}
 \partial I & = 0\ ,
\label{piz}
\\
 L_{n\geq -1} I& = 0\ ,
\\
L_{-2}^{(z)}I & = T(z)\ ,
\label{let}
\end{align}
\end{exo}

\begin{exo}[Computing OPE coefficients]
 ~\label{exohf}
Compute the OPE coefficients $f^{\Delta,L}_{\Delta_1,\Delta_2}$ at the level $|L|= 2$ by solving the linear equations \eqref{eq:lwo}.
Compare your results with the available literature.
Write the equations for the OPE coefficients at the level $|L|=3$. 
More generally, show that $f^{\Delta,L}_{\Delta_1,\Delta_2}$ is uniquely determined for generic values of $\Delta$, 
by counting the equations and unknowns in eq. \eqref{eq:lwo}, as in Exercise \ref{exohl}.
Discuss how the presence of a null vector affects the equations for $f^{\Delta,L}_{\Delta_1,\Delta_2}$, starting with the case $\Delta=0$. 
\end{exo}

\begin{exo}[Fusion rules from OPEs]
 ~\label{exooit}
Rederive the fusion rule \eqref{rot} by analyzing the corresponding OPE.
% NB: include this in main text!?
If $C$ is a contour around both $z_1$ and $z_2$, insert $\oint_C dz\ T(z)$ and $\oint_C dz\ \frac{1}{z-z_2}T(z)$ on both sides of that OPE, and compute the leading terms of the OPEs $V_{\Delta_1}(z_1) LV_{\langle 2,1 \rangle}(z_2)$ with $L\in\{L_{-1},L_{-1}^2,L_{-2}\}$, before using $L_{\langle 2,1 \rangle} V_{\langle 2,1 \rangle} (z_2) =0$. 
\end{exo}

\begin{exo}[Creation operators as differential operators]
 ~\label{exodma}
 Check that the representation \eqref{lmn} of creation operators $L_{-n}^{(z_i)}$ (with $n\geq 1$) as differential operators in $z_1,\cdots z_N$, is consistent with the commutation relations of the Virasoro algebra. 
\end{exo}

\begin{exo}[Quasi-primary fields and representations of $\mathfrak{sl}_2$]
 ~\label{exoqp}
By the state-field correspondence, a quasi-primary field $V_\Delta(z)$ corresponds to a representation of the algebra of global conformal transformations $\mathfrak{sl}_2^{(z)} = \operatorname{Span}(L_{-1}^{(z)},L_0^{(z)},L_1^{(z)})$.
Using the definition \eqref{lolz}, identify this representation as a highest-weight representation.
How is this compatible with eq. \eqref{tgv}, which suggests that $V_\Delta(z)$ transforms in a generic representation of $SL_2({\mathbb{C}})$? To solve the apparent contradiction, consider how the algebra $\mathfrak{sl}_2^{(z)}$ depends on the choice of $z$, and how $\mathfrak{sl}_2^{(z')}$ with $z'\neq z$ acts on representations of $\mathfrak{sl}_2^{(z)}$.
\end{exo}

\begin{exo}[Logarithmic conformal field theory]
 ~\label{exolog}
Consider a finite-dimensional vector space $E$ with a linear action of $L_0$, and the representation $R=U(\mathfrak{V}^+)E$ of the Virasoro algebra obtained by assuming $L_{n>0}E=0$.
Assume that $R$ is indecomposable but reducible: what does this mean for the action of $L_0$ on $E$, and the corresponding matrix? Let $V_v(z)$ be the field which corresponds to a vector $v\in E$: write the global Ward identities for correlation functions of such fields, and prove 
\begin{align}
 {\frac{\partial}{\partial z_i}} \left\langle z_{12}^{L_0^{(1)}+L_0^{(2)}-L_0^{(3)}} z_{23}^{L_0^{(2)}+L_0^{(3)}-L_0^{(1)}} z_{13}^{L_0^{(1)}+L_0^{(3)}-L_0^{(2)}} \prod_{i=1}^3 V_{v_i}(z_i)\right\rangle = 0\ .
\end{align}
Compare the three-point function $\left\langle  \prod_{i=1}^3 V_{v_i}(z_i)\right\rangle$ with the three-point function \eqref{fzzz} of primary fields.
In the simplest example when $E$ is two-dimensional, show that the three-point function involves not only powers of $z_{ij}$, but also logarithms.
Finally, cite an example of a reducible Verma module, and conclude that 
a conformal field theory can involve indecomposable, reducible representations without being logarithmic. 
\end{exo}


\begin{exo}[Third-order BPZ equation]
 ~\label{exotob}
 Write the BPZ equation for an $N$-point function involving a degenerate field $V_{\langle 1,3 \rangle}(x)$.
In the case $N=3$, rederive the relevant fusion rule.
\end{exo}

\begin{exo}[Third-order BPZ equation for a four-point function]
 ~\label{exotbf}
 Write the third-order BPZ ordinary differential equation for the four-point function $\left\langle V_{\langle 3,1 \rangle}(x)V_{\Delta_1}(0)V_{\Delta_2}(1)V_{\Delta_3}(\infty)\right\rangle $.
Check that the characteristic exponents at $x=0,1,\infty$ are consistent with the fusion rules. 
\end{exo}


\begin{exo}[Hypergeometric form of the second-order BPZ equation for a four-point function]
 ~\label{exohge}
 Check that the change of unknown function $\mathcal{F}(x)=x^{\lambda}(1-x)^{\mu}\mathcal{G}(x)$ in the second-order BPZ equation \eqref{sode} leads to a hypergeometric equation \eqref{dzp} for $\mathcal{G}(x)$, provided $\lambda$ and $\mu$ are suitably chosen.
What are the four possible choices for the pair $(\lambda,\mu)$?
Show that the choice $\lambda=b\alpha_1,\ \mu=b\alpha_3$ leads to the values of $A,B,C$ given in eq. \eqref{abc}. 
\end{exo}


% Ensuring the coming chapter begins on an odd-numbered page, in case we want to print the document in two halves.

\cleardoublepage

\chapter{Liouville theory and minimal models \label{seccbm}}

In this Chapter we introduce and solve Liouville theory, generalized minimal models, and A-series minimal models, which are the simplest nontrivial families of two-dimensional conformal field theories. 

\section{Liouville theory \label{secliou}}

\subsection{Definition and spectrum \label{secspe}}

We assume 
\begin{enumerate}
 \item that Liouville theory is a family of conformal field theories, parametrized by the central charge $c\in\mathbb{C}$;
\item that each theory has a continuous spectrum, where representations of the symmetry algebra $\mathfrak{V}\times\overline{\mathfrak{V}}$ have multiplicities zero or one;
\item that Liouville theory with $c>1$ is unitary;
\item and that correlation functions are smooth as functions of $c$ and of the conformal dimensions of the fields, in a sense which we will make more precise.
\end{enumerate}
Since the spectrum is continuous, it must involve Verma modules -- the other type of highest-weight representations, degenerate representations, form a discrete set. 
From Section \ref{secuni}, we know that unitary Verma modules exist only if $c\geq 1$. 
So we can assume unitarity only if $c\geq 1$, and to avoid subtleties due to the existence of degenerate representations with positive dimensions for $c=1$, we actually assume unitarity only if $c>1$. 

When deriving the fusion rules \eqref{rtv} involving degenerate fields, we have seen that the natural parameters are not the conformal dimension $\Delta$ and the central charge $c$ -- rather, the momentum $\alpha$ \eqref{daq} and the Liouville coupling constant $b$ \eqref{cqb}.
We assume that correlation functions are analytic as functions of $\alpha$ and $b$, with possibly poles, but no branch cuts. 
We will however see that analyticity in $b$ breaks down on the $c\leq 1$ line.

Let us assume $c>1$ for a moment, and determine the spectrum from the unitarity and analyticity assumptions. 
The set of values of $\alpha$ which obey the unitarity condition $\Delta(\alpha)> 0$ is the union of the segment $\alpha\in]0,Q[$ and the line $\alpha \in \frac{Q}{2}+i{\mathbb{R}}$:
\begin{align}
 \begin{tikzpicture}[scale = .7, baseline=(current  bounding  box.center)]
  \draw[-latex, very thin] (-1, 0) -- (0, 0) node[below right] {$0$} -- (2, 0) node[below right] {$\frac{Q}{2}$} -- (4, 0) node [below] {$Q$} -- (5, 0) node[above] {$\alpha$};
  \draw[red, ultra thick, dashed] (0, 0) -- (4, 0);
  \draw[red, ultra thick] (2, -3) -- (2, 3);
  \draw[very thin] (0, -3) -- (0, 3);
 \end{tikzpicture}
\end{align}
We interpret our analyticity assumptions as implying that the set of values of $\alpha$ which appear in the spectrum has no endpoints. 
We must then leave the segment $]0,Q[$ out, and build the spectrum from the line
\begin{align}
 \alpha \in \frac{Q}{2}+i{\mathbb{R}} \quad \Leftrightarrow \quad \Delta \in \left[\frac{c-1}{24},\infty\right[\ .
\label{aqd}
\end{align}
The representation $\mathcal{V}_\Delta\otimes \overline{\mathcal{V}}_{\bar{\Delta}}$ can appear in the spectrum only if both 
$\Delta$ and $\bar{\Delta}$ obey this condition. 
Moreover, single-valuedness of correlation functions requires $\Delta-\bar{\Delta}\in {\mathbb{Z}} $, see eq. \eqref{dbdz}.
By continuity, $\Delta-\bar{\Delta}$ must be a constant, and this constant must be zero for both $\Delta$ and $\bar{\Delta}$ to span the whole half-line $\left[\frac{c-1}{24},\infty\right[$.
Therefore, the spectrum must be diagonal,
\begin{align}
 \boxed{ S= \frac12\int_{\frac{Q}{2}+i{\mathbb{R}}} d\alpha\ \mathcal{V}_\alpha \otimes \overline{\mathcal{V}}_\alpha = \int_{\frac{c-1}{24}}^\infty d\Delta\ \mathcal{V}_\Delta\otimes \overline{\mathcal{V}}_\Delta} \ ,
\label{sad}
\end{align}
where the $\frac12$ factor in front of the integral over $\alpha$ is meant to eliminate the redundancy which comes from the reflection relation $\mathcal{V}_\alpha=\mathcal{V}_{Q-\alpha}$. 

We assume that the spectrum \eqref{sad} that we obtained for $c>1$ also holds for any $c\in\mathbb{C}$ by analyticity. 
(If $c\notin\mathbb{R}$  this gives us $\Delta \in \frac{c-1}{24} + \mathbb{R}_+$ as the correct interpretation of $\Delta \in \left[\frac{c-1}{24},\infty\right[$.)
A subtlety occurs if the line $\alpha \in \frac{Q}{2}+i\mathbb{R}$ contains degenerate values $\alpha_{\langle r, s\rangle}$, which happens if and only if $c\leq 1$ i.e. $Q\in i\mathbb{R}$. 
These degenerate values would lead to singularities in the decomposition \eqref{fsd} of four-point functions into conformal blocks, as the conformal block $\mathcal{F}_{\Delta_s}^{(s)}(\sigma_i|z_i)$ has poles at $\Delta_s = \Delta_{\langle r, s\rangle}$. 
The solution is simply to replace the line $\alpha \in \frac{Q}{2} + i\mathbb{R} = i\mathbb{R}$ with the slightly shifted line 
\begin{align}
 (c\leq 1) \qquad \alpha \in i\mathbb{R} + \epsilon\ ,
\end{align}
and the four-point function will turn out to be independent of the value of the regularizing parameter $\epsilon \in \mathbb{R}^*$. 
This subtlety with the spectrum is a first hint that something special happens if $c\leq 1$ -- we will find subtleties with the three-point structure constants too. 

So the spectrum of Liouville theory does not contain any degenerate representation. 
Nevertheless, we make the crucial assumption 
\begin{enumerate}
\setcounter{enumi}{4}
 \item that degenerate fields exist, and in particular obey the axioms of associativity of OPEs, and single-valuedness of correlation functions.
\end{enumerate}
This assumption will allow us to consider four-point functions that obey BPZ differential equations, and lead to simple crossing symmetry equations.

\subsection{The reflection relation and its consequences}

Since we
use the momentum $\alpha$ instead of the conformal dimension $\Delta$ for parametrizing representations, we a priori have two notations $V_\alpha(z,\bar{z})$ and $V_{Q-\alpha}(z,\bar{z})$ for the primary field which corresponds to the representation $\mathcal{V}_\alpha \otimes \overline{\mathcal{V}}_\alpha$.
We must therefore have a \textbf{\boldmath reflection relation}\index{reflection relation}
\begin{align}
 \boxed{V_\alpha(z,\bar{z})= R(\alpha) V_{Q-\alpha}(z,\bar{z})}\ ,
\label{vrv}
\end{align}
where $R(\alpha)$ is the \textbf{\boldmath reflection coefficient}\index{reflection coefficient}, which must obey 
\begin{align}
 R(\alpha)R(Q-\alpha)=1\ ,
\label{rrr}
\end{align}
so that in particular $R(\frac{Q}{2})\in\{1, -1\}$.
By the reflection relation, commutativity \eqref{comm}, and conformal symmetry \eqref{fzz}, a two-point function must be of the type 
\begin{align}
 \Big\langle V_{\alpha_1}(z_1,\bar{z}_1) V_{\alpha_2}(z_2,\bar{z}_2)\Big\rangle = c(\alpha_1) \Big\{ \delta(Q-\alpha_1-\alpha_2) + R(\alpha_1)\delta(\alpha_1-\alpha_2)\Big\} |z_{12}|^{-4\Delta(\alpha_1)}\ , 
\label{vvc}
\end{align}
where the coefficient $c(\alpha)$ must obey $c(\alpha)=c(Q-\alpha)$, and is otherwise undetermined.
Since both $c(\alpha)$ and $R(\alpha)$ can be absorbed in a field renormalization, 
\begin{align}
 V_\alpha(z,\bar{z}) \to \lambda(\alpha)  V_\alpha(z,\bar{z}) \ ,
\label{vlv}
\end{align}
we are free to assume
\begin{align}
 c(\alpha)=1\ .
\end{align}
We however keep $R(\alpha)$ undetermined, as this will later be necessary for ensuring the analyticity of correlation functions.
This leaves us with the freedom to perform a field renormalization, provided the factor $\lambda(\alpha)$ obeys
\begin{align}
 \lambda(\alpha)\lambda(Q-\alpha) = 1\ .
\label{llo}
\end{align}
Omitting the dependence on $z_i$, we schematically rewrite the two-point function as 
\begin{align}
 \boxed{\left\langle V_{\alpha_1}V_{\alpha_2} \right\rangle = \delta(Q-\alpha_1-\alpha_2) + R(\alpha_1)\delta(\alpha_1-\alpha_2) }\ .
\label{vvss}
\end{align}
According to eq. \eqref{cff}, the three-point function takes the form
\begin{align}
\left\langle \prod_{i=1}^3 V_{\alpha_i}(z_i,\bar{z}_i)\right\rangle = C_{\alpha_1,\alpha_2,\alpha_3}\ |z_{12}|^{2(\Delta_3-\Delta_1-\Delta_2)} |z_{23}|^{2(\Delta_1-\Delta_2-\Delta_3)} |z_{31}|^{2(\Delta_3-\Delta_2-\Delta_1)}\ ,
\label{vvv}
\end{align}
where $\Delta_i = \Delta(\alpha_i)$ is given in eq. \eqref{daq}.
We schematically rewrite this formula as 
\begin{align}
 \boxed{ \left\langle V_{\alpha_1}V_{\alpha_2}V_{\alpha_3} \right\rangle = C_{\alpha_1,\alpha_2,\alpha_3} }\ .
\label{vvvs}
\end{align}
The three-point structure constant $C_{\alpha_1,\alpha_2,\alpha_3}$ is constrained by the reflection relation, for instance
\begin{align}
 C_{\alpha_1,\alpha_2,\alpha_3} = R(\alpha_1) C_{Q-\alpha_1,\alpha_2,\alpha_3}\ .
\label{crc}
\end{align}
Adapting eq. \eqref{vvs} and eq. \eqref{ccz}, the OPE is in our notations
\begin{multline}
 V_{\alpha_1}(z_1,\bar{z}_1) V_{\alpha_2}(z_2,\bar{z}_2) = \frac12 \int_{\frac{Q}{2}+i{\mathbb{R}}} d\alpha\ C_{\alpha_1,\alpha_2}^\alpha |z_{12}|^{2(\Delta-\Delta_1-\Delta_2)} 
\\ \times 
\sum_{L,\bar{L}\in \mathcal{L}} f_{\Delta_1,\Delta_2}^{\Delta,L} f_{\Delta_1,\Delta_2}^{\Delta,\bar{L}}z_{12}^{|L|} \bar{z}_{12}^{|\bar{L}|} L\bar{L} V_{\alpha}(z_2,\bar{z}_2) \ , 
\label{vvh}
\end{multline}
for some coefficient $C_{\alpha_1,\alpha_2}^\alpha$.
Schematically,
\begin{align}
 \boxed{V_{\alpha_1}V_{\alpha_2} \sim \frac12\int_{\frac{Q}{2}+i{\mathbb{R}}} d\alpha\ C_{\alpha_1,\alpha_2}^{\alpha} V_\alpha}\ .
\label{vvi}
\end{align}
Inserting this OPE in the three-point function \eqref{vvvs}, and using the two-point function \eqref{vvss}, we obtain
\begin{align}
 \frac12\left(R(\alpha_3)C_{\alpha_1,\alpha_2}^{\alpha_3} + C_{\alpha_1,\alpha_2}^{Q-\alpha_3}\right) = C_{\alpha_1,\alpha_2,\alpha_3}
\ . 
\label{hcc}
\end{align}
(Compare with eq. \eqref{cftt}.) 
This equation does not fully determine $C_{\alpha_1,\alpha_2}^{\alpha_3}$.
Actually, the very definition of $C_{\alpha_1,\alpha_2}^{\alpha_3}$ as the coefficient of $V_{\alpha_3}$ in an OPE is ambiguous, because $V_{\alpha_3}$ is related to $V_{Q-\alpha_3}$ by the reflection relation.
We  resolve this ambiguity by assuming $C_{\alpha_1,\alpha_2}^{Q-\alpha_3}=R(\alpha_3)C_{\alpha_1,\alpha_2}^{\alpha_3}$.
We then obtain
\begin{align}
 \boxed{C_{\alpha_1,\alpha_2}^{\alpha_3} = C_{\alpha_1,\alpha_2,Q-\alpha_3}}\ .
\label{cec}
\end{align}

Let us discuss OPEs involving degenerate fields of the type $V_{\langle r,s \rangle}$.
Remembering the fusion rules \eqref{rtv}, an OPE involving $V_{\langle r,s \rangle}$ must be of the type
\begin{align}
 \boxed{V_{\langle r,s \rangle} V_\alpha \sim \sum_{i=0}^{r-1}\sum_{j=0}^{s-1} C_{i,j}^{\langle r,s \rangle}(\alpha) V_{\alpha+\alpha_{\langle r,s \rangle}+ib+jb^{-1}}}\ .
\label{vrsv}
\end{align}
In analogy with eq. \eqref{cec}, the OPE coefficient $C_{i,j}^{\langle r,s \rangle}(\alpha)$ is related to a three-point structure constant  as 
\begin{align}
 C_{i,j}^{\langle r,s \rangle}(\alpha) = C_{\langle r,s \rangle\, ,\, \alpha\, ,\, Q-\alpha-\alpha_{\langle r,s \rangle}-ib-jb^{-1}}\ , 
\end{align}
where $C_{\langle r,s \rangle, \alpha_2,\alpha_3}$ is invariant under the permutation of $\alpha_2$ and $\alpha_3$, and covariant under reflections of $\alpha_2$ and $\alpha_3$.
In the particular case of the OPE of a degenerate field $V_{\langle 2,1 \rangle}$,
\begin{align}
 \boxed{V_{\langle 2,1 \rangle} V_\alpha \sim C_+(\alpha) V_{\alpha-\frac{b}{2}} + C_-(\alpha) V_{\alpha+\frac{b}{2}}}\ ,
\label{vot}
\end{align}
 these invariances imply 
\begin{align}
 C_+(\alpha) &= C_+(Q-\alpha+\tfrac{b}{2})\ ,
\label{cpcp}
\\
C_-(\alpha) & = \frac{R(\alpha)}{R(\alpha+\tfrac{b}{2})} C_+(\alpha+\tfrac{b}{2})\ . 
\label{cmcp}
\end{align}
Performing the substitution $b\to \frac{1}{b}$, we obtain
the OPE of the degenerate field $V_{\langle 1,2 \rangle}$,
\begin{align}
\boxed{V_{\langle 1,2 \rangle} V_\alpha \sim \tilde{C}_+(\alpha) V_{\alpha-\frac{1}{2b}} + \tilde{C}_-(\alpha) V_{\alpha+\frac{1}{2b}}}\ ,
 \label{vto}
\end{align}
and relations involving the coefficients $\tilde{C}_+(\alpha)$ and $\tilde{C}_-(\alpha)$. 

Finally, we use the same notations for the reflection relation \eqref{vrv} and OPE \eqref{vrsv} of a degenerate field $V_{\langle r',s'\rangle}$ as for a non-degenerate field $V_{\alpha}$, with the reflection coefficient $R(\alpha_{\langle r',s'\rangle})$ and OPE coefficients $C_{i,j}^{\langle r,s \rangle}(\alpha_{\langle r',s'\rangle})$. 
Our notations suggest that these coefficients are related to $R(\alpha)$ and $C_{i,j}^{\langle r,s \rangle}(\alpha)$ by analytic continuation. 
This will turn out to be true, although we do not assume it. 


\subsection{Conformal bootstrap equations \label{seccbe}}

We can now investigate the consequences of the associativity of the OPE, whose general form was given in eq. \eqref{cccc}.
Let us begin with an OPE involving the degenerate field  $V_{\langle 1,1 \rangle}$,
\begin{align}
\boxed{V_{\langle 1,1 \rangle}V_\alpha \sim  C_0(\alpha) V_\alpha} \ .
\end{align}
The field $V_{\langle 1,1 \rangle}(x)$ actually does not depend on $x$ (see eq. \eqref{pvoo}), and $V_{\langle 1,1 \rangle}(x)V_{\alpha_1}(z_1) = C_0(\alpha_1) V_{\alpha_1}(z_1)$ holds not only at $x=z_1$, but for any $x$.
Considering  
$V_{\langle 1,1 \rangle}(x)V_{\alpha_1}(z_1)V_{\alpha_2}(z_2)$ and using associativity, we this leads to $C_0(\alpha_1)=C_0(\alpha_2)$.
So $C_0(\alpha)$ 
is an $\alpha$-independent constant, which we choose to be one,
\begin{align}
\boxed{ C_0(\alpha) = 1}\ .
\label{cza}
\end{align}
This amounts to assuming that $V_{\langle 1,1 \rangle}$ is the identity field. 

Let us consider the four-point function 
\begin{align}
 \Big\langle V_{\langle 2,1\rangle}(x) V_\alpha(0) V_{\langle 1, 2\rangle}(\infty) V_{\frac{3Q}{2}-\alpha}(1)\Big\rangle\ .
\end{align}
The $s$- and $t$-channel decompositions \eqref{zsc} of this four-point function each involve only one term $c_+^{(s)}\left|\mathcal{F}_+^{(s)}\right|^2 = c_+^{(t)}\left|\mathcal{F}_+^{(t)}\right|^2$, as dictated by the fusion rules of the degenerate fields $V_{\langle 2,1\rangle}$ and $V_{\langle 1, 2\rangle}$. 
The coefficients $c_+^{(s)}$ and $c_+^{(t)}$ can be expressed as OPE structure constants,
\begin{align}
 c_+^{(s)} &= C_+(\alpha)\tilde{C}_+(\alpha-\tfrac{b}{2}) \ ,
 \\
 c_+^{(t)} &= \tilde{C}_+(\alpha)C_+(\alpha-\tfrac{1}{2b})\ .
\end{align}
The ratio of these coefficients is given by eq. \eqref{csm}, which boils down to $1$ in our case (due to $A=0$). 
We therefore obtain 
\begin{align}
 C_+(\alpha)\tilde{C}_+(\alpha-\tfrac{b}{2}) = \tilde{C}_+(\alpha)C_+(\alpha-\tfrac{1}{2b})\ .
\label{ctc}
\end{align}
As shown in Exercise \ref{exonorm}, this implies that there is a field normalization such that 
\begin{align}
 \boxed{C_+(\alpha) = \tilde{C}_+(\alpha) = 1}\ ,
\label{cco}
\end{align}
and we adopt this normalization. 

Consider now the four-point function
\begin{align}
 \Big\langle V_{\langle 2,1 \rangle}(x) V_\alpha(0) V_{Q-\alpha}(\infty) V_{\langle 2,1 \rangle}(1)\Big\rangle\ .
\label{zvv}
\end{align}
The decompositions \eqref{zsc} of this four-point function involve the conformal blocks
 \begin{align}
\mathcal{F}^{(s)}_\pm = 
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .6]
\draw[dashed] (2, 0) -- node [below right] {\!\!\!$\langle 2,1 \rangle$} (0, -2) -- node [below left] {$\langle 2,1 \rangle$\!\!\!} (-2, 0); 
\draw (-2, 0) -- node [above left] {$\alpha$\!\!\!} (0, 2) -- node [above right] {\!\!\!\!$Q-\alpha$} (2, 0);
\draw (0, -2) -- node [left] {$\alpha\mp \frac{b}{2}\! \! $} (0, 2); 
\end{tikzpicture}
, \quad
 \mathcal{F}^{(t)}_-  =  
 \begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .55]
\draw (-2, 0) -- node [above left] {$\alpha$\!\!\!} (0, 2) -- node [above right] {\!\!\!\!$Q-\alpha$} (2, 0);
\draw[dashed] (0, -2) -- node [below left] {$\langle 2,1 \rangle$\!\!\!} (-2, 0) -- node [below] {$\langle 1,1 \rangle$} (2, 0) -- node [below right] {\!\!\!$\langle 2,1 \rangle$} (0, -2); 
\end{tikzpicture}
, \quad
 \mathcal{F}^{(t)}_+  =  
 \begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .55]
\draw (-2, 0) -- node [above left] {$\alpha$\!\!\!} (0, 2) -- node [above right] {\!\!\!\!$Q-\alpha$} (2, 0);
\draw[dashed] (0, -2) -- node [below left] {$\langle 2,1 \rangle$\!\!\!} (-2, 0) -- node [below] {$\langle 3,1 \rangle$} (2, 0) -- node [below right] {\!\!\!$\langle 2,1 \rangle$} (0, -2); 
\end{tikzpicture}
.
\end{align}
The coefficients $c^{(s)}_\pm,c^{(t)}_\pm$ of the decompositions of the four-point function can now be expressed in terms of OPE structure constants, with each triangle in the above diagrams corresponding to one structure constant, so that 
\begin{align}
 c^{(s)}_+ &= C_-(\alpha-\tfrac{b}{2})C_+(\alpha) = \frac{R(\alpha-\tfrac{b}{2})}{R(\alpha)}\ ,
\\
c^{(t)}_- & = C_-(-\tfrac{b}{2}) C_0(\alpha)= \frac{R(-\tfrac{b}{2})}{R(0)}\ ,
\end{align}
where we used the equations \eqref{cmcp}, \eqref{cza} and \eqref{cco}.
The coefficients $c^{(s)}_+$ and $c^{(t)}_-$ are however related by eq. \eqref{csp}, with
\begin{align}
 \left\{\begin{array}{l}  \alpha_1 = \alpha \\ \alpha_2 = Q-\alpha \\ \alpha_3 = -\frac{b}{2} \end{array}\right. \quad \Rightarrow \quad \left\{\begin{array}{l}  A = 1-bQ \\ B = 1+b(2\alpha-2Q) \\ C=1+b(2\alpha-Q) \end{array}\right.  \ ,
\end{align}
so that $C-1=B-A$.
We thus obtain
\begin{align}
 \frac{R(\alpha-\tfrac{b}{2})R(0)}{R(\alpha)R(-\tfrac{b}{2})} = 
\frac{\gamma(2bQ)}{\gamma(bQ)} \frac{\gamma(b(Q-2\alpha))}{\gamma(b(2Q-2\alpha))}\ .
\label{crg}
\end{align}
Similarly, studying a four-point function with the degenerate field $V_{\langle 1,2 \rangle}$ instead of $V_{\langle 2,1 \rangle}$ would lead to the dual equation
\begin{align}
  \frac{R(\alpha-\tfrac{1}{2b})R(0)}{R(\alpha)R(-\tfrac{1}{2b})} = \frac{\gamma(\frac{2Q}{b})}{\gamma(\frac{Q}{b})} \frac{\gamma(\frac{1}{b}(Q-2\alpha))}{\gamma(\frac{1}{b}(2Q-2\alpha))}\ .
\end{align}
The general solution of these equations, together with \eqref{rrr}, is
\begin{align}
 \boxed{R(\alpha) = R(\tfrac{Q}{2})\mu^{Q-2\alpha} \frac{\Gamma(b(2\alpha-Q))\Gamma(\frac{1}{b}(2\alpha-Q))}{\Gamma(b(Q-2\alpha))\Gamma(\frac{1}{b}(Q-2\alpha))}} \quad \text{with} \quad R(\tfrac{Q}{2})\in \{1, -1\}  \ ,
\label{ram}
\end{align}
where $\mu$ is an arbitrary parameter called the \textbf{\boldmath cosmological constant}\index{cosmological constant},
and the sign $R(\frac{Q}{2})$ will be determined in eq. \eqref{ccr}.
Using eq. \eqref{cmcp}, this determines in particular $C_-(\alpha)$, so that we have
\begin{align}
 C_+(\alpha)=1 \quad , \quad C_-(\alpha) = \mu^b b^4 \frac{\gamma(b(2\alpha-Q))}{\gamma(2b\alpha)}\ .
\label{cpm}
\end{align}

Consider now a four-point function $\left\langle V_{\langle 2,1 \rangle}(x)V_{\Delta_1}(0)V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right\rangle$ involving only one degenerate field $V_{\langle 2,1 \rangle}$.
The coefficients $c^{(s)}_\pm$ of the decomposition \eqref{zsc} into hypergeometric functions are now 
\begin{align}
 c_+^{(s)} & = C_+(\alpha_1) C_{\alpha_1-\frac{b}{2},\alpha_2,\alpha_3} \ ,
\\
c_-^{(s)} & = C_-(\alpha_1) C_{\alpha_1+\frac{b}{2},\alpha_2,\alpha_3}\ .
\end{align}
The ratio $\frac{c_+^{(s)}}{c_-^{(s)}}$ is determined by eq. \eqref{spsm}, which implies
\begin{align}
 \frac{C_{\alpha_1+b,\alpha_2,\alpha_3}}{C_{\alpha_1,\alpha_2,\alpha_3}} = \mu^{-b} b^{-4}\frac{\gamma(2b\alpha_1)\gamma(2b\alpha_1+b^2)}{\prod_{\pm,\pm} \gamma\left(b\alpha_1\pm b(\alpha_2-\frac{Q}{2})\pm b(\alpha_3-\frac{Q}{2})\right)}\ .
\label{fcc}
\end{align}
Considering a four-point function involving the degenerate field $V_{\langle 1,2 \rangle}$ instead of $V_{\langle 2,1 \rangle}$, we can derive a dual equation, which is obtained from the above equation by the replacement $b\to \frac{1}{b}$. 
The two equations prescribe how the three-point structure constant $C_{\alpha_1,\alpha_2,\alpha_3}$ behaves under shifts of $\alpha_1$ by $b$ and $\frac{1}{b}$.
Next, we will discuss their solutions.


\subsection{The three-point function \label{sectpf}}

Equation \eqref{fcc} and its dual equation determine how three-point structure constants behave when momentums are shifted by $b$ and $\frac{1}{b}$. 
Under our assumption that structure constants are smooth as functions of momentums and of $b$, this uniquely determines the structure constants (up to a momentum-independent factor) if $b^2\in \mathbb{R}$.
So we will distinguish three cases:
\begin{equation}
 \begin{tikzpicture}[baseline=(current  bounding  box.center), scale = .6]
\draw (0, 2) node[left]{$i$} -- (0, 1) node[below left] {$0$} -- (1, 1) node[below] {$1$};
\draw [thick, latex-latex] (4,3) -- (4,1) node[fill, circle, minimum size = 1mm, inner sep = 0]{} -- (4,-.3);
\draw [thick, latex-latex] (8,3) -- (7,1) node[fill, circle, minimum size = 1mm, inner sep = 0]{}-- (7.6,-.2);
\draw [thick, latex-latex] (12,1) -- (10,1) node[fill, circle, minimum size = 1mm, inner sep = 0]{} -- (11.3,1) ;
\node at (4, -1.5){$\begin{array}{c} b\in i\mathbb{R} \\ c\leq 1 \end{array}$};
\node at (7.5, -1.5){$\begin{array}{c} b\in \mathbb{C} \\ c\in\mathbb{C} \end{array}$};
\node at (11, -1.5){$\begin{array}{c} b\in \mathbb{R} \\ c\geq 25 \end{array}$};
 \end{tikzpicture}
\end{equation}
In all cases, in order to solve eq. \eqref{fcc} together with the dual equation, we need a function $\Upsilon_b(x)$ such that 
\begin{align}
 \frac{\Upsilon_b(x+b)}{\Upsilon_b(x)} \sim \gamma(bx)\quad \text{and} \quad \frac{\Upsilon_b(x+\frac{1}{b})}{\Upsilon_b(x)} \sim \gamma(\tfrac{x}{b})\ ,
\end{align}
where the $\sim$ sign indicates that some simple factors may be missing.
Adding simple factors is actually necessary for ensuring the compatibility of these equations, so that the following two expressions for $ \frac{\Upsilon_b(x+b+\frac{1}{b})}{\Upsilon_b(x)}$ coincide:
\begin{align}
  \frac{\Upsilon_b(x+b+\frac{1}{b})}{\Upsilon_b(x+b)} \frac{\Upsilon_b(x+b)}{\Upsilon_b(x)} = \frac{\Upsilon_b(x+\frac{1}{b}+b)}{\Upsilon_b(x+\frac{1}{b})} \frac{\Upsilon_b(x+\frac{1}{b})}{\Upsilon_b(x)} \ .
\end{align}
The missing simple factors can be determined with the help of the identity
\begin{align}
 \gamma(x+1) = -x^2 \gamma(x) \ .
\end{align}
If $b>0$, the compatible equations that result from inserting the missing factors are 
\begin{align}
  \boxed{\frac{\Upsilon_b(x+b)}{\Upsilon_b(x)} = b^{1-2bx} \gamma(bx)}\quad \text{and} \quad \boxed{\frac{\Upsilon_b(x+\frac{1}{b})}{\Upsilon_b(x)} = b^{\frac{2x}{b}-1} \gamma(\tfrac{x}{b})}\ ,
\label{upup}
\end{align}
These equations define a unique (up to a constant factor) function $\Upsilon_b(x)$, which will turn out to be defined for any $b$ such that $\Re b > 0$ by analytic continuation. 
On the other hand, if $ib>0$, the compatible equations are 
\begin{align}
 \frac{\hat{\Upsilon}_b(x+b)}{\hat{\Upsilon}_b(x)} = (ib)^{1-2bx} \gamma(bx)\quad \text{and} \quad \frac{\hat{\Upsilon}_b(x+\frac{1}{b})}{\hat{\Upsilon}_b(x)} = (ib)^{\frac{2x}{b}-1} \gamma(\tfrac{x}{b})\ .
\end{align}
The solution $\hat\Upsilon_b(x)$ of these equations can actually be constructed from the function $\Upsilon_b(x)$,
\begin{align}
 \boxed{ \hat{\Upsilon}_b(x) = \frac{1}{\Upsilon_{ib}(-ix+ib)} }\ ,
\label{tub}
\end{align}
which exists for $\Im b < 0$. 
For any $c\notin ]-\infty, 1] \cup [25,\infty[$, there is a choice of $b$ such that $\Re b>0$ and $\Im b<0$. 
Both functions $\Upsilon_b(x)$ and $\hat\Upsilon_b(x)$ exist and obey shift equations that are essentially the same, so their ratio is essentially an elliptic function \cite{zam05}. 

Let us discuss the properties of $\Upsilon_b(x)$. 
We first notice that the function $\Upsilon_b(Q-x)$ obeys the same equations as $\Upsilon_b(x)$, which suggests 
\begin{align}
 \boxed{\Upsilon_b(x) = \Upsilon_b(Q-x)}\ .
\label{upq}
\end{align}
Second, the shift equations \eqref{upup} constrain the poles and zeros of  $\Upsilon_b(x)$, knowing that $\gamma(x)$ has simple poles for $x\in -{\mathbb{N}}$ and zeros for $x\in 1+{\mathbb{N}}$.
Both $\frac{\Upsilon_b(x+b)}{\Upsilon_b(x)}$ and $\frac{\Upsilon_b(x+\frac{1}{b})}{\Upsilon_b(x)}$ have a pole at $x=0$, which suggests that $\Upsilon_b(x)$ has a simple zero at $x=0$.
Then the shift equations imply that 
\begin{align}
 \boxed{\Upsilon_b(x)\ \ \text{has simple zeros for}\ \ x\in  \left(-b{\mathbb{N}} -\tfrac{1}{b}{\mathbb{N}} \right) \cup \left( Q+b{\mathbb{N}} + \tfrac{1}{b}{\mathbb{N}}\right)} \ .
\label{xbn}
\end{align}
These zeros lie in two infinite cones with tips at $x=0$ and $x=Q$, which we represent as follows:
\begin{align}
\begin{tikzpicture}[scale = 1.3, baseline=(current  bounding  box.center)]
\node[above] at (0, 0) {$0$};
\node[below] at (1, .1) {$Q$};
\draw [latex-latex] (.6, .3) node[above] {$b$} -- (0, 0) -- (.4, -.2) node[below] {$b^{-1}$};
\begin{scope}[rotate = 90]
\filldraw[blue, opacity = .1] (0,0) -- (-1.3, 2.5) -- (1.3, 2.5) -- cycle;
\clip (-1.4, -.2) -- (1.4, -.2) -- (1.4, 2.5) -- (-1.4, 2.5) -- cycle;
\foreach \x in {0, 1,...,4}{
  \foreach \y in {0, 1,...,6}{
    \node[draw,circle,inner sep=1pt,fill,blue] at (-.3*\x +.2*\y, .6*\x +.4*\y) {};
  }}
  \end{scope}
\begin{scope}[shift = {(1, .1)}, rotate = -90]
\filldraw[blue, opacity = .1] (0,0) -- (-1.3, 2.5) -- (1.3, 2.5) -- cycle;
\clip (-1.4, -.2) -- (1.4, -.2) -- (1.4, 2.5) -- (-1.4, 2.5) -- cycle;
\foreach \x in {0, 1,...,4}{
  \foreach \y in {0, 1,...,6}{
    \node[draw,circle,inner sep=1pt,fill,blue] at (-.3*\x +.2*\y, .6*\x +.4*\y) {};
  }}  
\end{scope}  
 \end{tikzpicture}
\label{lines}
\end{align}
It turns out that these zeros account for all the poles and zeros of $\frac{\Upsilon_b(x+b)}{\Upsilon_b(x)}$ and $\frac{\Upsilon_b(x+\frac{1}{b})}{\Upsilon_b(x)}$ in the equations \eqref{upup}, so that $\Upsilon_b(x)$ has no poles and is analytic on ${\mathbb{C}}$. 

There is an explicit expression for the function $\Upsilon_b(x)$ in the strip $0<\Re x<\Re Q$, 
\begin{align}
 \log\Upsilon_b(x) = \int_0^\infty \frac{dt}{t} \left[\left(\tfrac{Q}{2}-x\right)^2 e^{-2t} -\frac{\sinh^2\left(\left(\frac{Q}{2}-x\right)\!t\right)}{\sinh (bt)\sinh\left(\frac{t}{b}\right)}\right]\ .
\label{lup}
\end{align}
If $x$ is outside the strip, the value of $\Upsilon_b(x)$ can be found by combining the above integral expression with the shift equations \eqref{upup}.
An alternative formula for $\Upsilon_b(x)$, which makes the zeros manifest, is 
\begin{align}
 \Upsilon_b(x) = \lambda_b^{(\frac{Q}{2}-x)^2}\prod_{m,n=0}^\infty f\left(\frac{\frac{Q}{2}-x}{\frac{Q}{2}+mb+nb^{-1}}\right) \quad \text{with} \quad f(x)=(1-x^2)e^{x^2}\ ,
\end{align}
where $\lambda_b$ is an unimportant $b$-dependent constant.
This product formula is valid for all values of $x$, but it does not converge very fast.

Using the functions $\Upsilon_b(x)$ and $\hat\Upsilon_b(x)$, we can write solutions $C$ and $\hat C$ of the shift equations \eqref{fcc} for three-point structure constants, that are respectively defined for $c\notin ]-\infty, 1]$ and $c\notin [25,\infty[$,
\begin{align}
 \boxed{C_{\alpha_1,\alpha_2,\alpha_3} =  \frac{\left[b^{\frac{2}{b}-2b}\mu\right]^{Q-\alpha_1-\alpha_2-\alpha_3}\Upsilon_b'(0) \Upsilon_b(2\alpha_1) \Upsilon_b(2\alpha_2) \Upsilon_b(2\alpha_3)}{\Upsilon_b(\alpha_1+\alpha_2+\alpha_3-Q) \Upsilon_b(\alpha_1+\alpha_2-\alpha_3)\Upsilon_b(\alpha_2+\alpha_3-\alpha_1)\Upsilon_b(\alpha_3+\alpha_1-\alpha_2)}} \ ,
\label{caaa}
\end{align}
\begin{align}
\boxed{\hat{C}_{\alpha_1,\alpha_2,\alpha_3} =  \frac{\left[(ib)^{\frac{2}{b}-2b}\mu\right]^{Q-\alpha_1-\alpha_2-\alpha_3}\hat{\Upsilon}_b(0) \hat{\Upsilon}_b(2\alpha_1) \hat{\Upsilon}_b(2\alpha_2) \hat{\Upsilon}_b(2\alpha_3)}{\hat{\Upsilon}_b(\alpha_1+\alpha_2+\alpha_3-Q) \hat{\Upsilon}_b(\alpha_1+\alpha_2-\alpha_3)\hat{\Upsilon}_b(\alpha_2+\alpha_3-\alpha_1)\hat{\Upsilon}_b(\alpha_3+\alpha_1-\alpha_2)}} \ .
\label{hc}
\end{align}
The expression for $C$ is called the \textbf{\boldmath DOZZ formula}\index{DOZZ formula} for Dorn, Otto, A.
Zamolodchikov and Al.
Zamolodchikov. 
Both $C$ and $\hat C$
\begin{itemize}
 \item are symmetric under permutations of $\{\alpha_1,\alpha_2,\alpha_3\}$, 
\item are invariant under $b\to \frac{1}{b}$, as follows from the invariance of $\Upsilon_b(x)$,
\item obey the the reflection relation \eqref{crc} with the coefficient $R(\alpha)$ \eqref{ram}, as follows from the identities \eqref{upq} and 
\begin{align}
 R(\alpha)
=
\left\{\begin{array}{ll}
\left[b^{\frac{2}{b}-2b}\mu\right]^{Q-2\alpha}\frac{\Upsilon_b(2\alpha)}{\Upsilon_b(2\alpha-Q)}
& \quad \text{with} \quad R(\tfrac{Q}{2}) = -1 \ ,
\\
\left[(ib)^{\frac{2}{b}-2b}\mu\right]^{Q-2\alpha}\frac{\hat{\Upsilon}_b(2\alpha)}{\hat{\Upsilon}_b(2\alpha-Q)}
& \quad \text{with} \quad R(\tfrac{Q}{2}) = 1 \ .
\end{array}\right.
\end{align}
\end{itemize}
Notice that $R(\frac{Q}{2})=-1$ implies $V_\frac{Q}{2}=0$, which is consistent with $C_{\frac{Q}{2},\alpha_2,\alpha_3}=0$.

\subsection{Existence and uniqueness of Liouville theory}\label{seceul}

We derived the three-point structure constants $C$ and $\hat C$ by solving the equation \eqref{fcc} and its dual equation under $b\to \frac{1}{b}$, which are consequences of crossing symmetry of four-point functions involving degenerate fields. 
For Liouville theory to exist, we need generic four-point functions to be crossing symmetric. 
This issue has been explored numerically \cite{rs15}. 
It turns out that for each value of the central charge $c\in\mathbb{C}$, either $C$ or $\hat C$ leads to crossing symmetric four-point functions, and is therefore the three-point structure constant of Liouville theory:
\begin{align}
\renewcommand{\arraystretch}{1.3}
 \begin{tabular}{|l||c|c|}
  \hline
  central charge &  $c\in ]-\infty, 1]$ & $c\notin ]-\infty, 1]$
  \\
  \hline
  structure constant & $\hat C$  & $C$ 
  \\
  \hline 
  $R(\tfrac{Q}{2})$ & $1$ & $-1$
  \\
  \hline
 \end{tabular}
 \label{ccr}
\end{align}
In addition, there is a proposed proof \cite{tes03b} of crossing symmetry for $c\notin ]-\infty, 1]$.
Let us also mention that Liouville theory is consistent on the torus \cite{hjs09, rs15}, although its partition function is infinite. 

So $C$ is a valid structure constant wherever it is defined, whereas $\hat C$ is valid only for $c\in ]-\infty, 1]$ although it is defined for $c\notin [25,\infty[$.
To understand this, let us study the analytic properties of the corresponding four-point functions,
\begin{align}
 \left< \prod_{i=1}^4 V_{\alpha_i}\right> = 
 \left\{\begin{array}{ll} 
         \frac12 \int_{\frac{Q}{2}+i\mathbb{R}} d\alpha_s\ C_{\alpha_1,\alpha_2,Q-\alpha_s} C_{\alpha_s,\alpha_3, \alpha_4} \left|\mathcal{F}_{\alpha_s}^{(s)} \right|^2 \quad & \text{if } c\notin ]-\infty, 1]\ ,
         \\
         \frac12 \int_{i\mathbb{R}+\epsilon} d\alpha_s\ \hat C_{\alpha_1,\alpha_2,Q-\alpha_s} \hat C_{\alpha_s,\alpha_3, \alpha_4} \left|\mathcal{F}_{\alpha_s}^{(s)} \right|^2 \quad & \text{if } c\in ]-\infty, 1]\ .
        \end{array}
 \right.
\end{align}
Although the structure constants $C$ and $\hat C$ have rather different analytic properties, what matters is the behaviour of the poles of the $s$-channel conformal blocks $\mathcal{F}_{\alpha_s}^{(s)}$. 
These poles correspond to degenerate values of the momentum $\alpha_s$, and are therefore found in two cones with tips at $\alpha_s= 0$ and $\alpha_s = Q$. 
Consider the relative positions of these cones, and of the integration line for $\alpha_s$, depending on the value of the central charge $c$:
\begin{align}
 \newcommand{\polewedge}[3]{
\begin{scope}[#1]
\node[blue, draw,circle,inner sep=1pt,fill] at (0, 0) {};
\node[#3] at (0,0) {#2};
\filldraw[opacity = .1, blue] (0,0) -- (4, -4) -- (4, 4) -- cycle;
\end{scope}
}
\begin{array}{ccc}
\begin{tikzpicture}[scale = .4, baseline=(current  bounding  box.center)]
  \draw[-latex] (-3,0) -- (0, 0) node[above left] {$0$} -- (4,0) node [above] {$\alpha_s$};
  \draw[ultra thick, blue, opacity = .3] (0, -4.5) -- (0, 4.5);
  \draw (0, -4.5) -- (0, 4.5);
  \draw[ultra thick, red] (.5, -4.5) -- (.5, 4.5);
  \node[blue, draw,circle,inner sep=1pt,fill] at (0, 0) {};
\node[above left] at (0,0) {$0$};
\node[blue, draw,circle,inner sep=1pt,fill] at (0, 1.5) {};
\node[above left] at (0,1.5) {$Q$};
 \end{tikzpicture}
 & 
 \begin{tikzpicture}[scale = .4, baseline=(current  bounding  box.center)]
  \draw[-latex] (-4,0) -- (0, 0) node[above left] {$0$} -- (6,0) node [above] {$\alpha_s$};
  \draw (0, -4.5) -- (0, 4.5);
  \draw[ultra thick, red] (1, -4.5) -- (1, 4.5);
  \polewedge{rotate = 180}{$0$}{above left};
  \polewedge{shift = {(2, .3)}}{$Q$}{above right};
 \end{tikzpicture}
 &
 \begin{tikzpicture}[scale = .4, baseline=(current  bounding  box.center)]
 \draw[ultra thick, blue, opacity = .3] (0,0) -- (-4,0);
 \draw[ultra thick, blue, opacity = .3] (2,0) -- (6,0);
  \draw[-latex] (-4,0) -- (0, 0) node[above left] {$0$} -- (6,0) node [above] {$\alpha_s$};
  \draw (0, -4.5) -- (0, 4.5);
  \draw[ultra thick, red] (1, -4.5) -- (1, 4.5);
  \node[blue, draw,circle,inner sep=1pt,fill] at (0, 0) {};
\node[above left] at (0,0) {$0$};
\node[blue, draw,circle,inner sep=1pt,fill] at (2, 0) {};
\node[above right] at (2,0) {$Q$};
 \end{tikzpicture}
 \vspace{3mm}
 \\
 c\in ]-\infty, 1] & c\notin ]-\infty, 1] \cup [25,\infty[ & c\in [25,\infty[
\end{array}
\end{align}
For any $c\notin ]-\infty, 1]$, the poles of the conformal blocks stay safely away from the integration line, and actually the poles of the structures constants behave similarly. 
So the four-point function is analytic as a function of $c$ in that domain. 
In particular, crossing symmetry for $c\in [25,\infty[$ implies crossing symmetry for $c\notin ]-\infty, 1]$ by analyticity of both $s$- and $t$-channel expressions for the four-point function. 
In contrast, when
$c$ approaches the half-line $]-\infty, 1]$, a whole cone of poles crosses the integration line before collapsing into the imaginary axis. 
So we cannot continue the four-point function from $c\in ]-\infty, 1]$ to a larger region (or vice-versa).

Let us now discuss the uniqueness of Liouville theory, as defined by our assumptions in Section \ref{secspe}. 
We saw that three-point structures constants are uniquely determined by shift equations if $c\in ]-\infty, 1] \cup [25,\infty[$, so that Liouville theory is unique for these values of $c$. 
For the other values of $c$, we have $b^2\notin\mathbb{R}$, and we can find alternative solutions of the equations \eqref{upup} for $\Upsilon_b(x)$, by multiplying $\Upsilon_b(x)$ with elliptic functions -- meromorphic functions $\theta(x)$ such that $\theta(x+b)=\theta(x+\frac{1}{b}) = \theta(x)$.
This leads to alternative solutions of the shift equations for structure constants.
But the resulting alternative structure constants have no reason to lead to crossing symmetric four-point functions, and it seems likely that Liouville theory is unique for any $c\in\mathbb{C}$, although this would be difficult to prove. 
It would also be interesting to investigate whether Liouville theory could be generalized by relaxing some of our defining assumptions. 
For example, it turns out that nothing new can be obtained by relaxing our assumption that the multiplicities of representations in the spectrum do not exceed one, and allowing finite multiplicities. (See Exercise \ref{exomul}.)

Finally, let us study the behaviour of the Liouville OPE $V_{\alpha_1}V_{\alpha_2}$ \eqref{vvi} when $\alpha_2 \to \alpha_{\langle r,s \rangle}$, where the degenerate field momentum $\alpha_{\langle r,s \rangle}$ is given in eq. \eqref{ars}.
This behaviour depends on the value of the central charge $c$, because the structure constants $C$ and $\hat C$ have very different analytical properties. 
If $c\in ]-\infty, 1]$, we use the structure constant $\hat C_{\alpha_1,\alpha_2,\alpha_3}$, which has a finite limit when $\alpha_2 \to \alpha_{\langle r,s \rangle}$.
So the OPE remaining an integral over the Liouville spectrum, and nothing particular happens. 
If on the other hand $c\notin ]-\infty, 1]$, we use the structure constant $C_{\alpha_1,\alpha_2,\alpha_3}$, which apparently vanishes due to the identity 
\begin{align}
 \Upsilon_b(2\alpha_{\langle r,s \rangle})=0\ .
\label{ubt}
\end{align}
However, it turns out that the OPE $V_{\alpha_1}V_{\alpha_2}$ does not vanish, in other words $C_{\alpha_1,\alpha_2,\alpha_3}$ does not vanish when considered as a distribution.
To see this, let us plot the poles of the OPE coefficient $C_{\alpha_1,\alpha_2}^\alpha = C_{\alpha_1,\alpha_2,Q-\alpha}$, viewed as a function of $\alpha$.
These poles lie on cones, which we draw in the fashion of eq. \eqref{lines}, together with the line  of integration $\alpha\in \frac{Q}{2}+i{\mathbb{R}}$:
\begin{align}
 \newcommand{\polewedge}[3]{
\begin{scope}[#1]
\node[blue, draw,circle,inner sep=1pt,fill] at (0, 0) {};
\node[#3] at (0,0) {#2};
\filldraw[opacity = .1, blue] (0,0) -- (5, -2.5) -- (5, 2.5) -- cycle;
\end{scope}
}
 \begin{tikzpicture}[baseline=(current  bounding  box.center)]
  \draw[-latex] (-5,0) -- (0, 0) node[above left] {$0$} -- (6,0) node [above] {$\alpha$};
  \clip (-5, -3.5) -- (-5, 3.5) -- (6, 3.5) -- (6, -3.5) -- cycle;
  \draw (0, -4.5) -- (0, 4.5);
  \draw[ultra thick, red] (.5, -4.5) -- (.5, 4.5);
  \polewedge{shift = {(0, .7)}, rotate = 180}{$\alpha_1-\alpha_2$}{above left};
  \polewedge{shift = {(0, -.7)}, rotate = 180}{$\alpha_2-\alpha_1$}{above left};
  \polewedge{shift = {(0, 1.8)}, rotate = 180}{$\alpha_1+\alpha_2-Q$}{above left};
  \polewedge{shift = {(0, -1.8)}, rotate = 180}{$Q-\alpha_1-\alpha_2$}{above left};
  \polewedge{shift = {(1, .8)}}{$Q+\alpha_1-\alpha_2$}{above right};
  \polewedge{shift = {(1, -.6)}}{$Q+\alpha_2-\alpha_1$}{above right};
  \polewedge{shift = {(1, 1.9)}}{$\alpha_1+\alpha_2$}{above right};
  \polewedge{shift = {(1, -1.7)}}{$2Q-\alpha_1-\alpha_2$}{above right};
 \end{tikzpicture}
\end{align}
In this picture, we have assumed $\alpha_1,\alpha_2\in \frac{Q}{2}+i{\mathbb{R}}$, so that the corresponding representations belong to the spectrum.
If we analytically continue the OPE to a value $\alpha_2=\alpha_{\langle r,s \rangle}$, then poles from different sides of the line of integration must coincide, so some poles have to cross the line. 
Let us deform the integration line to the right, so that poles cross it from right to left only.
We now draw the deformed line, and the poles that have crossed it:
\begin{align}
 % \alpha_2 = \alpha_{\langle 3, 4\rangle}
\newcommand{\polewedge}[4]{
\begin{scope}[#1]
\node[blue, draw,circle,inner sep=1pt,fill] at (0, 0) {};
\node[#3] at (0,0) {#2};
\filldraw[opacity = .1, blue] (0,0) -- (8, -4) -- (8, 4) -- cycle;
\end{scope}
}
 \begin{tikzpicture}[baseline=(current  bounding  box.center)]
  \draw[-latex] (-5,0) -- (0, 0) node[above left] {$0$} -- (6,0) node [above] {$\alpha$};
  \draw (0, -4) -- (0, 4);
 \clip (-5, -4) -- (-5, 4) -- (6, 4) -- (6, -4) -- cycle;
  \polewedge{shift = {(1.7, 2)}, rotate = 180}{$\alpha_1-\alpha_2$}{below right};
  \polewedge{shift = {(-1.7, -2)}, rotate = 180}{$\alpha_2-\alpha_1$}{below left};
  \polewedge{shift = {(-1.7, 1.9)}, rotate = 180}{$\alpha_1+\alpha_2-Q$}{below left};
  \polewedge{shift = {(1.7, -1.9)}, rotate = 180}{$Q-\alpha_1-\alpha_2$}{below right};
  \polewedge{shift = {(2.7, 2.1)}}{$Q+\alpha_1-\alpha_2$}{above right};
  \polewedge{shift = {(-.7, -1.9)}}{$Q+\alpha_2-\alpha_1$}{above left};
  \polewedge{shift = {(-.7, 2)}}{$\alpha_1+\alpha_2$}{above left};
  \polewedge{shift = {(2.7, -1.8)}}{$2Q-\alpha_1-\alpha_2$}{above right};
  \foreach \x in {0, ..., 2}{
  \foreach \y in {0, ..., 3}{
  \node[red, draw, circle,inner sep = 1.5pt, fill] at (-.7 + .6*\x + .4*\y, 2 + .3*\x -.2*\y) {};
  \node[red, draw, circle,inner sep = 1.5pt, fill] at (-.7 + .6*\x + .4*\y, -1.9 + .3*\x -.2*\y) {};
  }}
  \draw[ultra thick, red, rounded corners = 6] (.5, -4.5) -- (.5, -2.7) -- (2.1, -1.9) -- (.5, -1.1) -- (.5, 1.2) -- (2.1, 2) -- (.5, 2.8) -- (.5, 4.5);
 \end{tikzpicture}
\end{align}
The integral along the deformed line goes to zero as $\alpha_2\to \alpha_{\langle r,s \rangle}$, while the residues of the poles have finite limits.
We obtain an OPE of the type of eq. \eqref{vrsv}, with 
\begin{align}
 \boxed{C_{i,j}^{\langle r,s \rangle}(\alpha_1) = \underset{\alpha_2\to \alpha_{\langle r,s \rangle}}{\lim}\ \underset{\alpha=\alpha_1+\alpha_2+ib+jb^{-1}}{\operatorname{ Res}}\ C_{\alpha_1,\alpha_2,Q-\alpha}}\ .
\label{crs}
\end{align}
To summarize, 
\begin{align}
 \boxed{
 \underset{\alpha\to \alpha_{\langle r,s \rangle}}{\lim } V_\alpha = 
 \left\{ \begin{array}{ll}
          V_{\alpha_{\langle r,s \rangle}} \quad & \text{if\ } c\in ]-\infty, 1]\ ,
          \\
          V_{\langle r,s \rangle} & \text{otherwise}\ .
         \end{array}\right. 
         }
\label{vla}
\end{align}
So, for $c\notin ]-\infty, 1]$, we obtain degenerate fields as limits of non-degenerate fields. 
The reason for this behaviour is not clear.
Nevertheless, this behaviour can be used for deriving the fusion rules \eqref{rtv} from the Liouville OPE. 
It is tempting to use a similar calculation for deriving the fusion rules of the unitary Verma modules which do not belong to the spectrum. 
(See Exercise \ref{exoaur}.)

Let us finish the computation of the degenerate OPE coefficient $C_{i,j}^{\langle r,s \rangle}(\alpha)$.
Using eq. \eqref{caaa}, we obtain 
\begin{multline}
 C_{i,j}^{\langle r,s \rangle}(\alpha) = \left[b^{\frac{2}{b}-2b}\mu\right]^{ib+jb^{-1}} \frac{\Upsilon_b'(0)}{\Upsilon_b'(-ib-jb^{-1})} \frac{\Upsilon_b'(2\alpha_{\langle r,s \rangle})}{\Upsilon_b'(2\alpha_{\langle r,s \rangle}+ib+jb^{-1})}
\\ \times
 \frac{\Upsilon_b(2\alpha)}{\Upsilon_b(2\alpha+ib+jb^{-1})} \frac{\Upsilon_b(2\alpha+2\alpha_{\langle r,s \rangle}-Q+2ib+2jb^{-1})}{\Upsilon_b(2\alpha+2\alpha_{\langle r,s \rangle}-Q+ib+jb^{-1})} \ ,
\end{multline}
where taking limits and residues produces derivatives of $\Upsilon_b$ at its zeros.
We could expand the ratios of $\Upsilon_b$ functions into products of $\gamma$ functions using eq. \eqref{upup}.
In the special case $i=j=0$, we find
\begin{align}
 C_{0,0}^{\langle r,s \rangle}(\alpha) = 1 \ .
\end{align}
In the cases $\langle r,s \rangle \in \{\langle 1,1 \rangle , \langle 1,2 \rangle, \langle 2,1 \rangle\}$, 
this agrees with eqs. \eqref{cza} and \eqref{cco}.  



\section{Minimal models \label{secvmm}}

\subsection{Definition}

We define an \textbf{A-series minimal model}\index{A-series minimal model} as a conformal field theory such that
\begin{itemize}
 \item the theory is diagonal;
\item each representation of the algebra $\mathfrak{V}\times \overline{\mathfrak{V}}$ has multiplicity zero or one;
\item the theory is rational, i.e.
the spectrum is made of finitely many representations.
\end{itemize}
Let us briefly discuss these assumptions, and compare them with our definition of Liouville theory in Section \ref{secspe}.
Firstly, remember that the diagonality of Liouville theory was a consequence of other assumptions, which included the continuous nature of the spectrum.
In minimal models, diagonality is a simplifying assumption.
Relaxing this assumption, we would find not only the A-series minimal models, but also the so-called D- and E-series minimal models \cite{fms97}.
Secondly, the assumption that multiplicities do not exceed one is another simplifying assumption.
It is however not well-known what we would find if we would allow higher multiplicities. 

Rationality is the crucial axiom here -- and at first sight it seems difficult for rational theories to exist.
After all, we may view a rational theory as a theory with a continuous spectrum, where correlation functions vanish unless all involved fields belong to some particular finite subset of the spectrum.
But we have seen in Liouville theory how the associativity of the OPE and the single-valuedness of correlation functions, together with other milder assumptions, uniquely determined the theory.
It may seem impossible to require the vanishing of almost all correlation functions on top of that. 

This would however not be a problem, if this vanishing of almost all correlation functions was not a set of additional constraints, but instead a consequence of the fusion rules.
This can happen provided the spectrum only contains degenerate representations, whose fusion products \eqref{rrsr} involve finite sums instead of the generic integrals. 
However, in general, no nontrivial finite set of degenerate representations of the Virasoro algebra is closed under fusion.
Starting with the degenerate representation $R_{\langle 1,2 \rangle}$ for instance, the multiple fusion products $R_{\langle 1,2 \rangle}\times R_{\langle 1,2 \rangle}\times \cdots \times R_{\langle 1,2 \rangle}$ span the infinite set of representations $\{R_{\langle 1,s \rangle}\}_{s\in{\mathbb{N}}^*}$.
Our task would be easier if we would weaken our assumptions and replace the rationality of the theory with the discreteness of the spectrum, allowing the number of representations to be countable instead of finite.
We would obtain \textbf{\boldmath generalized minimal models}\index{generalized minimal model}, whose spectrums contain all degenerate representations, and which exist for arbitrary values of the central charge $c$. 

What if we insist on the original assumption of rationality? We will see that there are finite sets 
of degenerate representations which close under fusion.
Such sets are made of
\textbf{\boldmath doubly degenerate representations}\index{doubly degenerate representation}, that is maximally degenerate representations of the type $R_{\langle r,s \rangle}=R_{\langle r',s' \rangle}$ with $\langle r,s \rangle\neq \langle r',s' \rangle$.
The ensuing equality of conformal dimensions $\Delta_{\langle r,s \rangle}=\Delta_{\langle r',s' \rangle}$ leads to a constraint on the central charge $c$.
Therefore, minimal models exist only for certain discrete values of the central charge. 

\subsection{Generalized minimal models}

For any value of the central charge $c$, we define a generalized minimal model by its spectrum,
\begin{align}
 \boxed{S = \bigoplus_{r,s=1}^\infty R_{\langle r,s \rangle}\otimes \bar{R}_{\langle r,s \rangle}}\ .
\end{align}
We could obtain other consistent models by using subsets of the degenerate representations, provided these subsets were closed under fusion, for instance $S=R_{\langle 1,1 \rangle}\otimes \bar{R}_{\langle 1,1 \rangle}$, $S=\bigoplus_{r=1}^\infty R_{\langle r,1 \rangle}\otimes \bar{R}_{\langle r,1 \rangle}$ or $S=\bigoplus_{r,s=1}^{\infty} R_{\langle 2r+1,2s+1 \rangle}\otimes \bar{R}_{\langle 2r+1,2s+1 \rangle}$.
Solving the generalized minimal model will provide a solution of each of these submodels. 

Correlation functions of generalized minimal models can be deduced from the correlation functions of Liouville theory, which obey the same conformal bootstrap equations.
To begin with, the two-point function can be deduced from the Liouville two-point function \eqref{vvss} by changing a Dirac delta function into a Kronecker delta function, 
\begin{align}
 \boxed{\left\langle V_{\langle r_1,s_1 \rangle} V_{\langle r_2,s_2 \rangle} \right\rangle = R(\alpha_{\langle r_1,s_1 \rangle}) \delta_{r_1,r_2} \delta_{s_1,s_2}}\ .
\label{vvdd}
\end{align}
The three-point structure constant can similarly be obtained from both expressions $C$ \eqref{caaa} and $\hat C$ \eqref{hc} for the Liouville structure constant, since both obey the same shift equations. 
There is a subtlety with the expression $C$, which is singular when momentums take degenerate values. 
But we already found the correct regularization when we expressed degenerate OPE coefficients $C_{i,j}^{\langle r,s \rangle}(\alpha_1)$ in terms of $C$ \eqref{crs}, after sending one momentum to a degenerate value. 
The degenerate OPE coefficient then has a finite limit when $\alpha_1\to \alpha_{\langle r_1,s_1 \rangle}$, and we have
\begin{align}
 C_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle} 
 &= \hat{C}_{\alpha_{\langle r_1,s_1 \rangle}, \alpha_{\langle r_2,s_2 \rangle} ,\alpha_{\langle r_3,s_3 \rangle} } \ ,
 \nonumber
 \\
& = \underset{\alpha_1\to \alpha_{\langle r_1,s_1 \rangle}}{\lim}\ 
\underset{\alpha_2\to \alpha_{\langle r_2,s_2 \rangle}}{\lim}\ 
\underset{\sum_i \alpha_i = \sum_i \alpha_{\langle r_i,s_i \rangle} }{\operatorname{ Res}} C_{\alpha_1,\alpha_2,\alpha_3}\ .
\label{chclc}
\end{align}
Explicitly,
\begin{multline}
C_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle} =  
\\
\frac{\left[b^{\frac{2}{b}-2b}\mu\right]^{Q-\alpha_1-\alpha_2-\alpha_3}\Upsilon_b'(0) \Upsilon_b'(2\alpha_1) \Upsilon_b'(2\alpha_2) \Upsilon_b'(2\alpha_3)}{\Upsilon_b'(\alpha_1+\alpha_2+\alpha_3-Q) \Upsilon_b'(\alpha_1+\alpha_2-\alpha_3)\Upsilon_b'(\alpha_2+\alpha_3-\alpha_1)\Upsilon_b'(\alpha_3+\alpha_1-\alpha_2)}\ ,
\label{crisi}
\end{multline}
where we use the notation $\alpha_i = \alpha_{\langle r_i,s_i \rangle}$ for short.
This is the Liouville structure constant $C_{\alpha_1,\alpha_2,\alpha_3}$, where all $\Upsilon_b$ factors are replaced with their derivatives at some of their zeros.
These $\Upsilon_b$ factors indeed have zeros whenever
the fields are degenerate and the degenerate fusion rules \eqref{rrrsss} are obeyed, due to $\Upsilon_b(-b{\mathbb{N}}-\frac{1}{b}{\mathbb{N}})=0$ (from eq. \eqref{xbn}) which implies 
\begin{align}
 \forall i\neq j\neq k\ , \quad \Upsilon_b(\alpha_i+\alpha_j-\alpha_k) = 0\ .
\end{align}
Notice that $C_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle}$ can be nonzero in some cases when the degenerate fusion rules are violated, due to the vanishing of $\Upsilon_b(x)$ for $x\in Q+b{\mathbb{N}}+\frac{1}{b}{\mathbb{N}}$: for instance, in the case of $C_{\langle 1,1\rangle , \langle 1,1 \rangle,\langle 3,3 \rangle}$, which corresponds to $(\alpha_1,\alpha_2,\alpha_3)=(0,0,-Q)$.
The three-point function is therefore 
\begin{multline}
 \left\langle \prod_{i=1}^3 V_{\langle r_i,s_i \rangle}(z_i,\bar{z}_i) \right\rangle = C_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle}  
\\ \times 
f_{r_1,r_2,r_3} f_{s_1,s_2,s_3}\ |z_{12}|^{2(\Delta_3-\Delta_1-\Delta_2)} |z_{23}|^{2(\Delta_1-\Delta_2-\Delta_3)} |z_{31}|^{2(\Delta_2-\Delta_3-\Delta_1)}\ ,
\end{multline}
where 
the model-dependent data are $C_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle}$, and the universal data are the $z_i$-dependent factor as well as the factor $f_{r_1,r_2,r_3} f_{s_1,s_2,s_3}$ \eqref{frrr}, which enforces the degenerate fusion rules. 
Due to this factor, the three-point function is not quite the limit of the Liouville three-point function. 
This makes it difficult to deduce crossing symmetry in generalized minimal models from crossing symmetry in Liouville theory. 
Instead, crossing symmetry in generalized minimal models can be checked numerically \cite{rs15}, and this shows that generalized minimal models are consistent on the sphere. 
On the other hand, nothing guarantees that generalized minimal models are consistent on the torus. Actually, correlation functions involving only the identity field reduce to the partition function, and are therefore infinite. And there is no reason for the other correlation functions to be better behaved.  

The three-point structure constant can be rewritten in terms of Gamma functions, using the following consequence of eq. \eqref{upup},
\begin{align}
 \frac{\Upsilon_b'(-rb-sb^{-1})}{\Upsilon_b'(0)} = (-1)^{rs} b^{s-r} b^{s(s+1)b^{-2}-r(r+1)b^2} P_r(b^2)P_s(b^{-2}) Q_{r,s}(b)\ ,
\end{align}
where we defined
\begin{align}
 P_r(x) = \prod_{i=1}^r \gamma(1+ix) \quad \text{and} \quad Q_{r,s}(b) = \prod_{i=1}^r \prod_{j=1}^s (ib+jb^{-1})^2\ .
\end{align}
The three-point structure constant \eqref{crisi} of a generalized minimal model is then
\begin{align}
 C_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle} =  \frac{-(-b^2)^{r_0-s_0}\mu^{br_0 + b^{-1}s_0}}{P_{r_0}(b^2)P_{s_0}(b^{-2})Q_{r_0,s_0}(b)} \prod_{i=1}^3 \frac{P_{r_i-1}(b^2)P_{s_i-1}(b^{-2}) Q_{r_i-1,s_i-1}(b)}{P_{r_0-r_i}(b^2)P_{s_0-s_i}(b^{-2}) Q_{r_0-r_i,s_0-s_i}(b)} \ ,
\label{cpqb}
\end{align}
where we introduce the notations 
\begin{align}
 r_0 = \frac{r_1+r_2+r_3-1}{2} \quad , \quad s_0=\frac{s_1+s_2+s_3-1}{2}\ .
\end{align}
This shows that the three-point function of a generalized minimal model is meromorphic as a function of $b\in {\mathbb{C}}^*$.
This contrasts with the three-point function of Liouville theory, which is singular if $b^2 < 0$ i.e. $c\in ]-\infty, 1]$. 


\subsection{A-series minimal models \label{secamm}}

Let us assume that the spectrum of a conformal field theory contains a doubly degenerate representation 
\begin{align}
 R=R_{\langle r,s \rangle}=R_{\langle r',s' \rangle}\ .
\end{align}
The equality of conformal dimension $\Delta_{\langle r,s \rangle}=\Delta_{\langle r',s' \rangle}$ implies that 
the momentums $\alpha_{\langle r,s \rangle}$ and $\alpha_{\langle r',s' \rangle}$ \eqref{ars} obey $\alpha_{\langle r,s \rangle}=\alpha_{\langle r',s' \rangle}$ or $\alpha_{\langle r,s \rangle}=Q-\alpha_{\langle r',s' \rangle}$, and $b^2$ must therefore be rational.
To obtain rational theories, it is enough to focus on the case 
\begin{align}
 \alpha_{\langle r,s \rangle}+\alpha_{\langle r',s' \rangle} = Q\ .
\end{align}
Defining the natural integers 
\begin{align}
 p = r+r' \quad , \quad q = s+s'\ ,
\end{align}
which we assume to be coprime, we have 
\begin{align} 
 \boxed{b^2 = - \frac{q}{p}} \ ,
\end{align}
and the central charge obeys $c\in ]-\infty, 1[$ and is given by eq. \eqref{cpq}.

Let us investigate the fusion rules involving such a doubly degenerate field.
According to eq. \eqref{rtv}, the representation $\mathcal{V}_{\alpha'} $ can appear in the fusion product $R\times \mathcal{V}_\alpha$ only if there are integers $(i,j,i',j')\in [0,r-1]\times [0,s-1]\times [0,r'-1]\times [0,s'-1]$ such that 
\begin{align}
 \Delta(\alpha') = \Delta\left(\alpha+\alpha_{\langle r,s \rangle} + ib+jb^{-1}\right) = \Delta\left(\alpha+\alpha_{\langle r',s' \rangle} +i'b+j'b^{-1}\right) \ .
\end{align}
Since $\Delta(\alpha)$ \eqref{daq} is a quadratic function, we a priori have two types of solutions.
In the first type, we have $\alpha+\alpha_{\langle r,s \rangle} + ib+jb^{-1} = \alpha+\alpha_{\langle r',s' \rangle} +i'b+j'b^{-1}$, which implies $q(r-i+i')=p(s-j+j')$.
Given the ranges of $i$ and $i'$, we however have $r-i+i'\in [1,p-1]$, and there are no solutions of the first type.
Solutions of the second type are such that 
\begin{align}
 \left(\alpha+\alpha_{\langle r,s \rangle} + ib+jb^{-1}\right) + \left(\alpha+\alpha_{\langle r',s' \rangle} +i'b+j'b^{-1}\right) = Q\ .
\end{align}
Using the notations $r'' = i+i'+1$ and $s''=j+j'+1$, this implies
\begin{align}
 \alpha=\alpha_{\langle r'',s'' \rangle}\quad \text{with}\quad  \left\{\begin{array}{l}  r'' \in [1,p-1]\ , \\ s'' \in [1,q-1]\ . \end{array}\right. 
\label{rpsq}
\end{align}
This defines the \textbf{\boldmath Kac table}\index{Kac table} -- the set of integers $(r'',s'')$ such that $\mathcal{V}_{\alpha_{\langle r'',s''\rangle}}$ has a nonzero fusion product with our doubly degenerate representation $R$.
At a given central charge, this set does not depend on the choice of $R$. 
And due to the identity 
\begin{align}
 \alpha_{\langle r'',s'' \rangle}+\alpha_{\langle p-r'',q-s'' \rangle}=Q\ ,
\end{align}
the corresponding degenerate representations $R_{\langle r'', s'' \rangle}$ are actually doubly degenerate. 
We already encountered these doubly degenerate representations in the case $|p-q|=1$ when they are unitary, see eq. \eqref{rrs}. 

The fusion rules of doubly degenerate representations can be deduced from the fusion rules \eqref{rrsr} of degenerate representations, 
\begin{align}
  \boxed{R_{\langle r_1,s_1 \rangle} \times R_{\langle r_2,s_2 \rangle} = \sum_{r_3\overset{2}{=}|r_1-r_2|+1}^{\min(r_1+r_2,2p-r_1-r_2)-1}\ \sum_{s_3\overset{2}{=}|s_1-s_2|+1}^{\min(s_1+s_2,2q-s_1-s_2)-1} R_{\langle r_3,s_3 \rangle}}\ .
\label{rrmm}
\end{align}
(See Exercise \ref{exofus}.) Equivalently, 
the condition for three doubly degenerate representations $R_{\langle r_i,s_i \rangle}$ to be intertwined by fusion is 
\begin{align}
 \left\{\begin{array}{l}  2p-r_1-r_2-r_3\in 1+2{\mathbb{N}}\ , \\
 r_i+r_j-r_k \in 1 + 2{\mathbb{N}}\ , \\
2q-s_1-s_2-s_3\in 1+2{\mathbb{N}}\ , \\
 s_i+s_j-s_k \in 1 + 2{\mathbb{N}}\ , \end{array}\right.  
\quad \text{or} \quad
 \left\{\begin{array}{l}  r_1+r_2+r_3-p\in 1+2{\mathbb{N}}\ , \\
 p+r_k-r_i-r_j\in 1+2{\mathbb{N}} \ , \\
s_1+s_2+s_3-q\in 1+2{\mathbb{N}}\ , \\
 p+s_k-s_i-s_j\in 1+2{\mathbb{N}} \ ,\end{array}\right. 
\end{align}
where we assume $i\neq j\neq k$.
So the set of the doubly degenerate representations is closed under fusion.
This set can therefore be used to build the spectrum of an A-series minimal model,
\begin{align}
 \boxed{ S_{p,q} = \frac12 \bigoplus_{r=1}^{p-1} \bigoplus_{s=1}^{q-1} R_{\langle r,s \rangle}\otimes \bar{R}_{\langle r,s \rangle} } \ ,
\label{smin}
\end{align}
where the factor $\frac12$ is here to avoid counting each representation $R_{\langle r,s \rangle}=R_{\langle p-r,q-s \rangle}$ twice.
As in the case of generalized minimal models, we could define submodels whose spectrums would be based on smaller sets of representations, provided these smaller sets were closed under fusion.
However, the minimal models have the distinction of being consistent not only on the sphere, but also on all other Riemann surfaces \cite{fms97}.
It is easy to see that minimal models with $|p-q|>1$, and generalized minimal models, cannot be unitary, due to the presence of fields with negative conformal dimensions in their spectrums. (See Exercise \ref{exoneg}.)

Finally, let us discuss the correlation functions of the A-series minimal models.
The three-point structure constants are given by the same formula \eqref{cpqb} as in generalized minimal models, where the rationality of $b^2$ does not bring noteworthy simplifications. 
Some of the minimal model structure constants however correspond to values of $\langle r_i,s_i\rangle$ which violate the fusion rules of the generalized minimal models -- for instance, $C_{\langle 1,1\rangle,\langle 1,1\rangle,\langle p-1,q-1\rangle}$. 
The difference between generalized minimal models and minimal models is more apparent in universal quantities which reflect the nature of the involved representations: degenerate in the former case, doubly degenerate in the latter case.
For instance, the two-point function of a minimal model is 
\begin{align}
 \left\langle V_{\langle r_1,s_1 \rangle} V_{\langle r_2,s_2 \rangle} \right\rangle = \delta_{r_1,p-r_2}\delta_{s_1,q-s_2} + R(\alpha_{\langle r_1,s_1 \rangle}) \delta_{r_1,r_2} \delta_{s_1,s_2} \ .
\label{vvddp}
\end{align}
(Compare with the two-point function of a generalized minimal model \eqref{vvdd}.) This formula can be simplified by renormalizing the fields, so that the reflection coefficient $R(\alpha_{\langle r,s\rangle})$ becomes one.
We refrained from performing such a renormalization in Liouville theory or in generalized minimal models, as this would have spoiled the analyticity of correlation functions.
In minimal models, there are no continuous parameters and therefore no issues of analyticity.
Defining
\begin{align}
 \boxed{\tilde{V}_{\langle r,s \rangle} = \frac{1}{\sqrt{R(\alpha_{\langle r,s \rangle})}} V_{\langle r,s \rangle}}\ , 
\end{align}
where the reflection coefficient $R(\alpha)$ was given in eq. \eqref{ram}, we now have 
\begin{align}
 \tilde{V}_{\langle r,s \rangle} = \tilde{V}_{\langle p-r,q-s \rangle}\ .
\end{align}
Correlation functions are modified accordingly, and in particular the two-point function becomes
\begin{align}
 \boxed{\left\langle \tilde{V}_{\langle r_1,s_1 \rangle} \tilde{V}_{\langle r_2,s_2 \rangle} \right\rangle = \delta_{r_1,p-r_2}\delta_{s_1,q-s_2} + \delta_{r_1,r_2} \delta_{s_1,s_2}} \ .
\end{align}
There is an additional subtlety in the case of the three-point function: if we want $\tilde{V}_{\langle 1,1 \rangle}$ to be the identity field like $V_{\langle 1,1 \rangle}$, we need to renormalize the three-point structure constant with a factor $\sqrt{R(\alpha_{\langle 1,1 \rangle})}$ on top of the factors coming from the field renormalizations, so that 
\begin{align}
 \tilde{C}_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle} = \sqrt{\frac{R(\alpha_{\langle 1,1 \rangle})}{\prod_{i=1}^3 R(\alpha_{\langle r_i,s_i \rangle})}}  C_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle}\ ,
\label{tcc}
\end{align}
where $C_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle}$ was given in eq. \eqref{cpqb}.
Then $\tilde{C}_{\langle r_1,s_1\rangle ,\langle r_2,s_2\rangle ,\langle r_3,s_3 \rangle}$ does not depend on the cosmological constant, and we have 
\begin{align}
\boxed{ \tilde{C}_{\langle 1,1\rangle , \langle r,s \rangle,\langle r,s \rangle}=1}\ .
\end{align}

% 3pt function essentially agrees with Dotsenko-Fateev result, as transcribed in hep-th/9112029 eq. (15). 

\subsection{Examples of A-series minimal models}

\paragraph{Trivial model $(p,q)=(3,2) \Rightarrow c = 0$\ .}

This unitary minimal model has only one field -- the identity $I=\tilde{V}_{\langle 1,1 \rangle}=\tilde{V}_{\langle 2,1 \rangle}$.
The fusion rule $I\times I = I$ and three-point structure constant $\tilde{C}_{III} = 1$ are trivial.

\paragraph{Model $(p,q)=(5,2) \Rightarrow c=-\tfrac{22}{5}$\ of the Yang-Lee singularity.}

This minimal model has two independent fields, whose names and conformal dimensions $\Delta_{\langle r,s\rangle}$ are 
\begin{align}
 \begin{tikzpicture}[scale = .5, baseline=(current  bounding  box.center)]
  \draw[thick] (-1,-1) -- (-1, 1) -- (7, 1) -- (7, -1) -- cycle;
  \foreach \x in {1, ..., 4}{
  \node at ({2*(\x-1)}, 0) {$\langle \x,1\rangle $};
  }
 \end{tikzpicture}
 \ \ 
 \begin{tikzpicture}[scale = .5, baseline=(current  bounding  box.center)]
  \draw[thick] (-1,-1) -- (-1, 1) -- (7, 1) -- (7, -1) -- cycle;
  \node at (0, 0) {$I$};
  \node at (2, 0) {$\phi$};
  \node at (4, 0) {$\phi$};
  \node at (6, 0) {$I$};
  \end{tikzpicture}
  \ \ 
  \begin{tikzpicture}[scale = .5, baseline=(current  bounding  box.center)]
  \draw[thick] (-1,-1) -- (-1, 1) -- (7, 1) -- (7, -1) -- cycle;
  \node at (0, 0) {$0$};
  \node at (2, 0) {$-\frac15$};
  \node at (4, 0) {$-\frac15$};
  \node at (6, 0) {$0$};
  \end{tikzpicture}
\end{align}
Since the model is diagonal, we can use the symbols $I$ and $\phi$ not only for fields, but also for the corresponding representations of the Virasoro algebra.
The fusion rules are 
\begin{align}
 \begin{array}{l}
  I\times I = I \ ,
\\ I\times \phi= \phi\ ,
\\ \phi \times \phi = I + \phi\ .
 \end{array}
\end{align}
The only three-point structure constant not involving the identity field is 
\begin{align}
 \tilde{C}_{\phi\phi\phi} = i\sqrt{3\frac{\Gamma(-\frac35)}{\Gamma(-\frac15)^3} \frac{\Gamma(\frac15)^3}{\Gamma(\frac35)}}\ .
\label{cppp}
\end{align}
(See Exercise \ref{exocppp}.)

\paragraph{\textbf{\boldmath Ising model}\index{Ising model} $(p,q)=(4,3) \Rightarrow c=\tfrac12$\ .}

This unitary minimal model has three independent fields, 
\begin{align}
 \begin{tikzpicture}[scale = .5, baseline=(current  bounding  box.center)]
  \draw[thick] (-1,-1) -- (-1, 3) -- (5, 3) -- (5, -1) -- cycle;
  \foreach \x in {1, ..., 3}{
  \foreach \y in {1, 2}{
  \node at ({2*(\x-1)}, {2*(\y-1)}) {$\langle \x,\y\rangle $};
  }}
 \end{tikzpicture}
 \ \ 
 \begin{tikzpicture}[scale = .5, baseline=(current  bounding  box.center)]
  \draw[thick] (-1,-1) -- (-1, 3) -- (5, 3) -- (5, -1) -- cycle;
  \node at (0, 0) {$I$};
  \node at (2, 0) {$\sigma$};
  \node at (4, 0) {$\epsilon$};
  \node at (0, 2) {$\epsilon$};
  \node at (2, 2) {$\sigma$};
  \node at (4, 2) {$I$};
 \end{tikzpicture}
 \ \ 
 \begin{tikzpicture}[scale = .5, baseline=(current  bounding  box.center)]
  \draw[thick] (-1,-1) -- (-1, 3) -- (5, 3) -- (5, -1) -- cycle;
  \node at (0, 0) {$0$};
  \node at (2, 0) {$\frac{1}{16}$};
  \node at (4, 0) {$\frac12$};
  \node at (0, 2) {$\frac12$};
  \node at (2, 2) {$\frac{1}{16}$};
  \node at (4, 2) {$0$};
 \end{tikzpicture}
\end{align}
The fusion rules are 
\begin{align}
\begin{array}{l}
 I\times I = I \ ,
\\ I\times \epsilon = \epsilon\ ,
\\ I\times \sigma = \sigma\ ,
\end{array}
\hspace{2cm}
\begin{array}{l}
 \epsilon\times \epsilon = I\ ,
\\ \epsilon\times \sigma = \sigma\ ,
\\ \sigma \times \sigma = I + \epsilon\ .
\end{array}
\end{align}
We notice that there are two simple currents, as defined in Section \ref{seccc}: the identity field $I$, and the field $\epsilon$.
Similarly, any A-series minimal model with $p,q>2$ has two simple currents $\tilde{V}_{\langle 1,1 \rangle}$ and $\tilde{V}_{\langle 1,q-1 \rangle}=\tilde{V}_{\langle p-1,1 \rangle}$. 

The only three-point structure constant not involving the identity field is 
\begin{align}
 \tilde{C}_{\sigma\sigma\epsilon} =\frac12\ .
\label{csse}
\end{align}
(See Exercise \ref{exocsse}.)
% agrees with the ZZ book

Finally, let us comment on the interpretation of this minimal model in terms of statistical physics.
The Ising model of statistical physics describes two-state spins on a lattice.
Our field $\sigma$ describes these spins, while the field $\epsilon$ describes the energy.
Flipping spins is a symmetry of the model, and this symmetry manifests itself as the invariance of the fusion rules under $\sigma\to -\sigma$. 

\section{Exercises}

\begin{exo}[Normalization of degenerate OPE coefficients in Liouville theory]
 ~\label{exonorm}
Starting with an arbitrary field normalization, prove that there is a function $\lambda(\alpha)$ such that the field renormalization \eqref{vlv} ensures that eq. \eqref{cco} is obeyed.
To do this, study how $C_+(\alpha)$ and $\tilde{C}_+(\alpha)$ behave under field renormalizations, and show that they renormalize to one provided
\begin{align}
\left\{\begin{array}{l} 
 C_+(\alpha) = \frac{\lambda(\alpha-\frac{b}{2})}{\lambda(\alpha)\lambda(-\frac{b}{2})} \ ,
\\
\tilde{C}_+(\alpha) = \frac{\lambda(\alpha-\frac{1}{2b})}{\lambda(\alpha)\lambda(-\frac{1}{2b})} \ .
\end{array}\right. 
\end{align}
Use eq. \eqref{ctc} for showing that these equations for $\lambda(\alpha)$ are compatible with each other, and eq. \eqref{cpcp} for showing that they are compatible with the  assumed behaviour of $\lambda(\alpha)$ under reflections eq. \eqref{llo}.
Conclude that these equations do have a solution.
\end{exo}

\begin{exo}[Allowing finite multiplicities in Liouville theory]
 ~\label{exomul}
Redo the analysis of Section \ref{seccbe}, after relaxing the assumption that the multiplies are at most one, and allowing a finite multiplicity $m\geq 2$ instead. 
Assuming that the continuous fields are now vectors of size $m$ while the degenerate fields remain scalars, find the relations between the degenerate OPE coefficients and the reflection coefficient, all of which are now matrices of size $m$. 
Requiring these quantities to be analytic functions of the momentum, show that the reflection coefficient must still be given by eq. \eqref{ram}, where the cosmological constant is now a matrix. 
Conclude that the theory is equivalent to $m$ independent copies of Liouville theory. 
\end{exo}


\begin{exo}[Fusion rules of all unitary representations if $c>1$]
 ~\label{exoaur}
Compute the analytic continuation of the Liouville OPE to momentums $\beta\in ]0,Q[$, which correspond to unitary representation that do not belong to the spectrum \eqref{sad}. 
Show that this leads to the following conjecture for the fusion rules, where we assume $\beta_1,\beta_2\in ]0,\frac{Q}{2}[$:
\begin{align}
 \mathcal{V}_\beta \times \mathcal{V}_\alpha  
&= \frac12 \int_{\frac{Q}{2}+i\mathbb{R}} d\alpha'\ \mathcal{V}_{\alpha'}\ ,
\\
 \mathcal{V}_{\beta_1} \times \mathcal{V}_{\beta_2} 
&= \sum_{\beta'\in \left]0,\frac{Q}{2}\right[\cap \left(\beta_1+\beta_2 + b\mathbb{N}+b^{-1}\mathbb{N}\right)} \mathcal{V}_{\beta'}  
+ \frac12 \int_{\frac{Q}{2}+i\mathbb{R}} d\alpha'\ \mathcal{V}_{\alpha'}\ .
\end{align}
In particular, determine a lower bound on the conformal dimension $\Delta$, such that $\mathcal{V}_\Delta \times \mathcal{V}_\Delta$ belongs to the Liouville spectrum.
What are the consequences of these results for possible extensions of Liouville theory?
\end{exo}

\begin{exo}[Fusion rules of doubly degenerate representations]
 ~\label{exofus}
Derive the fusion rules \eqref{rrmm} of doubly degenerate representations.
To do this, write the degenerate fusion rule \eqref{rrsr} as 
\begin{align}
\langle r_3, s_3\rangle\in\ ]|r_1-r_2|,r_1+r_2[ \times ]|s_1-s_2|,s_1+s_2[ \ .
\end{align}
Using the symmetry of the Kac table,
\begin{align}
 \sigma\langle r,s \rangle = \langle p-r,q-s\rangle\ ,
\label{srs}
\end{align}
show that the doubly degenerate fusion rules are
\begin{align}
\langle r_3, s_3\rangle& \in \bigcap_{\epsilon_1,\epsilon_2 = 0,1}\ \bigcup_{\epsilon=0,1} \ \sigma_1^{\epsilon_1} \sigma_2^{\epsilon_2} \sigma^{\epsilon}
\Big( \big]|r_1-r_2|,r_1+r_2\big[ \times \big]|s_1-s_2|,s_1+s_2\big[  \Big)\ ,
\\
& = \bigcup_{\epsilon:\{0,1\}^2 \to \{0,1\} }\ \bigcap_{\epsilon_1,\epsilon_2=0,1} \ \sigma_1^{\epsilon_1} \sigma_2^{\epsilon_2} \sigma^{\epsilon(\epsilon_1,\epsilon_2)} \Big( \big]|r_1-r_2|,r_1+r_2\big[ \times \big]|s_1-s_2|,s_1+s_2\big[  \Big)\ ,
\end{align}
where $\sigma_i$ acts on $\langle r_i,s_i\rangle$ as in eq. \eqref{srs}, while $\sigma$ acts on a rectangle as $\sigma\big(]a,b[\times]c,d[\big) = ]p-b,p-a[\times ]q-d,q-c[$.
Show that each one of the $16$ rectangles parametrized by the function $\epsilon:\{0,1\}^2 \to \{0,1\} $ is a subset of one of the two rectangles which correspond to the two functions $\epsilon(\epsilon_1,\epsilon_2)=\pm (\epsilon_1+\epsilon_2) \mod 2$, so that 
\begin{multline}
 \langle r_3, s_3\rangle  \in\  \big]|r_1-r_2|,p-|r_1+r_2-p|\big[\times \big]|s_1-s_2|,q-|s_1+s_2-q|\big[ 
\\
 \bigcup\ \big]|r_1+r_2-p|,p-|r_1-r_2|\big[\times \big]|s_1+s_2-q|,q-|s_1-s_2|\big[\ .
\end{multline}
Finally, rewrite this as eq. \eqref{rrmm}.
\end{exo}

\begin{exo}[Unitarity of (generalized) minimal models]
 ~\label{exoneg}
From Section \ref{secuni} on unitarity, assume we only remember that highest-weight representations with conformal dimensions $\Delta <0$ cannot be unitary. 
Assuming $b^2 < -1$, show that the condition for the conformal dimension $\Delta_{\langle r,s \rangle}$ \eqref{drs} of a degenerate representation to be negative is 
\begin{align}
 \Delta_{\langle r,s \rangle} < 0 \quad \Leftrightarrow \quad \frac{r-1}{s-1} < -\frac{1}{b^2} < \frac{r+1}{s+1} \ .
\end{align}
If $b^2$ is irrational, show that this occurs for infinitely many choices of $\langle r,s \rangle$, by applying the Dirichlet approximation theorem to $-\frac{1}{b^2}$. 
Deduce that the corresponding generalized minimal model is not unitary. 
In the minimal model case $b^2 = -\frac{q}{p}$, show that 
\begin{align}
 \bigcup_{r=1}^{p-1}\bigcup_{s=1}^{q-1} \left] \frac{r-1}{s-1} , \frac{r+1}{s+1} \right[  = \left]0, \frac{p}{p+1}\right[ \ .
\end{align}
(Pay special attention to the case $s=r+1$.) Deduce that if $|q-p|>1$, then the corresponding minimal model is not unitary.
Assuming that the fusion product of two representations is unitary if and only if both representations are unitary, show that in non-unitary (generalized) minimal models, at least some of the representations with positive conformal dimensions are non-unitary.
\end{exo}

\begin{exo}[Structure constant of the $(5,2)$ minimal model]
 ~\label{exocppp}
Using eq. \eqref{tcc}, write the non-trivial structure constant of the $(5,2)$ minimal model as 
\begin{align}
 \tilde{C}_{\phi\phi\phi} = \sqrt{\frac{R(\alpha_{\langle 1,1 \rangle})}{R(\alpha_{\langle 2,1 \rangle})^3}} C_{\langle 2,1\rangle , \langle 2,1 \rangle,\langle 2,1 \rangle}\ .
\end{align}
Notice that $C_{\langle 2,1\rangle , \langle 2,1 \rangle,\langle 2,1 \rangle} = C_+(\alpha_{\langle 2,1 \rangle})=1$ due to eqs. \eqref{vot} and \eqref{cco}.
Setting $\mu=1$, compute
\begin{align}
 R(\alpha_{\langle 1,1 \rangle}) = -\frac{\Gamma(-\frac35)\Gamma(\frac32)}{\Gamma(\frac35)\Gamma(-\frac32)} \ , \quad R(\alpha_{\langle 2,1 \rangle}) = -\frac{\Gamma(-\frac15)\Gamma(\frac12)}{\Gamma(\frac15)\Gamma(-\frac12)}\ , 
\end{align}
and deduce the explicit formula \eqref{cppp} for $\tilde{C}_{\phi\phi\phi}$.
\end{exo}

\begin{exo}[Structure constant of the $(4,3)$ minimal model]
 ~\label{exocsse}
Write the non-trivial structure constant of the $(4,3)$ minimal model as
\begin{align}
 \tilde{C}_{\sigma\sigma\epsilon} = \frac{1}{R(\alpha_{\langle 2,1 \rangle})}\sqrt{\frac{R(\alpha_{\langle 1,1 \rangle})}{R(\alpha_{\langle 1,2 \rangle})}} C_{\langle 2,1\rangle , \langle 2,1 \rangle,\langle 1,2 \rangle}\ .
\end{align}
Setting $\mu=1$, compute
\begin{align}
 R(\alpha_{\langle 1,1 \rangle}) = -\frac{\Gamma(-\frac14)\Gamma(\frac13)}{\Gamma(\frac14)\Gamma(-\frac13)} \ , \quad R(\alpha_{\langle 1,2 \rangle}) = -\frac{\Gamma(-\frac54)\Gamma(\frac53)}{\Gamma(\frac54)\Gamma(-\frac53)} \ , \quad R(\alpha_{\langle 2,1 \rangle}) = -\frac{\Gamma(\frac12)\Gamma(-\frac23)}{\Gamma(-\frac12)\Gamma(\frac23)}\ ,
\end{align}
and deduce the explicit formula \eqref{csse} for $\tilde{C}_{\sigma\sigma\epsilon}$.
\end{exo}


\chapter{Affine symmetry \label{secaff}}

Affine Lie algebras are infinite-dimensional Lie algebras, whose relevance to conformal field theory comes from the fact that they contain the Virasoro algebra.
In order to study theories based on these algebras, we will follow the same steps as in the case of the Virasoro algebra: study the algebras and their representations, deduce Ward identities and differential equations for correlation functions, and write spectrums and correlation functions for particular models. 

\section{Free bosons}

\subsection{Symmetry algebra and representations \label{secaua}}

In Section \ref{secem}, we showed how the Virasoro symmetry algebra is encoded in the energy-momentum tensor $T(y)$.
Similarly, we now introduce the holomorphic \textbf{\boldmath $\hat{\mathfrak{u}}_1$ current}\index{u1 current@$\hat{\mathfrak{u}}_1$ current} $J(y)$, the symmetry field which encodes the symmetry algebra of free bosonic theories.
This field is characterized by the OPE
\begin{align}
 \boxed{J(y)J(z) = \frac{-\frac12}{(y-z)^2} + O(1)}\ .
\label{jj}
\end{align}
Using such a $\hat{\mathfrak{u}}_1$ current, it is possible to build a family of Virasoro fields,
\begin{align}
 \boxed{T(z) = -(JJ)(z) - Q\partial J(z)}\ ,
\label{tqz}
\end{align}
which depend on a parameter $Q$ called the \textbf{\boldmath background charge}\index{background charge}. 
Here $(JJ)(z)$ is an instance of the \textbf{\boldmath normal-ordered product}\index{normal-ordered product}, 
\begin{align}
 (AB)(z) = \frac{1}{2\pi i} \oint_z \frac{dy}{y-z} A(y)B(z)\ .
\label{abz}
\end{align}
In the case of $(JJ)(z)$, this definition amounts to
\begin{align}
 (JJ)(z) = \underset{y\to z}{\lim} \left( J(y)J(z) + \frac{\frac12}{(y-z)^2}\right)\ .
\end{align}
If we furthermore call $\cunderbracket{A}{(y)}{B}(z)$ the singular part of the OPE $A(y)B(z)$, we have
\begin{align}
 A(y)B(z) = \cunderbracket{A}{(y)}{B}(z) + (AB)(z) + O(y-z)\ .
 \label{abope}
\end{align}
In general $\cunderbracket{A}{(y)}{B}(z) \neq \cunderbracket{B}{(z)}{A}(y)$ and $(AB)\neq (BA)$ although $A(y)B(z)=B(z)A(y)$.
(See exercise \ref{exoabba} for the computation of $(AB)-(BA)$.)
OPEs of normal-ordered products can be computed using \textbf{\boldmath Wick's theorem}\index{Wick's theorem},
\begin{align}
 \cunderbracket{A}{(z)}{(BC)}(y) = \frac{1}{2\pi i}\oint_y \frac{dx}{x-y}\left(\cunderbracket{A}{(z)}{B}(x)C(y) + B(x)\cunderbracket{A}{(z)}{C}(y)\right)\ .
\label{wick}
\end{align}
For example, we can compute 
\begin{align}
 (JJ)(y)J(z) = -\frac{J(y)}{(y-z)^2} +O(1) =  -{\frac{\partial}{\partial z}}\frac{J(z)}{y-z} + O(1)\ ,
\end{align}
which leads to 
\begin{align}
 \boxed{T(y)J(z) = \frac{-Q}{(y-z)^3} +{\frac{\partial}{\partial z}}\frac{1}{y-z}J(z) + O(1)}\ .
\label{tqj}
\end{align}
Then we can compute the OPE $T(y)T(z)$, and we find nothing but the Virasoro field OPE \eqref{tt}, where the central charge is given in terms of the background charge $Q$ by $c = 1+6 Q^2$ (repeating eq. \eqref{cqb}). 
So $T(z)$ is a Virasoro field as announced. 
In order to build conformal field theories from the current $J(z)$, we choose a value of $Q$ and identify the corresponding Virasoro field with the energy-momentum tensor -- the Virasoro fields with $Q'\neq Q$ will henceforth play no role.

The OPE of $J(y)$ with a generic field $V_\sigma(z_0,\bar{z}_0)$ is 
\begin{align}
 \boxed{J(y) V_\sigma(z_0,\bar{z}_0) = \sum_{n\in {\mathbb{Z}}} \frac{J_n V_\sigma(z_0,\bar{z}_0)}{(y-z_0)^{n+1}}}\ .
\label{jvn}
\end{align}
This OPE is consistent with dimensional analysis, if in addition to the known dimensions \eqref{zaz} we assume $[J]=1$ and $[J_n]=-n$.
The $J(y)J(z)$ OPE \eqref{jj} is equivalent to the commutation relations
\begin{align}
 \boxed{ [J_m,J_n] =  \frac12 n\ \delta_{m+n,0}}\ ,
\label{jmjn}
\end{align}
which define the  \textbf{\boldmath affine Lie algebra $\hat{\mathfrak{u}}_1$}\index{affine Lie algebra $\hat{\mathfrak{u}}_1$}.
This algebra can be written as a direct sum of commuting finite-dimensional subalgebras as 
\begin{align}
 \hat{\mathfrak{u}}_1 = \text{Span}(J_0) \oplus \bigoplus_{n=1}^\infty \text{Span}(J_n,J_{-n}) \ .
\end{align}
The construction \eqref{tqz} of $T(z)$ from the $\hat{\mathfrak{u}}_1$ current $J(z)$ is equivalent to the following formula for the modes $L_n$ \eqref{lit} of $T(z)$:
\begin{align}
 L_n &= -\sum_{m\in{\mathbb{Z}}} J_{n-m}J_m + Q(n+1)J_n\ , \qquad (n\neq 0)\ ,
\label{lnj}
\\
L_0 &=-2\sum_{m=1}^\infty J_{-m}J_m -J_0^2+QJ_0 \ ,
\label{lzj}
\end{align}
and the $TJ$ OPE \eqref{tqj} is equivalent to 
\begin{align}
 [L_m,J_n] = -nJ_{m+n} -\frac{Q}{2}m(m+1)\ \delta_{m+n,0} \ . 
\end{align}
The behaviour \eqref{ldn} of $L_n$ under hermitian conjugation suggests 
\begin{align}
 J_n^\dagger = Q\delta_{n,0}-J_{-n}\ .
\label{jdq}
\end{align}
This makes sense only provided $J_n^{\dagger \dagger} =J_n$, which requires 
\begin{align}
 Q \in {\mathbb{R}} \ .
\label{qir}
\end{align}
This restriction on $Q$ is a necessary condition for the construction of a $\hat{\mathfrak{u}}_1$-symmetric scalar product on representations of the $\hat{\mathfrak{u}}_1$ algebra, in the same way as the condition $c\in {\mathbb{R}}$ was necessary in the case of the Virasoro algebra. (See Section \ref{secsots}.)

We define a \textbf{\boldmath $\hat{\mathfrak{u}}_1$-primary field}\index{u1-primary field@$\hat{\mathfrak{u}}_1$-primary field} $V_{\alpha}(z_0,\bar{z}_0)$ with the \textbf{\boldmath momentum}\index{momentum} $\alpha$ by its OPE with $J(y)$,
\begin{align}
 \boxed{J(y) V_\alpha(z_0) = \frac{\alpha}{y-z_0} V_\alpha(z_0) + O(1)}\ ,
\label{jva}
\end{align}
where the $\bar{z}_0$-dependence of $V_\alpha(z_0)$ is left implicit. 
Any $\hat{\mathfrak{u}}_1$-primary field is also a primary field, whose OPE $T(y)V_\alpha(z_0)$ is given by eq. \eqref{tvp}, with the conformal dimension $\Delta(\alpha) = \alpha(Q-\alpha)$ (repeating eq. \eqref{daq}).
To a $\hat{\mathfrak{u}}_1$-primary field $V_\alpha(z_0)$ we associate a highest-weight representation $\mathcal{V}_\alpha$ of the $\hat{\mathfrak{u}}_1$ affine Lie algebra.
The states in $\mathcal{V}_\alpha$ correspond to $V_\alpha(z_0)$ and its $\hat{\mathfrak{u}}_1$-descendent fields $V_\sigma(z_0)=\left(\prod_i J_{-n_i}\right) V_\alpha(z_0)$ with $n_i\geq 1$, which obey 
\begin{align}
 \left(J_0 - \alpha\right) V_\sigma(z_0) = 0
\label{jma}
\end{align}
A natural scalar product can be defined in $\mathcal{V}_\alpha$ using eq. \eqref{jdq}, and $\mathcal{V}_\alpha$ is unitary provided
\begin{align}
 \alpha \in \frac{Q}{2} + i{\mathbb{R}}\ .
\label{aif}
\end{align}

Let us compare $\hat{\mathfrak{u}}_1$ and Virasoro highest-weight representations. 
Under the action of the Virasoro algebra eqs. \eqref{lnj}-\eqref{lzj}, the $\hat{\mathfrak{u}}_1$ highest-weight representation $\mathcal{V}_\alpha$ is a Verma module -- the Verma module $\mathcal{V}_\alpha$ of Section \ref{secvm}.
However, this Verma module is invariant under reflection of $\alpha$, whereas the $\hat{\mathfrak{u}}_1$ representation is not.
To summarize,
\begin{align}
\renewcommand{\arraystretch}{1.3}
 \begin{tabular}{|l|c|c|}
  \hline
 Symmetry algebra  & $\mathfrak{V}$ & $\hat{\mathfrak{u}}_1 $
\\
\hline\hline
 Existence of scalar product & $Q\in {\mathbb{R}} \cup i{\mathbb{R}} $ & $Q\in {\mathbb{R}}$ 
\\
\hline
 Unitarity of $\mathcal{V}_\alpha$ & $\alpha\in \frac{Q}{2}+i{\mathbb{R}} \cup ]0,Q[ $ & $\alpha \in \frac{Q}{2}+i{\mathbb{R}}$
\\
\hline 
 Reflection relation  & $\mathcal{V}_\alpha = \mathcal{V}_{Q-\alpha} $ & $\mathcal{V}_\alpha \neq \mathcal{V}_{Q-\alpha} $ 
\\
\hline
 \end{tabular}
\end{align}

Finally, the $\hat{\mathfrak{u}}_1$ fusion rules can be derived by 
inserting $\oint_\infty J(z)dz$ in the OPE of two primary fields, and we find 
\begin{align}
 \boxed{\mathcal{V}_{\alpha_1}\times \mathcal{V}_{\alpha_2} = \mathcal{V}_{\alpha_1+\alpha_2}}\ ,
\label{vvp}
\end{align}
so that the momentum $\alpha$ is conserved.
The OPE then reads 
\begin{align}
\boxed{V_{\alpha_1}(z_1,\bar{z}_1)V_{\alpha_2}(z_2,\bar{z}_2) 
= 
|z_1-z_2|^{-4\alpha_1\alpha_2} \big( V_{\alpha_1+\alpha_2}(z_2,\bar{z}_2) + O(z_1-z_2)\big)}\ ,
\label{vvoo}
\end{align}
where we have normalized the fields $V_\alpha$ so that the OPE coefficient is one. (See Exercise \ref{exoone}.)
It is actually possible to write all the descendents explicitly,
\begin{align}
 V_{\alpha_1}(z_1,\bar{z}_1)V_{\alpha_2}(z_2,\bar{z}_2) = |z_1-z_2|^{-4\alpha_1\alpha_2}\exp\left(-\sum_{p=1}^\infty \frac{2}{p}\alpha_1 \left(z_{12}^pJ_{-p}+\bar{z}_{12}^p \bar{J}_{-p}\right) \right) V_{\alpha_1+\alpha_2}(z_2,\bar{z}_2) \ .
\end{align}



\subsection{Ward identities and Seiberg-Witten equations}

Let us study the $\hat{\mathfrak{u}}_1$ Ward identities for correlation functions.
To do this, we need to know how the current $J(y)$ behaves as $y\to \infty$.
The relation \eqref{tqz} with the energy-momentum tensor $T(y)$, and the behaviour \eqref{tyi} of $T(y)$, suggest
\begin{align}
 \boxed{J(y) \underset{y\to \infty}{=} \frac{Q}{y} + O\left(\frac{1}{y^2}\right)}\ .
\label{jyi}
\end{align}
For any meromorphic function $\epsilon(y)$, with no poles outside $\{z_1,\cdots z_N\}$, we have 
\begin{align}
 \oint_\infty dy\ \epsilon(y) \left\langle \left(J(y)-\frac{Q}{y}\right)\prod_{j=1}^N V_{\sigma_j}(z_j)\right\rangle = 0   \quad \text{provided} \quad \epsilon(y) \underset{y\to\infty}{=} O(1)\ .
\end{align}
In the case $\epsilon(y)=1$, we obtain the $\hat{\mathfrak{u}}_1$ global Ward identity.
Assuming all fields are primary or descendent fields, and therefore obey eq. \eqref{jma}, the global Ward identity reads
\begin{align}
 \boxed{\sum_{i=1}^N \alpha_i = Q} \ ,
\label{saq}
\end{align}
In the case $\epsilon(z) = \frac{1}{(z-z_i)^{n}}$ with $n\geq 1$, we obtain the $\hat{\mathfrak{u}}_1$ local Ward identity
\begin{align}
\left\langle \left(J_{-n}^{(z_i)}+ (-1)^{n}\sum_{j\neq i}\sum_{p=0}^\infty \frac{\binom{p+n-1}{p}}{z_{ij}^{n+p}}  J_p^{(z_j)}\right)\prod_{j=1}^N V_{\sigma_j}(z_j) \right\rangle = 0\ .
\label{jnjp}
\end{align}
This simplifies when the fields with indices $j\neq i$ are primary, 
\begin{align}
 \left\langle \left(J_{-n}^{(z_i)}  + \sum_{j\neq i} \frac{\alpha_j}{z_{ji}^n}\right) V_{\sigma_i}(z_i)\prod_{j\neq i} V_{\alpha_j}(z_j)\right\rangle= 0\ .
\label{jnz}
\end{align}
If all fields are primary, we actually have 
\begin{align}
 \boxed{\left\langle J(y) \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle = \sum_{i=1}^N \frac{\alpha_i}{y-z_i} \left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle  }\ .
\label{jsa}
\end{align}

Let us now derive differential equations for correlation functions.
The conformal symmetry equations \eqref{spz} of course still hold in theories with the $\hat{\mathfrak{u}}_1$ symmetry algebra.
But the construction \eqref{tqz} of $T(z)$ from the $\hat{\mathfrak{u}}_1$ current $J(z)$ leads to additional differential equations.
In order to derive them, let us consider 
\begin{align}
 {\frac{\partial}{\partial z}} V_{\alpha}(z) = L_{-1}V_\alpha(z) = -2J_{-1}J_0 V_\alpha(z)\ ,
\end{align}
where we used eq. \eqref{lnj} for expressing $L_{-1}$ in terms of $J_{-1}$ and $J_0$.
We therefore obtain
\begin{align}
{\frac{\partial}{\partial z}} V_{\alpha}(z)&= -2\alpha J_{-1}V_\alpha(z) = -2\alpha(JV_\alpha)(z)\ .
\label{pvaj}
\end{align}
Applying this to a field $V_{\alpha_i}(z_i)$ in an 
$N$-point function of $\hat{\mathfrak{u}}_1$-primary fields, and using 
the local Ward identity \eqref{jnz} for $J_{-1}^{(z_i)}$, we obtain 
\begin{align}
\left( {\frac{\partial}{\partial z_i}} +\sum_{j\neq i} \frac{2\alpha_i\alpha_j}{z_i-z_j} \right) \left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle = 0 \ ,
\label{kzl}
\end{align}
which determines the correlation functions of $\hat{\mathfrak{u}}_1$-primary fields up to $z_i$-independent factors, 
\begin{align}
 \boxed{\left\langle \prod_{i=1}^N V_{\alpha_i}(z_i)\right\rangle  \propto \prod_{i<j} (z_i-z_j)^{-2\alpha_i\alpha_j}}\ .
\label{pzz}
\end{align}
In particular, the field $V_0(z)$ must be $z$-independent.
In the normalization of eq. \eqref{vvoo}, $V_0(z)$ is actually the identity field, and the proportionality factor in eq. \eqref{pzz} is not only $z_i$-independent, but also $\alpha_i$-independent.

Equation \eqref{pvaj} has further interesting consequences.
If $\nabla_z={\frac{\partial}{\partial z}} +2\alpha J(z)$, then we have $\nabla_z V_\alpha(z)=0$, neglecting the issue of regularizing the product $J(z)V_\alpha(z)$.
If we then define $\nabla_\alpha = {\frac{\partial}{\partial \alpha}}+2\int^z dyJ(y)$ so that $[\nabla_z,\nabla_\alpha]=0$, then $\nabla_\alpha V_\alpha(z)$ is annihilated by $\nabla_z$, and must be proportional to $V_\alpha(z)$.
The proportionality constant can be set to zero by renormalizing the field $V_\alpha(z)$, and this normalization coincides with the normalization which we adopted in eq. \eqref{vvoo}.
We thus obtain
\begin{align}
 {\frac{\partial}{\partial \alpha}} V_\alpha(z) = -2 \int^z dy\ J(y)V_\alpha(z)\ ,
\label{swp}
\end{align}
where the right-hand side denotes the regularized value at $z$ of a particular primitive of the integrand.
It can be checked that this equation holds when inserted into correlation functions of primary fields, using eqs. \eqref{pzz} and \eqref{jsa}, provided we use the primitive $\int^z \frac{dy}{y-z_i} = \log(z-z_i)$.
From the $JV_\alpha$ OPE \eqref{jva}, we also have the equation
\begin{align}
 \alpha\, V_\alpha(z) = \frac{1}{2\pi i} \oint_{z} dy\ J(y)V_\alpha(z)\ .
\label{swa}
\end{align}
Equations \eqref{swp} and \eqref{swa} show that the actions of ${\frac{\partial}{\partial \alpha}}$ and $\alpha$ on $V_\alpha(z)$ can be obtained by integrating the one-form $J(y)dy$ along particular contours.
By analogy with supersymmetric gauge theory, these equations may be called \textbf{\boldmath Seiberg-Witten equations}\index{Seiberg-Witten equation}. 


\subsection{Spectrum and correlation functions \label{secsacf}}

We define a \textbf{\boldmath free bosonic theory}\index{free bosonic theory} as a conformal field theory with $\hat{\mathfrak{u}}_1$ symmetry, such that each representation of the $\hat{\mathfrak{u}}_1 \times \bar{\hat{\mathfrak{u}}}_1$ symmetry algebra appears at most once in the spectrum.
First consider the diagonal, continuous spectrum 
\begin{align}
 \boxed{S = \int_{\frac{Q}{2}+i{\mathbb{R}}} d\alpha \ \mathcal{V}_\alpha \otimes \bar{\mathcal{V}}_\alpha}\ .
\label{sz}
\end{align}
If $Q\in {\mathbb{R}}$, this theory is unitary, as $\alpha$ obeys the unitarity condition \eqref{aif}.
The correlation functions are 
\begin{align}
 \left\langle \prod_{i=1}^N V_{\alpha_i}(z_i,\bar{z}_i)\right\rangle = \delta\left({\textstyle \sum}_{i=1}^N\alpha_i-Q\right)\ \prod_{i<j} |z_i-z_j|^{-4\alpha_i\alpha_j} \ .
\label{dpzz}
\end{align}
This spectrum and these correlation functions define the \textbf{\boldmath linear dilaton theory}\index{linear dilaton theory}. 
If $Q\notin i{\mathbb{R}}$, this theory has two related pathologies: the spectrum is not closed under fusion, and for any $N\neq 2$ all $N$-point functions of fields in the spectrum vanish.
However, correlation functions have natural continuations to momentums $\alpha_i$ outside the spectrum, and these continuations are used in the main application of the linear dilaton theory: 
as a tool for studying more complicated theories, such as Liouville theory. (See Section \ref{seclld}.) 

It is instructive to consider the spectrum \eqref{sz} from the point of view of the Virasoro algebra (instead of the $\hat{\mathfrak{u}}_1$ algebra), and to compare it with the spectrum \eqref{sad} of Liouville theory.
Since $\mathcal{V}_\alpha$ and $\mathcal{V}_{Q-\alpha}$ are identical as Virasoro representations, each Virasoro representation (except $\mathcal{V}_{\frac{Q}{2}}\otimes \bar{\mathcal{V}}_{\frac{Q}{2}}$) appears twice in the linear dilaton spectrum, which is therefore twice larger than the Liouville spectrum.
Remember also that not all unitary Virasoro representations appear in the Liouville spectrum.
We can now characterize
the representations which do appear as being unitary as $\hat{\mathfrak{u}}_1$ representations.

Let us now look for unitary free bosonic theories with discrete spectrums, while insisting that the spectrum closes under fusion \eqref{vvp}.
Given the unitarity condition $\alpha\in \frac{Q}{2}+i{\mathbb{R}}$ \eqref{aif} with $Q\in {\mathbb{R}}$, this leads to $Q=0$ so that the central charge is 
\begin{align}
 c=1\ .
\end{align}
The simplest discrete diagonal spectrum which can be written is 
\begin{align}
 S_R^0=\sum_{n\in{\mathbb{Z}}} \mathcal{V}_{\frac{in}{2R}}\otimes \bar{\mathcal{V}}_{\frac{in}{2R}}\ ,
\end{align}
where $R$ is an arbitrary real parameter.
Let us extend this spectrum by allowing non-diagonal terms, while accepting only bosonic fields.
Then eq. \eqref{dbdz} leads to $(\alpha-\bar{\alpha})(\alpha+\bar{\alpha})\in {\mathbb{Z}}$.
In the spectrum $S_R^0$ which we wish to extend, we have $\alpha+\bar{\alpha}\in\frac{i}{R}{\mathbb{Z}}$, so that the largest possible extension is obtained by assuming $\alpha-\bar{\alpha}\in iR{\mathbb{Z}}$.
This leads to the spectrum
\begin{align}
 \boxed{S_R = \sum_{n,w\in {\mathbb{Z}}} \mathcal{V}_{\frac{i}{2}\left(\frac{n}{R} + Rw\right)} \otimes \bar{\mathcal{V}}_{\frac{i}{2}\left(\frac{n}{R} - Rw\right)} }\ .
\label{sr}
\end{align}
The correlation functions of the corresponding fields are 
\begin{align}
 \left\langle \prod_{i=1}^N V_{n_i,w_i}(z_i,\bar{z}_i) \right\rangle = \delta_{\sum_{i=1}^N n_i,0}\ \delta_{\sum_{i=1}^N w_i,0}\ \prod_{i<j} (z_i-z_j)^{-2\alpha_i\alpha_j}(\bar{z}_i-\bar{z}_j)^{-2\bar{\alpha}_i\bar{\alpha}_j}\ , 
\end{align}
where we defined
\begin{align}
\renewcommand{\arraystretch}{1.3}
\left\{\begin{array}{l}  \alpha_i = \frac{i}{2}\left(\frac{n_i}{R} + Rw_i \right)\ , \\ \bar{\alpha}_i = \frac{i}{2}\left(\frac{n_i}{R} - Rw_i \right) \ . \end{array}\right. 
\end{align}
The corresponding theory is called the \textbf{\boldmath compactified free boson}\index{compactified free boson} theory, whose parameter $R$ is  the compactification radius.
The integers $n$ and $w$ are respectively called the momentum and winding number.
In the $R\to \infty$ limit, we recover the linear dilaton theory, which in the case $Q=0$ is simply called the (uncompactified) \textbf{\boldmath free boson}\index{free boson} theory. 
The free boson theory, compactified or not, is consistent not only on the sphere, but actually on all Riemann surfaces.
Free bosons are essential building blocks of string theory, which is at the origin of the names for $R$, $n$ and $w$.
The eponymous boson is actually the field $\phi$ such that 
\begin{align}
 J = -\partial \phi \qquad \text{and} \qquad V_\alpha = e^{2\alpha\phi}\ ,
\label{jpf}
\end{align}
where the definition of the exponential of a field involves the normal-ordered product \eqref{abz}. 

More free bosonic theories could be found by relaxing some of our assumptions.
For instance, we made the implicit assumption that both the holomorphic and the antiholomorphic Virasoro fields are built in eq. \eqref{tqz} using the same background charge $Q$, whereas we could have two different background charges $Q$ and $\bar{Q}$.
This would lead to $c\neq \bar{c}$, unless $Q=- \bar{Q}$. 
The case $Q=-\bar{Q}$ is however nothing new, because it is related to the case $Q=\bar{Q}$ by an automorphism of the $\hat{\mathfrak{u}}_1$ algebra,
\begin{align}
 \omega(J_n) = -J_n \ ,
\end{align}
which preserves the Virasoro algebra (assuming $\omega(Q)=-Q$).
This automorphism acts on representations of $\hat{\mathfrak{u}}_1 \times \bar{\hat{\mathfrak{u}}}_1$ as $\omega(\mathcal{V}_\alpha \otimes \bar{\mathcal{V}}_{\bar{\alpha}}) =  \mathcal{V}_{-\alpha} \otimes \bar{\mathcal{V}}_{\bar{\alpha}}$, and on the spectrum of a compactified free boson as 
\begin{align}
 \omega(S_R) = S_{\frac{1}{R}}\ .
\end{align}
This shows that two compactified free bosons are equivalent if their radiuses are inverses of one another.
This simple algebraic observation has important consequences in string theory, where it is called \textbf{\boldmath T-duality}\index{T-duality}. 

Alternatively, we could look for non-unitary free bosonic theories with discrete spectrums.
Relaxing the unitarity assumption allows $Q$ to be nonzero.
Assuming the spectrum is still $S_R$ \eqref{sr}, the condition \eqref{dbdz} is now obeyed provided 
\begin{align}
 iQR\in {\mathbb{Z}} \ .
\end{align}
Actually, this condition allows the term $\frac{Q}{2}$ in $\Delta(\alpha)=\frac{Q^2}{4}-(\alpha-\frac{Q}{2})^2$ to be absorbed in a shift $n\to n-1$, which can be used to show that the theory is consistent not only on the sphere, but also on the torus. 
Therefore, compactified free bosons exist for any value of the central charge, provided the compactification radius is quantized in units of $\frac{i}{Q}=\sqrt{\frac{6}{1-c}}$. 

\subsection{Free bosons and Liouville theory \label{seclld}}

The construction \eqref{tqz} of the energy-momentum tensor $T(z)$ from the $\hat{\mathfrak{u}}_1$ current $J(z)$ can conversely be interpreted as the definition of a locally holomorphic field $J(z)$ from a Virasoro field $T(z)$.
So, in any conformal field theory, there exists a $\hat{\mathfrak{u}}_1$ symmetry algebra, but in general the $\hat{\mathfrak{u}}_1$ symmetry is broken, and $J(z)$ is not a symmetry field.
Nevertheless, we will argue that correlation functions involving $J(z)$ are useful tools for the study and interpretation of Liouville theory. 

Let us discuss the properties of $J(z)$.
The field $J(z)$, being a root of a quadratic differential equation, is in general not a unique, single-valued, meromorphic function of $z$: rather, there can be several determinations of $J(z)$, which can moreover have branch cuts. 
A particular determination of $J(z)$ can be defined by requiring that the 
OPE $JV_\alpha$ \eqref{jva} holds; with this determination, the Seiberg-Witten equations \eqref{swp} and \eqref{swa} then hold.  
(The reflection relation $V_\alpha \propto V_{Q-\alpha}$ \eqref{vrv} would bring us to another particular determination.)
On the other hand, since $J(z)$ is not meromorphic, $\hat{\mathfrak{u}}_1$ Ward identities do not hold in Liouville theory.

Let us introduce notations for dealing with correlation functions involving $J(z)$. 
Given an $N$-point function $\left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle$, we define
\begin{align}
 \boxed{F= \log \left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle} \quad , \quad \boxed{W_1(y) = \frac{\left\langle J(y)\prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle}{\left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle}} \ ,
\end{align}
where $F$ is called the \textbf{\boldmath free energy}\index{free energy}. 
In terms of these objects, the Seiberg-Witten equation \eqref{swp} becomes 
\begin{align}
 {\frac{\partial}{\partial \alpha_i}} F = -2 \int^{z_i} dy \ W_1(y)\ . 
\label{daf}
\end{align}

We will now use these objects for studying Liouville theory in the limit $c\to \infty$ -- equivalently, $Q\to \infty$.
Equations such as \eqref{jyi} suggest $J=O(Q)$ which leads to $\alpha_i=O(Q)$ and $W_1=O(Q)$.
Using eq. \eqref{daf}, we deduce $F=O(Q^2)$.
The natural expansion parameter is $Q^2$ (as in $c=1+6Q^2$) and we write the expansions
\begin{align}
 F &= Q^2 F^{(0)} + F^{(1)} + O(Q^{-2})\ ,
\\
W_1 & = QW_1^{(0)} + O(Q^{-1})\ .
\end{align}
We now observe that in the $Q\to \infty$ limit, the singular term in the $JJ$ OPE \eqref{jj} is negligible.
As a function of $y_1$, the correlation function $ \left\langle J(y_1)J(y_2)\prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle$ is supposed to be determined by the behaviour of the locally holomorphic field $J(y_1)$ near its singularities.
Since there is no singularity at $y_1=y_2$, the dependences on $y_1$ and $y_2$  factorize,    
\begin{align}
 \frac{\left\langle J(y_1)J(y_2)\prod_{i=1}^N V_{\alpha_i}(z_i)\right\rangle}{\left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle} \underset{Q\to \infty}{=} W_1^{(0)}(y_1)W_1^{(0)}(y_2) + O(1)\ .
\end{align}
To the leading order, inserting the definition \eqref{tqz} of $J(z)$ in $\left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle$ therefore yields a nonlinear differential equation for $W_1^{(0)}$,
\begin{align}
 \boxed{\left(W_1^{(0)}\right)^2 + \partial W_1^{(0)} = - t}\ ,
\label{wwwt}
\end{align}
or equivalently a linear differential equation for a function $\psi$,
\begin{align}
 \boxed{W_1^{(0)} = \frac{\partial\psi}{\psi} \quad \Rightarrow \quad (\partial^2 + t ) \psi = 0}\ .
\label{dtp}
\end{align}
In these equations we introduced
\begin{align}
 t(z) = \underset{Q\to \infty}{\lim} Q^{-2} \frac{\left\langle T(z) \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle}{\left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \right\rangle}\ .
\end{align}
This can be computed using eq. \eqref{dtz}, 
\begin{align}
 t(z) = \sum_{i=1}^N \left( \frac{\underset{Q\to\infty}{\lim} Q^{-2}\Delta(\alpha_i)}{(z-z_i)^2} + \frac{\beta_i}{z-z_i} \right)\ ,
\label{tzs}
\end{align}
where we defined the \textbf{\boldmath accessory parameters}\index{accessory parameter} 
\begin{align}
 \beta_i = {\frac{\partial}{\partial z_i}} F^{(0)}\ .
\end{align}
The condition $t(z) \underset{z\to \infty}{=} O(\frac{1}{z^4})$, which follows from eq. \eqref{tyi}, amounts to three constraints on the accessory parameters, which are thereby uniquely determined if $N\leq 3$. 

Let us use these constructions, first of all to provide a geometrical interpretation of Liouville theory.
Let us relax the assumption that $J(z)$ (and therefore $W_1^{(0)}(z)$) be locally holomorphic, and assume there is a function $\phi(z,\bar{z})$ such that 
\begin{align}
 W_1^{(0)} = - \partial \phi \quad , \quad \bar{W}_1^{(0)} = -\bar{\partial} \phi \ .
\end{align}
Taking the $\bar{z}$-derivative of eq. \eqref{wwwt}, we obtain $\partial\left(\log \partial\bar{\partial}\phi -2\phi\right)=0$, and similarly $\bar{\partial} \left(\log \partial\bar{\partial}\phi -2\phi\right)=0$.
We therefore have
\begin{align}
 \partial\bar{\partial}\phi = \mu e^{2\phi}\ ,
\end{align}
where the integration constant $\mu$ coincides with the cosmological constant up to a normalization factor.
This equation for $\phi$ is the \textbf{\boldmath Liouville equation}\index{Liouville equation}, which gives its name to Liouville theory.
This equation is equivalent to the condition that the two-dimensional metric
\begin{align}
 ds^2 = e^{2\phi} dz d\bar{z}\ ,
\end{align}
has a constant scalar curvature.
Since all two-dimensional metrics can be brought to this form by a change of coordinates, Liouville theory can be interpreted as a quantum theory of two-dimensional gravity, whose classical equation of motion is the Liouville equation.

We will now explain how to compute the behaviour of Liouville theory correlation functions in the limit $Q\to \infty$.
Since $\alpha_i=O(Q)$ it is natural to consider the 
\begin{align}
 \textbf{\boldmath heavy\ asymptotic\ limit}\index{heavy\ asymptotic\ limit}: \quad \left\{\begin{array}{l}  Q \to \infty \ ,\\ \eta_i=\frac{\alpha_i}{Q}\ \text{fixed}\ .\end{array}\right.  
\end{align}
We then have $\underset{Q\to\infty}{\lim} Q^{-2}\Delta(\alpha_i)=\eta_i(1-\eta_i)$.
In the case $N=3$, the function $t(z)$ \eqref{tzs} is 
\begin{align}
 t(z) = \frac{1}{\prod_{i=1}^3(z-z_i)} \sum_{i=1}^3 \eta_i(1-\eta_i)\frac{\prod_{j\neq i} z_{ij}}{z-z_i}\ ,
\end{align}
and the linear differential equation \eqref{dtp} is equivalent to the hypergeometric equation.
Solving this equation yields $W_1^{(0)}$, from which we can deduce the leading term $F^{(0)}$ of the free energy $F$, with the help of the heavy asymptotic limit of the Seiberg-Witten equation \eqref{daf}, 
\begin{align}
 {\frac{\partial}{\partial \eta_i}} F^{(0)} = -2\int^{z_i} dy\ W_1^{(0)}(y)\ .
\end{align}
We do not carry out these calculations here, and instead refer the reader to \cite{cer12}, where the result for $F^{(0)}$ is shown to agree with the leading behaviour of the three-point function \eqref{caaa} in the heavy asymptotic limit.
Actually, the agreement does not stop at the leading order: similar techniques can be used for computing the free energy $F$ order by order in $Q^2$ \cite{cer12}.

In the heavy asymptotic limit, conformal dimensions grow as fast as the central charge.
Another interesting limit of Liouville theory can be defined, such that the conformal dimensions are fixed.
This limit is the
\begin{align}
 \textbf{\boldmath light\ asymptotic\ limit}\index{light\ asymptotic\ limit}: \quad \left\{\begin{array}{l}  Q \to \infty \ ,\\ \eta_i=Q\alpha_i\ \text{fixed}\ .\end{array}\right.  
\end{align}
 The Seiberg-Witten equation \eqref{daf} now implies 
\begin{align}
 {\frac{\partial}{\partial \eta_i}} F^{(0)} & = 0 \ ,
\\ 
{\frac{\partial}{\partial \eta_i}} F^{(1)} & = -2\int^{z_i} dy\  W_1^{(0)}(y) \ .
\label{pefo}
\end{align}
The leading term $F^{(0)}$ of $F$ is therefore $\eta_i$-independent.
It is actually also $z_i$-independent, according to the following argument: since $\Delta(\alpha_i)=\eta_i + O(Q^{-2})$, its is natural to assume $t(z)=0$ where $t(z)$ is given by eq. \eqref{tzs}, and this implies $\beta_i={\frac{\partial}{\partial z_i}} F^{(0)}=0$.
So $F^{(0)}$ is not affected by the presence of the fields $V_{\alpha_i}(z_i)$, which are then called light fields.
The first interesting term of $F$ is thus $F^{(1)}$.
To compute $F^{(1)}$, let us solve the linear differential equation \eqref{dtp}, which is now simply $\partial^2 \psi=0$.
The solutions are $\psi(z) = \sigma z + \rho$, where $\sigma$ and $\rho$ are arbitrary parameters.
Using the Seiberg-Witten equation \eqref{pefo}, we obtain
\begin{align}
 e^{F^{(1)}} \propto \prod_{i=1}^N (\sigma z_i + \rho)^{-2\eta_i} \ .
\end{align}
If we want to compute the light asymptotic limit of the actual, single-valued $N$-point function, we have to restore the dependence on $\bar{z}_i$.
To do this, let us consider the real, single-valued solutions of $\partial^2 \psi = \bar{\partial}^2\psi=0$.
We write these solutions as $\psi(z,\bar{z}) = \left[\begin{smallmatrix} z \\ 1 \end{smallmatrix}\right]^\dagger h \left[\begin{smallmatrix} z \\ 1 \end{smallmatrix}\right]$, where $h$ is a constant matrix such that $h=h^\dagger$.
Now how do we choose $h$? Global conformal symmetry \eqref{vtv} suggests that we should integrate over $h$, so that
\begin{align}
\left\langle\prod_{i=1}^N V_{\alpha_i}(z_i,\bar{z}_i)\right\rangle\ \underset{\text{light\ asymptotic\ limit}}{\propto}\ \int_{H^+_3} dh\ \prod_{i=1}^N \left( \left[\begin{smallmatrix} z \\ 1 \end{smallmatrix}\right]^\dagger h \left[\begin{smallmatrix} z \\ 1 \end{smallmatrix}\right] \right)^{-2\eta_i}\ ,
\label{zih}
\end{align}
where the integral is over the set \textbf{\boldmath $H_3^+$}\index{H3+@$H_3^+$} of hermitian matrices of size two and determinant one, with a measure $dh$ which we assume to be invariant under $h\mapsto g^\dagger hg$ for $g\in SL_2({\mathbb{C}})$.
In the case $N=3$, this agrees with the three-point function \eqref{caaa}. (See \cite{zz95}.) In the light asymptotic limit, the spectrum of Liouville theory reduces to the space of functions on $H_3^+$, and the symmetry algebra reduces to the algebra of the global conformal transformations.
So
the light asymptotic limit of Liouville theory is a unitary, two-dimensional global conformal field theory.

To conclude our discussion of the use of free boson techniques in Liouville theory, let us point out 
that there is a relation between certain Liouville correlation functions, and linear dilaton correlation functions \cite{zz95}.
The relevant Liouville correlation functions are $N$-point functions $\left\langle \prod_{i=1}^N V_{\alpha_i}(z_i)\right\rangle^{\text{Liouville}}$ at $\sum\alpha_i = Q-bm$ where $m\in \mathbb{N}$.  
For the Liouville three-point structure constants $C$ and $\hat C$, the limit $\sum\alpha_i = Q-bm$ is similar to the degenerate field limit \eqref{chclc}, in that $\hat C$ is smooth while $C$ has a simple pole, and
\begin{align}
 \lim_{\sum\alpha_i \to Q-bm} \hat C_{\alpha_1,\alpha_2,\alpha_3} 
 \propto \underset{\sum \alpha_i = Q-bm}{\operatorname{Res}}  C_{\alpha_1,\alpha_2,\alpha_3}\ ,
\end{align}
where we neglect $b$-dependent prefactors. 
For $c\notin ]-\infty,1]$, our Liouville $N$-point function still has a simple pole at $\sum\alpha_i = Q-bm$, with the residue
\begin{align}
 \underset{\sum \alpha_i = Q-bm}{\operatorname{Res}} \left\langle \prod_{i=1}^N V_{\alpha_i}(z_i)\right\rangle^{\text{Liouville}} = \underset{\sum\alpha_i = Q-bm}{\operatorname{Res}} \left\langle e^{-\frac{\mu^b}{\pi\gamma(b^2)}\int_{\mathbb{C}} V_b(z)d^2z}\prod_{i=1}^N V_{\alpha_i}(z_i)\right\rangle^{\text{Linear\ Dilaton}}\ .
\label{lild}
\end{align}
On the linear dilaton side, taking the Residue of a correlation function \eqref{dpzz} means stripping out a delta function, and 
\begin{multline}
 \underset{\sum\alpha_i = Q-bm}{\operatorname{Res}} \left\langle e^{-\frac{\mu^b}{\pi\gamma(b^2)}\int_{\mathbb{C}} V_b(z)d^2z}\prod_{i=1}^N V_{\alpha_i}(z_i)\right\rangle^{\text{Linear\ Dilaton}}
\\
= \frac{1}{m!}\left[-\frac{\mu^b}{\pi\gamma(b^2)}\right]^m \prod_{i<j} |z_{ij}|^{-4\alpha_i\alpha_j} \int_{{\mathbb{C}}^m} \prod_{k=1}^m d^2y_k\ \prod_{k,i} |y_k-z_i|^{-4b\alpha_i}\prod_{k<\ell} |y_{k\ell}|^{-4b^2}\ .
\label{mint}
\end{multline}
The relation \eqref{lild} implies that Liouville theory can be viewed as a perturbation of the linear dilaton theory.
This is an example of \textbf{\boldmath conformal perturbation theory}\index{conformal perturbation theory} -- the definition and study of two-dimensional quantum field theories (conformal or not) as perturbed conformal field theories.
The perturbing operator, here $V_b$, is chosen so that its conformal dimension is one, a necessary but not sufficient condition for the perturbed theory to still have conformal symmetry.
This example is rather pathological, as Liouville theory does not have a smooth $\mu\to 0$ limit where we could recover the linear dilaton theory, and the linear dilaton theory does not allow us to compute Liouville theory correlation functions, but only their residues at certain poles. 

The integral \eqref{mint} is called a \textbf{\boldmath Coulomb gas integral}\index{Coulomb gas integral}.
If $N=3$ and $b\notin \mathbb{R}$, the relation \eqref{lild} with Liouville theory shows that the integral can be analytically continued to non-integer values of $m=b^{-1}(Q-\sum\alpha_i)$, using the Liouville structure constant $\hat C$. 
Moreover, Coulomb gas integrals coincides with partition functions of certain matrix models.
This is a manifestation of the
relation between Liouville theory and matrix models:
\begin{align}
 \begin{tabular}{|l|l|}
  \hline
Liouville theory & matrix models
\\
\hline \hline
$N$-point function & partition function 
\\
\hline
$W_1(y)$  & resolvent
\\
\hline
eq. \eqref{wwwt} for $W_1^{(0)}(y)$ & loop equation 
\\
\hline
$y_k$ in eq. \eqref{mint} & matrix eigenvalue
\\
\hline
 \end{tabular}
\end{align}



\section{Nonabelian affine symmetry}

We will now associate an affine Lie algebra $\hat{\mathfrak{g}}$ to any simple Lie algebra $\mathfrak{g}$, in the same way as the  affine Lie algebra $\hat{\mathfrak{u}}_1$ is associated to the abelian Lie algebra $\mathfrak{u}_1$.
We will use the smallest simple Lie algebra $\mathfrak{g}=\mathfrak{sl}_2$ as the main example.

\subsection{Symmetry algebra}

A Lie algebra $\mathfrak{g}$ is defined by generators $\{t^a\}$ and commutation relations 
\begin{align}
 [t^a,t^b] = f^{ab}_c t^c \ ,
\label{ttft}
\end{align}
where structure constants $f^{ab}_c$ are numbers.
The commutation relations are assumed to obey two axioms:
\begin{align}
 \text{antisymmetry} & : \quad [t^a,t^b] + [t^b,t^a] = 0\ ,
\\
\text{Jacobi identities} & : \quad  [t^a,[t^b,t^c]] + [t^b,[t^c,t^a]] + [t^c,[t^a,t^b]] = 0 \ .
\end{align}
For example, we already encountered the Lie algebra $\mathfrak{sl}_2$ \eqref{ttpm} in our study of global conformal symmetry.
Let us define the \textbf{\boldmath Killing form}\index{Killing form} 
\begin{align}
 K^{ab} = \frac{1}{2g} \operatorname{Tr} \left(\operatorname{ad}_{t^a}\operatorname{ad}_{t^b}\right) =\frac{1}{2g} f^{ac}_d f^{bd}_c \overset{\mathfrak{sl}_n}{=}\operatorname{Tr}_f t^at^b\ ,
\end{align}
where  $\operatorname{ad}_t(t') = [t,t']$ is the adjoint action, $f$ is the $n$-dimensional fundamental representation of $\mathfrak{sl}_n$, and $g$ is the dual Coxeter number of the Lie algebra $\mathfrak{g}$, in particular $g\overset{\mathfrak{sl}_n}{=}n$.
The normalization factor $\frac{1}{2g}$ is included so that the level, which we will shortly define in eq. \eqref{jajb}, takes integer values in rational models.
We assume that the Killing form is non-degenerate, which is equivalent to $\mathfrak{g}$ being semi-simple. 
Using the Killing form to raise indices, we define
\begin{align}
 f^{abc} = K^{ad}f_d^{bc} = \frac{1}{2g}\operatorname{Tr}\left( \operatorname{ad}_{t^a} [\operatorname{ad}_{t^b}, \operatorname{ad}_{t^c}] \right)\ ,
\end{align}
whose second expression, which is manifestly totally antisymmetric, follows from the Jacobi identities.
The total antisymmetry of $f^{abc}$ implies that the \textbf{\boldmath quadratic Casimir operator}\index{quadratic Casimir operator}
\begin{align}
 C_2 = K_{ab} t^a t^b \overset{\mathfrak{sl}_2}{=} 2t^0t^0+ t^+t^-+t^-t^+\ ,
\label{ctk}
\end{align}
is a central element of the universal enveloping algebra $U(\mathfrak{g})$, that is $[C_2,t^a]=0$.

After these quick reminders on Lie algebras, we are ready to build conformal field theories based on a Lie algebra $\mathfrak{g}$. 
We introduce a number $\dim \mathfrak{g}$ of holomorphic \textbf{\boldmath $\hat{\mathfrak{g}}$ currents}\index{g currents@$\hat{\mathfrak{g}}$ current} $J^a(y)$ characterized by the OPEs 
\begin{align}
 \boxed{ J^a(y) J^b(z) = \frac{k K^{ab}}{(y-z)^2} +  \frac{ f^{ab}_c J^c(z)}{y-z}  + O(1)} \ ,
\label{jajb}
\end{align}
where the parameter $k$ is called the \textbf{level}\index{level (affine Lie algebra)}. (This parameter did not appear in the OPE \eqref{jj} of the $\hat{\mathfrak{u}}_1$ current $J$ with itself, as it could be absorbed in a rescaling of $J$.) For example, the OPEs of $\widehat{\mathfrak{sl}}_2$ currents are
\begin{align}
\begin{array}{ll}
  J^0(y)J^0(z) = \frac{\frac{k}{2}}{(y-z)^2} + O(1)\ ,  & J^0(y)J^\pm(z) = \frac{\pm J^\pm(z)}{y-z} + O(1)\ ,
\\
 J^\pm(y)J^\pm(z) = O(1) \ , & J^+(y)J^-(z) = \frac{k}{(y-z)^2} + \frac{2J^0(z)}{y-z} + O(1)\ .
\end{array}
\label{jjjj}
\end{align}
Let us now introduce the \textbf{\boldmath Sugawara construction}\index{Sugawara construction} of a field $T$ as a quadratic combination of $\hat{\mathfrak{g}}$ currents,
\begin{align}
\boxed{ T =  \frac{ K_{ab} (J^aJ^b)}{2(k+g)} } \ .
\label{tjj} 
\end{align}
Then $T$ is a Virasoro field with the central charge 
\begin{align}
 \boxed{ c = \frac{ k \dim \mathfrak{g}}{k+g} }\ ,
\label{ckg}
\end{align}
such that $J^a$ is a primary field of conformal dimension one, 
\begin{align}
\boxed{ T(y)J^a(z) = {\frac{\partial}{\partial z}} \frac{1}{y-z} J^a(z) + O(1)} \ .
\label{tja}
\end{align}
(See Exercise \ref{exosug}.)
We may be tempted to generalize $T$ to $\hat{T} = T + Q_a\partial J^a$, in analogy with the case of the free boson \eqref{tqz}. 
But then $\hat{T}$ would not be Virasoro field, unless we would relax our assumption that $\mathfrak{g}$ be semi-simple. (See Exercise \ref{exotqpj}.)

We do not repeat the definition \eqref{jvn} of the modes $J^a_n$ of $J^a$.
These modes obey the commutation relations
\begin{align}
 \boxed{[J^a_m,J^b_n] =   f^{ab}_c J^c_{m+n} +kmK^{ab}\ \delta_{m+n,0}} \ , 
\label{jam}
\end{align}
which define the \textbf{\boldmath affine Lie algebra}\index{affine Lie algebra} $\hat{\mathfrak{g}}$. 
The $T(y)J^a(z)$ OPE \eqref{tja} is equivalent to
\begin{align}
 [L_m,J^a_n] = -nJ^a_{m+n}\ ,
\end{align}
and the Sugawara construction \eqref{tjj} is equivalent to 
\begin{align}
 L_n &= \frac{K_{ab}}{2(k+g)} \sum_{m\in{\mathbb{Z}}} J^a_{n-m}J^b_m\ , \qquad (n\neq 0)\ ,
\label{ljj}
\\
L_0 & = \frac{K_{ab}}{2(k+g)}\left(2\sum_{m=1}^\infty J^a_{-m}J^b_m + J^a_0J^b_0\right)\ .
\label{lzjj}
\end{align}

\subsection{Fields, representations and fusion rules}
 
Given a representation $R$ of $\mathfrak{g}$, we define an \textbf{\boldmath affine primary field}\index{affine primary field} $\Phi^{R}(z_0,\bar{z}_0)$ by its OPE with $J^a(y)$,
\begin{align}
 \boxed{ J^a(y) \Phi^{R}(z_0) = \frac{-t^a\Phi^{R}(z_0)}{y-z_0} + O(1) } \ .
\label{jpr}
\end{align}
This assumes that for any $z_0$, the field $\Phi^{R}(z_0)$ is a vector in the representation $R$. (This could be made more explicit by introducing  a basis $(e^i)$ of $R$, such that $\Phi^{R}(z_0) = \Phi^{R}_i(z_0)e^i$ and $t^a \Phi^{R}(z_0) = R(t^a)_i^j \Phi^{R}_j(z_0)e^i$.) 
It can be checked that the $J^a\Phi^R$ OPE is compatible with the associativity of the $J^aJ^b\Phi^R$ OPE. (See Exercise \ref{exojjp}.)
An affine primary field is also a primary field with the conformal dimension 
\begin{align}
 \boxed{\Delta_R  = \frac{C_2(R)}{2(k+g)}}\ ,
\label{dr}
\end{align}
where $C_2(R)$ is the eigenvalue of the quadratic Casimir operator $C_2$ \eqref{ctk} when acting in the representation $R$. (We now assume $R$ to be indecomposable, so that it contains only one eigenspace of $C_2$.) Furthermore, $L_{-1}$ acts on the affine primary field $\Phi^R$ as 
\begin{align}
L_{-1}\Phi^R = -\frac{K_{ab}t^a(J^b\Phi^R)}{k+g} \ .
\label{lmp}
\end{align}
(See Exercise \ref{exoapf}.)

States in a representation $R$ of $\mathfrak{g}$ can be represented as functions of an \textbf{\boldmath isospin variable}\index{isospin variable} $X$. 
Affine primary fields become functions $\Phi^R_X(z_0)$ of $X$, on which $t^a$ acts as a differential operator $D_X^R(t^a)$, 
and we have
\begin{align}
 J^a(y)\Phi^R_X(z_0) = \frac{-D^R_X(t^a)\Phi^R_X(z_0)}{y-z_0}+O(1)\quad \text{with} \quad t^a \Phi^R_X(z_0) = D_X^R(t^a) \Phi^R_X(z_0)\ .
\label{jprx}
\end{align}
The differential operators $D_X^R(t^a)$ obey the commutation relations of $\mathfrak{g}$, and their quadratic invariant combination is $C_2(R)$,
\begin{align}
[D_X^R(t^a),D_X^R(t^b)] = f^{ab}_c D_X^R(t^c)\ , \qquad K_{ab} D_X^R(t^a)D_X^R(t^b) = C_2(R)\ .
\label{dta}
\end{align}
The isospin variable $X$ is a collection of as many complex variables as $\mathfrak{g}$ has positive roots.
In particular, an $\mathfrak{g}=\mathfrak{sl}_n$ isospin variable has $\frac{n(n-1)}{2}$ components, and an $\mathfrak{g}=\mathfrak{sl}_2$ isospin variable has one component.
We already know differential operators $D^j_x(t^a)$ \eqref{ddz} which 
obey the $\mathfrak{sl}_2$ commutation relations \eqref{ttpm} for any choice of the 
\textbf{\boldmath spin}\index{spin ($\mathfrak{sl}_2$)} $j$.
The eigenvalue of the quadratic Casimir operator in the corresponding representation of $\mathfrak{sl}_2$ is
\begin{align}
 C_2(j) =  K_{ab}D_x^j(t^a)D_x^j(t^b) = 2j(j+1)\ ,
\end{align}
and the conformal dimension of the corresponding field is
\begin{align}
 \Delta_j =\frac{j(j+1)}{k+2}\ .
\label{dj}
\end{align}
Another triplet of $\mathfrak{sl}_2$ differential operators is given by 
\begin{align}
\renewcommand{\arraystretch}{1.3}
\left\{\begin{array}{l}  
 D_\mu^j(t^-) = -\mu \ , \\  D_\mu^j(t^0) = -\mu{\frac{\partial}{\partial \mu}} \ , \\ D_\mu^j(t^+) = \mu\frac{\partial^2}{\partial\mu^2} -\frac{j(j+1)}{\mu}\ . \end{array}\right. 
\label{mub}
\end{align}
The \textbf{\boldmath $x$-basis field}\index{x-basis field@$x$-basis field} $\Phi^j_x(z_0)$ and \textbf{\boldmath $\mu$-basis field}\index{mu-basis field@$\mu$-basis field} $\Phi^j_\mu(z_0)$ are related by the formal Fourier transform
\begin{align}
 \Phi_x^j(z_0) = \int d\mu\ \mu^{-j-1}e^{\mu x} \Phi_\mu^j(z_0)\ .
\label{emx}
\end{align}
The $\widehat{\mathfrak{sl}}_2$ currents and primary fields can be represented in terms of free fields, in the same way as the Virasoro algebra and primary fields were represented in terms of the $\hat{\mathfrak{u}}_1$ current in Section \ref{secaua}.
This \textbf{Wakimoto free-field representation of $\widehat{\mathfrak{sl}}_2$}\index{Wakimoto free-field representation of $\widehat{\mathfrak{sl}}_2$} is described in Exercise \ref{exowaki}.

Let us now consider the states $|v^R\rangle$ which correspond to the $R$-valued field $\Phi^R(z_0)$ by the state-field correspondence.
The definition \eqref{jpr} of $\Phi^R(z_0)$ is equivalent to 
\begin{align}
\renewcommand{\arraystretch}{1.3}
 \left\{\begin{array}{l}  J^a_{n>0}|v^R\rangle = 0 \ ,  \\ J^a_0|v^R\rangle = -t^a |v^R\rangle\ . \end{array}\right. 
\end{align}
The states $|v^R\rangle$ are killed by the annihilation operators, and are called affine primary states.
They transform in the representation $R$ of the \textbf{\boldmath horizontal subalgebra}\index{horizontal subalgebra} $\mathfrak{g}\subset \hat{\mathfrak{g}}$ generated by $\{J^a_0\}$.
Acting on the affine primary states with creation operators $J^a_{n<0}$ generates affine descendent states, which form an \textbf{\boldmath affine highest-weight representation}\index{affine highest-weight representation} $\hat{R}$ of the affine Lie algebra $\hat{\mathfrak{g}}$.

Let us study the fusion rules of affine highest-weight representations, equivalently the OPEs of affine primary fields.
To write such OPEs, we will omit the dependences on the positions $z_i$ of the fields, which are dictated by conformal symmetry since affine primary fields are also primary fields.
We will also omit the affine descendent fields because, as in the cases of the Virasoro and $\hat{\mathfrak{u}}_1$ algebras, the contributions of affine descendent fields are determined by the contributions of the affine primary fields. (This would however not be true in the case of a $W$ algebra.) So we write a generic OPE as 
\begin{align}
 \Phi^{R_1}_{X_1}\Phi^{R_2}_{X_2} \sim \sum_{R_3} \int dX_3\ C^{R_1,R_2}_{R_3}(X_1,X_2|X_3)\ \Phi^{R_3}_{X_3}\ .
\end{align}
Inserting $\oint dz\ J^a(z)$ on both sides, and using the linear independence of the operators $\Phi^{R_3}_{X_3}$, we obtain an equation for the structure function $C^{R_1,R_2}_{R_3}(X_1,X_2|X_3)$,
\begin{align}
 \left(D_{X_1}^{R_1}(t^a)+D_{X_2}^{R_2}(t^a)-\left(D_{X_3}^{R_3}(t^a)\right)^\dagger\right) C^{R_1,R_2}_{R_3}(X_1,X_2|X_3) = 0\ ,
\label{dddc}
\end{align}
where the dagger denotes the hermitian conjugate for $X_3$-differential operators, such that for any functions $f,g$ we have 
$\int fDg =\int g D^\dagger f$.
This equation characterizes $C^{R_1,R_2}_{R_3}(X_1,X_2|X_3)$ as an intertwiner between the representations $R_1\otimes R_2$ and $R_3$ of the Lie algebra $\mathfrak{g}$.
This shows that the fusion multiplicities of affine highest-weight representations of $\hat{\mathfrak{g}}$ are bounded by the tensor product multiplicities of the underlying representations of $\mathfrak{g}$, 
\begin{align}
 m_{\hat{R}_1,\hat{R}_2}^{\hat{R}_3} \leq m_{R_1,R_2}^{R_3}\ .
\end{align}
The presence of null vectors in the representations $\hat{R}_i$ can lead to extra conditions on the structure function $C^{R_1,R_2}_{R_3}(X_1,X_2|X_3)$, in which case $m_{\hat{R}_1,\hat{R}_2}^{\hat{R}_3} < m_{R_1,R_2}^{R_3}$. 
And nothing guarantees that only highest-weight representations appear in the fusion product of two highest-weight representations. 
In the case of the $\widetilde{SL}_2(\mathbb{R})$ WZW model, other types of representations do appear. (See Section \ref{secslr}.) 

Finally, let us point out that the maximum multiplicity $m_{R_1,R_2}^{R_3}$ in a fusion rule -- that is, the number of linearly independent solutions of eq. \eqref{dddc} in the absence of further constraints, is 
\begin{align}
 m_{\mathrm{max}} = \left\{\begin{array}{l}  2 \quad \text{if}\ \mathfrak{g}=\mathfrak{sl}_2\ , \\ \infty \quad \text{if}\ \mathfrak{g}=\mathfrak{sl}_{n\geq 3}\ . \end{array}\right. 
\end{align}
We indeed have a set of $\dim \mathfrak{sl}_n=n^2-1$ equations, for a function $C^{R_1,R_2}_{R_3}(X_1,X_2|X_3)$ of $3\frac{n(n-1)}{2}$ variables -- the components of $X_1,X_2$ and $X_3$.
If $n=2$ there are three equations and three variables, and this can actually be reduced to one second-order differential equation for a function of one variable. (See eq. \eqref{pmf}.)
If $n\geq 3$ there are more variables than equations, so that $C^{R_1,R_2}_{R_3}(X_1,X_2|X_3)$ has an arbitrary dependence on a number of variables.
In the case of finite-dimensional representations of $\mathfrak{sl}_{n\geq 3}$, the multiplicities are of course finite, but they can take arbitrarily high values, depending on the involved representations.

\subsection{Ward identities and Knizhnik-Zamolodchikov equations \label{secwikz}}

Let us study the $\hat{\mathfrak{g}}$ Ward identities for correlation functions.
To do this, we need to know how the $\hat{\mathfrak{g}}$ currents $J^a(y)$ behave as $y\to \infty$.
The relation \eqref{tjj} with the energy-momentum tensor $T(y)$, and the behaviour \eqref{tyi} of $T(y)$, suggest
\begin{align}
 \boxed{J^a(y) \underset{y\to \infty}{=} O\left(\frac{1}{y^2}\right)}\ .
\label{jayi}
\end{align}
For any meromorphic function $\epsilon(z)$, with no poles outside $\{z_1,\cdots z_N\}$, we have 
\begin{align}
 \oint_\infty dy\ \epsilon(y) \left\langle J^a(y)  \prod_{i=1}^N \Phi^{\sigma_i}(z_i)\right\rangle = 0 \quad \text{provided} \quad \epsilon(y) \underset{y\to\infty}{=} O(1)\ ,
\end{align}
In the case $\epsilon(y)=1$, we obtain the $\hat{\mathfrak{g}}$ global Ward identities,
\begin{align}
 \left\langle \sum_{i=1}^N (J_0^a)^{(z_i)} \prod_{i=1}^N \Phi^{\sigma_i}(z_i)\right\rangle=0\ .
\end{align}
In the case $\epsilon(y)=\frac{1}{(y-z_i)^n}$ with $n\geq 1$, we obtain the $\hat{\mathfrak{g}}$ local Ward identities, which are formally identical to the $\hat{\mathfrak{u}}_1$ local Ward identities \eqref{jnjp}. 

Let us specialize to correlation functions involving affine primary fields.
Knowing the poles \eqref{jpr} of $J^a(y)$ and its behaviour near $y=\infty$, we have
\begin{align}
 \left\langle J^a(y) \prod_{i=1}^N \Phi^{R_i}_{X_i}(z_i)\right\rangle = - \sum_{i=1}^N \frac{D^{R_i}_{X_i}(t^a)}{y-z_i}\left\langle \prod_{i=1}^N \Phi^{R_i}_{X_i}(z_i)\right\rangle\ .
\label{dja}
\end{align}
In the case of an $N$-point function where the fields with indices $j\neq i$ are affine primaries, the local Ward identities become
\begin{align}
\left\langle\left(J^a_{-n}\right)^{(z_i)}\Phi^{\sigma_i}(z_i)\prod_{j\neq i} \Phi^{R_j}_{X_j}(z_j)\right\rangle &=\sum_{j\neq i} \frac{D_{X_j}^{R_j}(t^a)}{(z_j-z_i)^n} \left\langle \Phi^{\sigma_i}(z_i)\prod_{j\neq i} \Phi^{R_j}_{X_j}(z_j)\right\rangle\ . 
\label{jmnz}
\end{align}
In the case of an $N$-point function of affine primary fields, the global Ward identities become
\begin{align}
 \sum_{i=1}^N D_{X_i}^{R_i}(t^a)\ \left\langle \prod_{i=1}^N \Phi^{R_i}_{X_i}(z_i)\right\rangle   = 0 \ .
\label{drxt}
\end{align}
For example, let us solve the $\mathfrak{sl}_2$ global Ward identities for a three-point function.
In the $x$-basis, these identities are formally identical to the global Ward identities \eqref{spz}, whose solution is eq. \eqref{fzzz}.
We thus find
\begin{align}
 \left\langle \prod_{i=1}^3 \Phi^{j_i}_{x_i} \right\rangle \propto\ x_{12}^{j_1+j_2-j_3} x_{23}^{j_2+j_3-j_1} x_{31}^{j_3+j_1-j_2}\ ,
\label{xxx}
\end{align}
where we omitted the dependence on $z_i$.
In the $\mu$-basis, we find 
\begin{align}
 \left\langle \prod_{i=1}^3\Phi^{j_i}_{\mu_i}\right\rangle \propto\ \mu_2\delta(\mu_1+\mu_2+\mu_3)\ \mathcal{H}\left(-\frac{\mu_1}{\mu_2}\right)\ ,
\label{pmf}
\end{align}
where the function $\mathcal{H}(x)$, which parametrizes the general solution of the $t^-$ and $t^0$ equations, is constrained by the $t^+$ equation to obey the twisted hypergeometric differential equation \eqref{hj}.
It may seem strange that in the $\mu$-basis we obtain a second-order differential equation, whereas in the $x$-basis the solution appeared to be unique.
The number of solutions of the global Ward identities has the algebraic interpretation of a tensor product multiplicity for $\mathfrak{sl}_2$ representations, and this should not depend on our choice of isospin variable.
Actually it is the $x$-basis calculation which is misleading: analyticity conditions on the $x_i$-dependence of $\left\langle \prod_{i=1}^3 \Phi^{j_i}_{x_i} \right\rangle$ in general allow the existence of two solutions which differ globally, although they are locally identical \cite{rib09}.
The tensor product multiplicity for generic $\mathfrak{sl}_2$ representations is two, as correctly suggested by the $\mu$-basis calculation. 

Let us now assume that the Virasoro field, which we defined by the Sugawara construction \eqref{tjj}, is actually the energy-momentum tensor, so that eq. \eqref{lvpv} is obeyed.
Inserting the equation \eqref{lmp} in an $N$-point function of affine primary fields, and applying the local Ward identity \eqref{jmnz} to $J^b_{-1}\Phi^R_X = (J^b\Phi^R_X)$, we obtain the Knizhnik-Zamolodchikov equations or \textbf{\boldmath KZ equations}\index{KZ equations},
\begin{align}
 \boxed{\left\{(k+g){\frac{\partial}{\partial z_i}} + \sum_{j\neq i} \frac{K_{ab}D_{X_i}^{R_i}(t^a)D_{X_j}^{R_j}(t^b)}{z_i-z_j}\right\}\left\langle \prod_{i=1}^N \Phi^{R_i}_{X_i}(z_i)\right\rangle  = 0}\ .
\label{kz} 
\end{align}
These are first-order differential equations in $z_i$, and like the analogous equations \eqref{kzl} for free boson correlation functions, they determine the dependence on $z_i$ of correlation functions of primary fields.
However, unlike the free boson equations, the KZ equations do not have simple solutions in general. 
It can be checked that the KZ equations imply the conformal global Ward identities. (See Exercise \ref{exokz}.)

The KZ equations can be rewritten as 
\begin{align}
 \left\{(k+g){\frac{\partial}{\partial z_i}} + H_i \right\}\left\langle \prod_{i=1}^N \Phi^{R_i}_{X_i}(z_i)\right\rangle   = 0 \ ,
\label{phz}
\end{align}
where $H_i$ are the mutually commuting Gaudin Hamiltonians, the Hamiltonians of the \textbf{\boldmath Gaudin model}\index{Gaudin model} -- an integrable model associated to the Lie algebra $\mathfrak{g}$.
Techniques developed for studying the $\mathfrak{g}$ Gaudin model can be useful for solving the $\mathfrak{g}$ KZ equations, as we will now see in the case $\mathfrak{g} = \mathfrak{sl}_2$. 


\subsection{\texorpdfstring{$\mathfrak{sl}_2$}{sl2} case: the KZ-BPZ relation} 

We will now show that the $\mathfrak{sl}_2$ KZ equations are equivalent to certain BPZ equations via Sklynanin's separation of variables for the $\mathfrak{sl}_2$ Gaudin model. 

Our derivation of the KZ equations amounted to inserting the Sugawara construction \eqref{tjj}  at the points $z_i$ in the $N$-point function $\left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle $ of affine primary fields.
Inserting the Sugawara construction at an arbitrary point $y$ instead, we obtain the identity
\begin{align}
 \left\langle \left(T(y)  - \frac{1}{2(k+2)}\left[ 2(J^0J^0)(y)+(J^+J^-)(y)+(J^-J^+)(y)\right]\right) \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle = 0\ .
\label{tmjj}
\end{align}
According to eqs. \eqref{dtz} and \eqref{dja}, inserting the fields $T(y)$ and $J^a(y)$ amounts to acting with the differential operators 
\begin{align}
 \hat{T}(y) &= \sum_{i=1}^N \left(\frac{\Delta_{j_i}}{(z-z_i)^2} + \frac{1}{z-z_i}{\frac{\partial}{\partial z_i}}\right)\ ,
\label{tcy}
\\
 \hat{J}^a(y) &= - \sum_{i=1}^N \frac{D^{R_i}_{X_i}(t^a)}{y-z_i}\ ,
\label{jay}
\end{align}
where $\Delta_j$ is defined in eq. \eqref{dj}.
These differential operators obey the commutation relations
\begin{align}
 \left[\hat{T}(y),\hat{J}^a(z)\right] &= {\frac{\partial}{\partial z}} \frac{\hat{J}^a(y)-\hat{J}^a(z)}{y-z}\ ,
\label{dtd}
\\
 \left[ \hat{J}^a(y),\hat{J}^b(z)\right] &= f^{ab}_c \frac{\hat{J}^c(y)-\hat{J}^c(z)}{y-z}\ ,
\label{ddd}
\end{align}
where $f^{ab}_c$ are the structure constants of the Lie algebra $\mathfrak{sl}_2$, as encoded in the commutation relations \eqref{ttpm}.
And one can easily show that inserting a normal-ordered product, for instance $(J^-J^+)(y)$, amounts to acting with the product of the corresponding differential operators.
Therefore, the identity \eqref{tmjj} amounts to the differential equation
\begin{align}
 \left(\hat{T}(y) -\frac{1}{2(k+2)}\left[ 2\hat{J}^0(y)\hat{J}^0(y) +\hat{J}^+(y)\hat{J}^-(y)+\hat{J}^-(y)\hat{J}^+(y)\right]\right) \left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle=0\ .
\end{align}
The idea is to simplify this identity by taking $y$ to be one of the zeros $\hat{y}_j$ of $ \hat{J}^-(y)$.
These zeros are differential operators, and the value of a $y$-dependent differential operator $\hat{O}(y)$ at $y=\hat{y}_j$ is defined by inserting $\hat{y}_j$ from the left, that is $ \hat{O}(\hat{y}_j) = \frac{1}{2\pi i}\oint_{\hat{y}_j} \frac{dy}{y-\hat{y}_j} \hat{O}(y) $.
Using eq. \eqref{ddd} for bringing the $\hat{J}^-(y)$ factors to the left, we obtain
\begin{align}
 \left( \hat{T}(\hat{y}_j) -\frac{1}{k+2}\left[(\hat{J}^0)^2(\hat{y}_j) + \partial \hat{J}^0(\hat{y}_j)\right] \right)  \left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle= 0 \ .
\label{jjpj}
\end{align}
Let us further study the differential operators $\hat{y}_j$ and $\hat{J}^0(\hat{y}_j)$.
According to eq. \eqref{ddd}, we have $[\hat{J}^-(y),\hat{J}^-(z)]=0$.
Therefore $[\hat{y}_j,\hat{y}_k]=0$, and
\begin{align}
 \boxed{\hat{J}^-(y)  = \hat{Y}_2 \frac{\prod_{j}(y-\hat{y}_j)}{\prod_i(y-z_i)}}\ ,
\label{djm}
\end{align}
where $\hat{Y}_2$ is a differential operator such that $[\hat{Y}_2,\hat{y}_j]=0$.
Using eq. \eqref{ddd} we find $[\hat{J}^0(\hat{y}_j),\hat{J}^-(z)] = \frac{\hat{J}^-(z)}{\hat{y}_j-z}$, and deduce
\begin{align}
 [\hat{p}_j,\hat{Y}_2]=0 \quad \text{and} \quad [\hat{p}_j,\hat{y}_k]=\delta_{j,k} \quad \text{where} \quad \hat{p}_j = \hat{J}^0(\hat{y}_j)\ .
\label{pyd}
\end{align}
We can now simplify the second term of eq. \eqref{jjpj},
\begin{multline}
 (\hat{J}^0)^2(\hat{y}_j) + \partial \hat{J}^0(\hat{y}_j) = \frac{1}{2\pi i} \oint_{\hat{y}_j} \frac{dy}{y-\hat{y}_j}\left(\hat{J}^0(y) +{\frac{\partial}{\partial y}} \right) \hat{J}^0(y) \\
 = \frac{1}{2\pi i} \oint_{\hat{y}_j} \frac{dy}{y-\hat{y}_j}\left(\hat{p}_j +{\frac{\partial}{\partial y}} \right) \hat{J}^0(y)
 = \hat{p}_j \frac{1}{2\pi i} \oint_{\hat{y}_j} \frac{dy}{y-\hat{y}_j} \hat{J}^0(y) = \hat{p}_j^2\ .
\end{multline}
So eq. \eqref{jjpj} becomes 
\begin{align}
 \boxed{\left(\frac{1}{k+2}\hat{p}_j^2 -\hat{T}(\hat{y}_j)\right) \left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle= 0 }\ .
\label{ppdz}
\end{align}
We have therefore replaced the differential operators $D^{R_i}_{X_i}(t^a)$, which appeared in $\hat{J}^a(y)$ eq. \eqref{jay}, with the operators $\hat{y}_j$ and $\hat{p}_j$.
Therefore, it is natural to introduce the
\textbf{\boldmath Sklyanin variables}\index{Sklyanin variable} $y_j$ as the eigenvalues of the mutually commuting operators $\hat{y}_j$. 
But how many Sklyanin variables do we have? 
The $\widehat{\mathfrak{sl}}_2$ global Ward identity \eqref{drxt} associated to the current $J^a$ can be written as 
\begin{align}
 \underset{y\to \infty}{\lim} y \hat{J}^a(y) \left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle = 0\ .
\end{align}
When combined with the definition \eqref{djm} of $\hat{y}_j$, the identity associated to $J^-$ suggests that we have $N-2$ Sklyanin variables $y_j$.
Let us define two more variables as the eigenvalues $Y_1$ and $Y_2$ of the operators $\hat{Y}_1$ and $\hat{Y}_2$, where we define
\begin{align}
 \hat{Y}_1 = \underset{y\to \infty}{\lim} y \hat{J}^-(y)\ .
\end{align}
We can now define Sklyanin's \textbf{\boldmath separation of variables}\index{separation of variables} for the $\mathfrak{sl}_2$ Gaudin model as the linear 
map $\mathcal{K}$ from functions of $(X_1,\cdots X_N)$ to functions of $(Y_1,Y_2,y_1,\cdots y_{N-2})$, which diagonalizes the operators $(\hat{Y}_1,\hat{Y}_2,\hat{y}_1,\cdots \hat{y}_{N-2})$, so that in particular $\mathcal{K} \hat{y}_j f(X_1,\cdots X_N) = y_j \mathcal{K} f(X_1,\cdots X_N)$.
We actually only define this map on 
functions which obey the global Ward identity associated with $J^-$ i.e.
which are killed by $\hat{Y}_1$, whose images therefore have a $\delta(Y_1)$ prefactor.
Using in addition the global Ward identity associated to $J^0$, we find that the combined dependence of $\mathcal{K}\left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle$ on $Y_1$ and $Y_2$ is a $\delta(Y_1)Y_2$ prefactor.
(This is done with the help of eq. \eqref{ddd}, which implies $[\underset{y\to \infty}{\lim} y \hat{J}^0(y),\hat{J}^-(z)]=-\hat{J}^-(z)$.)

Let us rewrite our equation \eqref{ppdz} in terms of Sklyanin variables.
Using eq. \eqref{pyd}, we find
$\mathcal{K} \hat{p}_j \mathcal{K}^{-1}= {\frac{\partial}{\partial y_j}} $.
Therefore,  
eq. \eqref{ppdz} is equivalent to the following equation for $\mathcal{K}\left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle$,
\begin{align}
 \left(\frac{1}{k+2}\frac{\partial ^2}{\partial y_j^2} - \mathcal{K} \hat{T}(\hat{y}_j) \mathcal{K}^{-1}\right)\mathcal{K}\left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle  = 0\ .
\label{pkkz}
\end{align}
This equation apparently only involves $y_j$ for a given index $j$, whereas each KZ equation involves $(X_1,\cdots X_N)$. 
So it may seem that using Sklyanin variables leads to a separation of variables no only in the Gaudin model, but also
in the KZ equations. 
This is however not true, because the differential operator $\hat{T}(y)$ \eqref{tcy} involves $z_i$-derivatives at fixed isospin variables $X_i$.
When writing $\mathcal{K} \hat{T}(\hat{y}_j) \mathcal{K}^{-1}$, we have to use $z_i$-derivatives at fixed Sklyanin variables $y_k$, and we find
\begin{align}
\mathcal{K} \hat{T}(\hat{y}_j) \mathcal{K}^{-1} = \sum_i\left[\frac{\Delta_{j_i}}{(y_j-z_i)^2}+ \frac{1}{y_j-z_i}\left({\frac{\partial}{\partial z_i}}+{\frac{\partial}{\partial y_j}}\right)\right]-\sum_{k\neq j}\frac{1}{y_{jk}}\left({\frac{\partial}{\partial y_j}}-{\frac{\partial}{\partial y_k}}\right)\ .
\label{dtyj}
\end{align}
(See Exercise \ref{exoktk}.) 
Introducing the function
\begin{align}
 \Theta = \frac{\prod_{i<i'}(z_i-z_{i'})\prod_{j<j'}(y_j-y_{j'})}{\prod_{i,j}(z_i-y_j)}\ ,
\end{align}
the equation \eqref{pkkz} is equivalent to 
\begin{multline}
 \left\{\frac{1}{k+2}  \frac{\partial^2}{\partial y_j^2} - \sum_i\frac{1}{y_j-z_i}{\frac{\partial}{\partial z_i}} -\sum_{k\neq j}\frac{1}{y_j-y_k} {\frac{\partial}{\partial y_k}}
\right. \\ \left.
 -\sum_i\frac{\Delta_{j_i}-\frac{k}{4}}{(y_j-z_i)^2}  -\sum_{k\neq j}\frac{\frac{3k}{4}+1}{(y_j-y_k)^2}   \right\} \Theta^{\frac{k+2}{2}}\mathcal{K}\left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle = 0\ .
\end{multline}
As an equation for $\Theta^{\frac{k+2}{2}}\mathcal{K}\left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle$,
this coincides with the BPZ equation \eqref{pvot} for the correlation function of $\left\langle \prod_{i=1}^N V_{\alpha_i}(z_i) \prod_{j=1}^{N-2}V_{\langle 2,1\rangle}(y_j)\right\rangle$, provided the parameter $b$ of the Virasoro algebra is given by 
\begin{align}
 \boxed{ b^2 = -k-2}\ ,
\label{bk}
\end{align}
and the momentums $\alpha_i$ are given in terms of the spins $j_i$ by 
\begin{align}
 \boxed{\alpha = -b^{-1}j+\frac{b}{2}}\quad \Rightarrow \quad \boxed{\Delta(\alpha(j)) = \Delta_j-\frac{k}{4}}\ ,
\label{aj}
\end{align}
where $\Delta(\alpha)$ is given by eq. \eqref{daq}.
The BPZ equations only constrain the dependence on $y_j$, but we already determined the dependence of  
$\mathcal{K}\left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i}(z_i)\right\rangle$ on the variables $Y_1$ and $Y_2$.
This leads to Feigin, Frenkel and Stoyanovsky's \textbf{\boldmath KZ-BPZ relation}\index{KZ-BPZ relation},
\begin{align}
 \boxed{ \mathcal{K}\left\langle \prod_{i=1}^N \Phi^{j_i}_{X_i,\bar{X}_i}(z_i,\bar{z}_i)\right\rangle = \delta^{(2)}(Y_1) |Y_2|^2 |\Theta|^{b^2} \left\langle \prod_{i=1}^N V_{\alpha_i}(z_i,\bar{z}_i)\prod_{j=1}^{N-2}V_{\langle 2,1\rangle}(y_j,\bar{y}_j)\right\rangle}\ .
\label{dyy}
\end{align}
This equation means that the differential equations obeyed by both sides are related by Sklyanin's separation of variables. 
Solutions of the KZ equations, which are called \textbf{\boldmath $\widehat{\mathfrak{sl}}_2$ conformal blocks}\index{sl2hat conformal blocks@$\widehat{\mathfrak{sl}}_2$ conformal block}, are therefore related to certain Virasoro $2N-2$-point conformal blocks. 
In the diagrammatic representation of conformal blocks as trees, the relevant Virasoro block is obtained from an $\widehat{\mathfrak{sl}}_2$ conformal block by adding a degenerate field near each node, and identifying the two fusion channels of that degenerate field with $\widehat{\mathfrak{sl}}_2$ fusion multiplicities:
\begin{align}
\begin{tikzpicture}[baseline={(0,0)}, very thick, scale = .6]
\draw (-1,2) node [left] {$j_1$} -- (0,0) node[below right] {$\epsilon$} -- node [above] {$j_s$} (4,0) node[below left] {$\sigma$} -- (5,2) node [right] {$j_4$};
\draw (-1,-2) node [left] {$j_2$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$j_3$};
\end{tikzpicture}
\quad \rightarrow \quad  
\begin{tikzpicture}[baseline={(0,0)}, very thick, scale = .6]
\draw (-1,2) node [left] {$\alpha(j_1)$} -- (0,0) -- (1,0) -- node [above] {$\alpha(j_s)$} (5,0) -- (6.3,2.6) node [right] {$\alpha(j_4)$};
\draw (-1,-2) node [left] {$\alpha(j_2)$} -- (0,0);
\draw (5,0) -- (6,-2) node [right] {$\alpha(j_3)$};
\draw[dashed] (1,0) -- (1,2.2) node[above] {$\left<2,1\right>$};
\draw[dashed] (5.3, .6) -- (4.3, 2.6) node[above] {$\left<2,1\right>$};
\node[right] at (5.15, .2) {$\alpha(j_4)+\sigma \frac{b}{2}$};
\draw[thin, latex-] (.5, -.2) to[out = -90, in = 180] (1,-1) node [right] {$\alpha(j_s) + \epsilon \frac{b}{2}$};
\end{tikzpicture}
\end{align}
The separation of variables $\mathcal{K}$ is in general an integral transformation, but in the case of the $\mu$-basis \eqref{mub} of isospin variables, we have 
\begin{align}
\renewcommand{\arraystretch}{1.5}
 \hat{J}^-(y) = \sum_{i=1}^N \frac{\mu_i}{y-z_i} \quad \Rightarrow \quad \left\{\begin{array}{l}  Y_1 =\sum_{i=1}^N \mu_i\ , \\ Y_2 = \sum_{i=1}^N \mu_i z_i\ , \\ \mu_i = Y_2\frac{\prod_{j=1}^{N-2}(z_i-y_j)}{\prod_{i'\neq i}(z_i-z_{i'})}\ ,\end{array}\right. 
\label{my}
\end{align}
and the variables on both sides of the relation are functions of one another. 

The KZ-BPZ relation plays in important role in the study of $\widehat{\mathfrak{sl}}_2$-symmetric theories such as the $H_3^+$ model, and one may wonder whether the $\mathfrak{g}$ KZ equations are involved in similar relations for more general choices of the Lie algebra $\mathfrak{g}$.
While Sklyanin's separation of variables for the $\mathfrak{sl}_3$ Gaudin model exists, writing the $\mathfrak{sl}_3$ KZ equations in Sklyanin variables however does not lead to the expected generalizations of the BPZ equations \cite{rib08b}, and the reason for this discrepancy is not known. 
Another tentative generalization of the KZ-BPZ relation \eqref{dyy} is to replace the field $V_{\langle 2,1\rangle}$ on the right-hand side with another primary field (degenerate or not).
Then the resulting expression can be interpreted as an $N$-point function in a theory whose symmetry algebra is a generalization of $\widehat{\mathfrak{sl}}_2$, as argued in \cite{rib08}.


\section{The \texorpdfstring{$H_3^+$}{H3+} model \label{sechtp}}

The \textbf{\boldmath $H_3^+$ model}\index{h3+ model@$H_3^+$ model} is to the $\widehat{\mathfrak{sl}}_2$ algebra what Liouville theory is to the Virasoro algebra: the simplest non-rational model with the given symmetry.
However, in contrast to Liouville theory, there is no value of the central charge such that the $H_3^+$ model is unitary. 

As we did with Liouville theory, we will define the $H_3^+$ model by its symmetries, and other assumptions on the correlation functions.
We could follow the same route as with Liouville theory, of studying the representations of $\widehat{\mathfrak{sl}}_2$, and deducing the three-point function from the associativity of OPEs involving degenerate fields, as was done by Teschner \cite{tes97a}.
Rather, we will follow the shortcut of assuming that correlation functions of the $H_3^+$ model and Liouville theory are related as suggested by the KZ-BPZ relation \eqref{dyy} -- this relation, when applied to correlation functions (instead of differential equations or conformal blocks), is then called the \textbf{\boldmath $H_3^+$-Liouville relation}\index{h3+-Liouville relation@$H_3^+$-Liouville relation}.


\subsection{Spectrum and correlation functions}

Let us study the correlation functions in the $\mu$-basis, taking advantage of the simplicity of the relation \eqref{my} between the variables $(\mu_i)$ and $(Y_1,Y_2,y_j)$.
Let us first consider the two-point function.
In this case there are no Sklyanin variables $y_j$, and the separation of variables is simply
\begin{align}
N=2 \quad \Rightarrow \quad \left\{\begin{array}{l} Y_1 = \mu_1+\mu_2\ , \\ Y_2 = \mu_1(z_1-z_2)\ . \end{array} \right.
\end{align}
Using the two-point function \eqref{vvss} of Liouville theory, we obtain 
\begin{align}
 \left\langle \Phi^{j_1}_{\mu_1,\bar{\mu}_1} \Phi^{j_2}_{\mu_2,\bar{\mu}_2}\right\rangle = \delta^{(2)}(\mu_1+\mu_2) |\mu_1|^2 b\Big(\delta(j_1+j_2+1)+R\left(-b^{-1}j_1+\tfrac{b}{2}\right) \delta(j_2-j_1) \Big)\ ,
\end{align}
where we omitted the dependence on $z_i$, and we used the parameter $b$ \eqref{bk} and reflection coefficient $R(\alpha)$ \eqref{ram} of Liouville theory.
Actually, the quantity $R\left(-b^{-1}j_1+\frac{b}{2}\right)$ is the reflection coefficent of the $H_3^+$ model in the $\mu$-basis, 
\begin{align}
 \Phi^j_{\mu,\bar{\mu}} = R(-b^{-1}j+\tfrac{b}{2})\ \Phi^{-j-1}_{\mu,\bar{\mu}} \ .
\end{align}
Then let us consider the three-point function.
In this case there is one Sklyanin variables $y_1$, and we have
\begin{align}
 N=3 \quad \Rightarrow \quad  \left\{\begin{array}{l} y_1 = -\frac{\mu_1z_2z_3+\mu_2z_3z_1+\mu_3z_1z_2}{Y_2}\ , \\ \frac{(y_1-z_1)(z_2-z_3)}{(y_1-z_2)(z_1-z_3)} = -\frac{\mu_1}{\mu_2}\ . \end{array}\right.
\end{align}
The relation \eqref{dyy} then reads 
\begin{align}
 \left\langle \prod_{i=1}^3\Phi^{j_i}_{\mu_i,\bar{\mu}_i} \right\rangle = \delta^{(2)}(\textstyle{\sum}_{i=1}^3\mu_i) |\mu_2|^2 \sum_\pm C_\pm(\alpha_1)C_{\alpha_1\mp\frac{b}{2},\alpha_2,\alpha_3} \left|\mathcal{H}^{(s)}_\pm(-\tfrac{\mu_1}{\mu_2})  \right|^2\ , 
\label{sfpm}
\end{align}
where we used the momentums $\alpha_i$ \eqref{aj}, the Liouville theory structure constants $C_\pm(\alpha)$ and $C_{\alpha_1,\alpha_2,\alpha_3}$, and the functions $\mathcal{H}^{(s)}_\pm(x)$, which are related to the 
$s$-channel Virasoro conformal blocks  
$
 \mathcal{F}^{(s)}_\pm(x)  =  
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .3]
\draw (-1,2) node [left] {$\alpha_1$} -- (0,0) -- node [above] {$\alpha_1\mp \frac{b}{2}$} (4,0) -- (5,2) node [right] {$\alpha_2$};
\draw[dashed] (-1,-2) node [left] {$\langle 2,1 \rangle$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$\alpha_3$};
\end{tikzpicture}
$
by eq. \eqref{fgs}. 


However, the three-point function is simpler in the $x$-basis, see eq. \eqref{xxx}.
Assuming correlation functions are single-valued as functions of the isospin variables, we must have
\begin{align}
  \left\langle \prod_{i=1}^3 \Phi^{j_i}_{x_i,\bar{x}_i} \right\rangle = C^{H_3^+}_{j_1,j_2,j_3}\ |x_{12}|^{2(j_1+j_2-j_3)} |x_{23}|^{2(j_2+j_3-j_1)} |x_{31}|^{2(j_3+j_1-j_2)}\ ,
\label{ch}
\end{align}
which provides a natural definition of the three-point structure constant $C^{H_3^+}_{j_1,j_2,j_3}$.
Let us compute this structure constant, by relating the $x$-basis and $\mu$-basis three-point functions.
The relation between the two bases is a single-valued version of the holomorphic Fourier transformation of eq. \eqref{emx}, 
\begin{align}
 \Phi^j_{x,\bar{x}} = \gamma(2j+1)\int_{{\mathbb{C}}} d^2\mu\ |\mu|^{-2j-2} e^{\mu x -\bar{\mu}\bar{x}}\Phi^j_{\mu,\bar{\mu}}\ .
\end{align}
Here we introduce a prefactor $\gamma(2j+1)$, which will be needed in Section \ref{secsu} for ensuring that the $H_3^+$ OPE has a finite limit when the spin becomes half-integer.
Moreover, we flipped the sign of the second term of the exponent of $e^{\mu x -\bar{\mu}\bar{x}}$, as compared to the expected $e^{\mu x +\bar{\mu}\bar{x}}$, in order to ensure the convergence of the integral when $x$ and $\bar{x}$ are complex conjugates.
This affects the relation between the differential operators $\bar{D}^j_{\bar{x}}(t^a)$ and $\bar{D}^j_{\bar{\mu}}(t^a)$, which we define in terms of their holomorphic counterparts $D^j_x(t^a), D^j_\mu(t^a)$ as 
\begin{align}
 \bar{D}^j_{\bar{x}}(t^a) = D^j_{\bar{x}}(t^a)  \quad , \quad \bar{D}^j_{\bar{\mu}}(t^a) = D^j_{-\bar{\mu}}(t^a)\ . 
\end{align}
Notice that the minus sign in the operators $D^j_{-\bar{\mu}}(t^a)$ modifies neither their commutation relations, nor the KZ equations.

The $x$-basis and $\mu$-basis three-point functions can be compared using the formula \cite{rt05}
\begin{multline}
 \prod_{i=1}^3\left(\frac{|\mu_i|^{2j_i+2}}{\pi^2}\int_{{\mathbb{C}}}d^2x_i\ e^{-\mu_ix_i+\bar{\mu}_i\bar{x}_i}\right)
|x_{12}|^{2(j_1+j_2-j_3)} |x_{23}|^{2(j_2+j_3-j_1)} |x_{31}|^{2(j_3+j_1-j_2)} 
\\
= \frac{1}{\pi^2}\delta^{(2)}(\textstyle{\sum}_{i=1}^3\mu_i)|\mu_2|^2 \sum_\pm d_\pm \left|\mathcal{H}^{(s)}_\pm(-\tfrac{\mu_1}{\mu_2})\right|^2 \ ,
\label{iii}
\end{multline}
where we define 
\begin{align}
 d_+ = \frac{\gamma(-j_1+j_2+j_3+1)}{\gamma(-2j_1)} \quad , \quad d_- = \frac{\gamma(j_1+j_2-j_3+1)\gamma(j_1-j_2+j_3+1)}{\gamma(-j_1-j_2-j_3-1)\gamma(2j_1+2)}\ .
\end{align}
The right-hand side of eq. \eqref{iii} is a combination of solutions \eqref{pmf} of the $\mu$-basis global Ward identities, written using the functions $\mathcal{H}^{(s)}_\pm(x)$ of eq. \eqref{fpm}.
Comparing with eq. \eqref{sfpm}, we obtain the three-point structure constant in terms of Liouville theory structure constants,
\begin{align}
 C^{H_3^+}_{j_1,j_2,j_3} = \frac{\pi^2\prod_{i=1}^3\gamma(2j_i+1)}{d_\pm}C_{\pm}(\alpha_1)C_{\alpha_1\mp \frac{b}{2},\alpha_2,\alpha_3}\ .
\end{align}
The conformal boostrap equations of Liouville theory guarantee that this does not depend on the sign $\pm$, see Section \ref{seccbe}.
Using eqs. \eqref{cpm} and \eqref{caaa} for $C_{\pm}(\alpha_1)$ and $C_{\alpha_1\mp \frac{b}{2},\alpha_2,\alpha_3}$ respectively, we find
\begin{align}
\boxed{C^{H_3^+}_{j_1,j_2,j_3} = \frac{\pi^2b^{-1}\left[b^{\frac{2}{b^2}}\mu^{\frac{1}{b}}\right]^{j_1+j_2+j_3+1} \Upsilon'_b(0)\Upsilon_b(-\frac{2j_1}{b})\Upsilon_b(-\frac{2j_2}{b})\Upsilon_b(-\frac{2j_3}{b})}
{\Upsilon_b(-\frac{j_1+j_2+j_3+1}{b})\Upsilon_b(-\frac{j_1+j_2-j_3}{b}) \Upsilon_b(-\frac{j_1-j_2+j_3}{b})\Upsilon_b(-\frac{-j_1+j_2+j_3}{b})}}\ ,
\label{chp}
\end{align}
where the parameter $b$ is given by eq. \eqref{bk}, and the cosmological constant $\mu$ is inherited from Liouville theory.
(We would have a different formula in the case $b\in i\mathbb{R}$, based on the alternative Liouville structure constant \eqref{hc}.)

The $x$-basis two-point function can be obtained from the $\mu$-basis two-point function with the help of the formula 
\begin{align}
 \int_{{\mathbb{C}}}d^2\mu\ e^{\mu x-\bar{\mu}\bar{x}} |\mu|^{-4j-2} = |x|^{4j}\pi \gamma(-2j) \ ,
\end{align}
and we find 
\begin{align}
 \left\langle \Phi^{j_1}_{x_1,\bar{x}_1} \Phi^{j_2}_{x_2,\bar{x}_2} \right\rangle = \frac{-\pi^2 b}{(2j_1+1)^2}\, \delta(j_1+j_2+1)\delta^{(2)}(x_{12}) 
+ \frac{\pi}{b}\mu^{\frac{2j_1+1}{b}} \gamma(-\tfrac{2j_1+1}{b^2})\, \delta(j_1-j_2)|x_{12}|^{4j_1}\, .
\label{pjpj}
\end{align}
Using the same formula, we also obtain the $x$-basis reflection relation from the $\mu$-basis reflection relation,
\begin{align}
 \Phi^j_{x,\bar{x}} = \frac{b^2}{\pi}\mu^{\frac{2j+1}{b}}\gamma(1-\tfrac{2j+1}{b^2})\int_{{\mathbb{C}}}d^2x'\ |x-x'|^{4j}\Phi^{-j-1}_{x',\bar{x}'}\ .
\end{align}

The OPEs of affine primary fields are
\begin{align}
 \Phi^{j_1}_{x_1,\bar{x}_1}\Phi^{j_2}_{x_2,\bar{x}_2} &\sim \frac12 \int_{-\frac12 + ib\mathbb{R}} \frac{(2j+1)^2 dj}{-\pi^2b}\int_{{\mathbb{C}}}d^2x \left\langle \Phi^{j_1}_{x_1,\bar{x}_1}\Phi^{j_2}_{x_2,\bar{x}_2} \Phi^{-j-1}_{x,\bar{x}} \right\rangle \Phi^j_{x,\bar{x}}\ ,
\label{xope}
\\
\Phi^{j_1}_{\mu_1,\bar{\mu}_1}\Phi^{j_2}_{\mu_2,\bar{\mu}_2} &\sim \frac12 \int_{-\frac12 + ib\mathbb{R}} dj\int_{{\mathbb{C}}}\frac{d^2\mu}{b|\mu|^2} \left\langle \Phi^{j_1}_{\mu_1,\bar{\mu}_1}\Phi^{j_2}_{\mu_2,\bar{\mu}_2} \Phi^{-j-1}_{-\mu,-\bar{\mu}} \right\rangle \Phi^j_{\mu,\bar{\mu}}\ .
\label{mope}
\end{align}
Notice that the measures of integration on the spin and isospin variables are dictated by the $\delta(j_1+j_2+1)$ term in the two-point function.
These equations are analogous to eq. \eqref{vvi} for the OPE in Liouville theory.
The values of the spin $j$,
\begin{align}
 \boxed{j\in -\frac12 + ib\mathbb{R}}\ , 
\end{align}
are deduced from Liouville theory via the relation \eqref{aj}.
These values are the same for the left- and right-moving $\widehat{\mathfrak{sl}}_2$ algebras -- the spectrum is diagonal.

Our treatment of the $H_3^+$ model is valid for levels $k\neq -2$. 
If $k=-2$, the Sugawara construction breaks down, and the limit of the model is no longer a conformal field theory.
The central charges of the $H_3^+$ model \eqref{ckg} and of the corresponding Liouville theory \eqref{bk} take the values
\begin{align}
 \boxed{c^{H_3^+} = \frac{3k}{k+2} \in \mathbb{C}-\{3\}} \ , \quad c^{\text{Liouville}} = 1-6k-\frac{6}{k+2}\in \mathbb{C}\ .
\end{align} 

\subsection{Large level limit and geometrical interpretation}

Having defined the $H_3^+$ model by its spectrum and correlation functions, we still have to understand these objects and their interpretation.  

To do this, we will consider the \textbf{\boldmath large level limit}\index{large level limit} $k\to \infty$ of the model, which is sometimes called the minisuperspace limit. 
The KZ equations \eqref{kz} imply that correlation functions do not depend on the positions $z_i$ in this limit, and are functions of the sole isospin variables. 
Moreover, given a generator $J^a_m$, the commutator $[J^a_m,J^b_{-m}]$ \eqref{jam}  tends to infinity for some index $b$, unless $m=0$. 
So the generators $J^a_{m\neq 0}$, and the descendent states they create, disappear from the theory, and only the horizontal subalgebra of $\widehat{\mathfrak{sl}}_2$ survives.
This corresponds to an $SL_2({\mathbb{C}})$ symmetry group, which acts on a field of spin $j$ as 
\begin{align}
 U_g\Phi^j_{x,\bar{x}} = |cx+d|^{4j}\Phi^j_{\frac{ax+b}{cx+d},\frac{\bar{a}\bar{x}+\bar{b}}{\bar{c}\bar{x}+\bar{d}}} \quad \text{with} \quad g = \left(\begin{array}{cc} a & b \\ c & d \end{array}\right) \in SL_2({\mathbb{C}})\ .
\label{ugp}
\end{align}
(This action is formally identical to the action \eqref{tgv} of global conformal transformations on quasi-primary fields.)
Now we notice that the transformation $U_g$ also describes the action of $SL_2({\mathbb{C}})$ on functions on the space \textbf{\boldmath $H_3^+$}\index{H3+@$H_3^+$} of hermitian matrices of size two and determinant one.
Consider indeed the function
\begin{align}
 \Phi^j_{x,\bar{x}}(h) = \left(\begin{bmatrix}
                                x \\ 1
                               \end{bmatrix}^\dagger 
h \begin{bmatrix}
   x \\ 1 
  \end{bmatrix}
 \right)^{2j}\ ,
\end{align}
and the natural action of $g\in SL_2({\mathbb{C}})$ on the space $\mathcal{F}(H_3^+)$ of functions on $H_3^+$,
\begin{align}
 g\cdot f(h) = f(g^\dagger h g)\ ,
\end{align}
then we have 
\begin{align}
 g\cdot \Phi^j_{x,\bar{x}}(h) = U_g \Phi^j_{x,\bar{x}}(h)\ .
\end{align}
This suggests that we identify the large level limit of the field $\Phi^j_{x,\bar{x}}$ with the function $\Phi^j_{x,\bar{x}}(h)$. 
We can then define a scalar product on the large level limit of the spectrum, using the natural, positive definite scalar product on $\mathcal{F}(H_3^+)$, 
\begin{align}
 \left\langle f \middle| f' \right\rangle = \int_{H_3^+} dh\ \overline{f(h)} f'(h)\ ,
\end{align}
where $dh$ is the $SL_2({\mathbb{C}})$-invariant measure on $H_3^+$.
For this scalar product, the action of $g\in SL_2({\mathbb{C}})$ is a unitary tranformation:
\begin{align}
 \left\langle f \middle| g\cdot f'\right\rangle = \int_{H_3^+}dh\ \overline{f(h)} f'(g^\dagger h g) = \int_{H_3^+}dh\ \overline{f((g^{-1})^\dagger h g^{-1})} f'(h) = \left\langle g^{-1}\cdot f \middle| f'\right\rangle\ .
\end{align}
Let us interpret this at the level of the symmetry algebra.
The Lie algebra $\mathfrak{sl}_2({\mathbb{C}})$ of the symmetry group $SL_2({\mathbb{C}})$ can be viewed as a six-dimensional real space, whose generators are related to $J^a_0, \bar{J}^a_0$ by the ${\mathbb{R}}$-linear map
\begin{align}
 \left\{\begin{array}{lcl} t^a & \mapsto & J_0^a + \bar{J}_0^a \ ,  \\ it^a & \mapsto & i(J^a_0 - \bar{J}^a_0)\ . \end{array}\right. 
\end{align}
(The minus sign in the image of $it^a$ comes from the complex conjugation of the elements of $g$ in $U_g\Phi^j_{x,\bar{x}}$ \eqref{ugp}.)
Our scalar product is such that $t^a$ and $it^a$ are antihermitian, which is equivalent to
\begin{align}
 (J^a_0)^\dagger = -\bar{J}^a_0\ .
\label{jzd}
\end{align}

In the large level limit, the OPE of the fields $\Phi^j_{x,\bar{x}}$ must remain associative and commutative. 
The product of functions in $\mathcal{F}(H_3^+)$ has these properties, which suggests that it coincides with the large level limit of the OPE -- given how stringent the condition of associativity is, we do not expect alternative products to exist. 
Then the large level limit of the spectrum is the subspace of 
$\mathcal{F}(H_3^+)$ which is spanned by the functions $\Phi^j_{x,\bar{x}}$.
The OPE \eqref{xope} implies that this subspace is closed under multiplication, which suggests that the subspace in question is $\mathcal{F}(H_3^+)$ itself. 
Calling $C^j$ the \textbf{\boldmath principal series representation of $\mathfrak{sl}_2({\mathbb{C}})$}\index{principal series representation of $\mathfrak{sl}_2({\mathbb{C}})$} of spin $j\in -\frac12 +i{\mathbb{R}}$, which is defined by the action of $\mathfrak{sl}_2({\mathbb{C}})$ on $\Phi^j_{x,\bar{x}}$, we obtain
\begin{align}
 \mathcal{F}(H_3^+) = \bigoplus_{j\in -\frac12+i{\mathbb{R}}_+} C^j\ .
\end{align}
(For a more rigorous definition of $\mathcal{F}(H_3^+)$, and proof of its decomposition into representations of $\mathfrak{sl}_2({\mathbb{C}})$, see \cite{tes97b}.)
Furthermore, the identification of the limit of the OPE with the product of functions suggests
\begin{align}
 \underset{k\to \infty}{\lim} \left\langle \prod_{i=1}^N \Phi^{j_i}_{x_i,\bar{x}_i}(z_i,\bar{z}_i)\right\rangle \propto \int_{H_3^+} dh\ \prod_{i=1}^N \Phi^{j_i}_{x_i,\bar{x}_i}(h)\ , 
\end{align}
where the unknown proportionality factor is an $x,\bar{x}$-independent field normalization.
Both sides of this equation can be computed explicitly in the case $N=3$, and are found to agree \cite{tes97b}.
Notice that the large level limit of the $H_3^+$ $N$-point function is formally identical to the light asymptotic limit of the Liouville $N$-point function \eqref{zih}, whose interpretation is however quite different as it depends on positions $z,\bar{z}$ instead of isospin variables $x,\bar{x}$.
So the large level limit of our two-dimensional conformal field theory is the quantum mechanics of a point particle on the space $H_3^+$, which justifies naming the theory the \textbf{\boldmath $H_3^+$ model}\index{h3+ model@$H_3^+$ model}.
Other names for the same theory include the $H_3^+$ WZW model and the $SL_2({\mathbb{C}})/SU_2$ WZW model; the latter name comes from the realization of the space $H_3^+$ as a coset.

We can now investigate the unitarity of the $H_3^+$ model, using the conjugation rule \eqref{jzd} for the horizontal subalgebra, which we now extend to the entire affine Lie algebra as 
\begin{align}
 \boxed{(J^a_n)^\dagger = -\bar{J}^a_{-n}}\ .
\label{jdj}
\end{align}
This is compatible with the structure \eqref{jam} of the affine Lie algebra $\hat{\mathfrak{sl}}_2$ provided 
\begin{align}
 k\in\mathbb{R}\ .
\label{kir}
\end{align}
Via the Sugawara construction \eqref{ljj}, the conjugation rule for $J^a_n$ implies $L_n^\dagger = \bar{L}_{-n}$, which differs from the conjugation rule \eqref{ldn} which we previously assumed. 
We refrain from discussing how this affects the geometrical interpretation of conformal transformations.
Let us rather investigate the unitarity of the theory. 
Given a primary state $|v\rangle$, the norm square of some of the level one descendents of $|v\rangle$ is
\begin{align}
 \left\langle (J^0_{-1}+\lambda\bar{J}^0_{-1})v \middle| (J^0_{-1}+\lambda\bar{J}^0_{-1})v \right\rangle
= -\left\langle v \middle| (\bar{\lambda} J^0_1+\bar{J}^0_1)(J^0_{-1}+\lambda\bar{J}^0_{-1})v \right\rangle 
= -\frac{k}{2}(\lambda+\bar{\lambda}) \langle v| v\rangle\ .
\label{viv}
\end{align}
This cannot be positive for all values of $\lambda$,  
so the theory cannot be unitary -- except of course in the large level limit, where descendent modes disappear. 


\section{WZW models}

\subsection{Definition and general properties}

Given a simple Lie group $G$, the $G$ Wess--Zumino--Witten model or $G$ \textbf{\boldmath WZW model}\index{WZW model} is usually defined by a Lagrangian, which depends on a parameter $k$.
This model can then be shown to be a conformal field theory with a $\hat{\mathfrak{g}}$ symmetry algebra, where $\mathfrak{g}$ is the Lie algebra of $G$.
The parameter $k$ coincides with the level of $\hat{\mathfrak{g}}$, and may have to be quantized for the model to be consistent, depending on the group $G$.
In any case, the allowed values of $k$ accumulate near $k=\infty$.

We will of course not use the Lagrangian definition of WZW models, which raises the question of characterizing these models in the conformal bootstrap approach.
The fundamental axiom is the presence of the symmetry algebra $\hat{\mathfrak{g}}$, and some  authors call all models with this symmetry algebra WZW models.
Here we will insist that, among models with this symmetry, 
a WZW model can be unambiguously associated to a Lie group $G$, such that its spectrum $S$ obeys
\begin{align}
 \boxed{\underset{k\to \infty}{\lim} S = \mathcal{F}(G)}\ ,
\label{lsfg}
\end{align}
where $\mathcal{F}(G)$ is the space of functions on $G$.
This property brings the group $G$, and not just the Lie algebra $\mathfrak{g}$, into the definition of a WZW model.
This property still does not fully characterize WZW models: in particular, nothing forces the level $k$ to be quantized whenever the Lagrangian definition dictates it.
It is plausible that the spectrum of WZW models can be characterized in terms of functions on a manifold related to the loop group of $G$, but such a characterization is not known.
Instead of a proper definition of WZW models, we will limit ourselves to giving a few known properties of the spectrum of the $G$ WZW model:
\begin{enumerate}
 \item If $G$ is compact, then the $G$ WZW model is rational.
\item If $G$ is compact, then the level $k$ takes positive integer values.
\item The $G$ WZW model is diagonal if and only if $G$ is simply connected. 
\end{enumerate}
The relation between the simple connectedness of $G$ and the diagonality of the associated model is already manifest in the case of abelian groups.
The free bosonic theory whose spectrum was given in eq. \eqref{sz} (with $Q=0$) may be called the ${\mathbb{R}}$ WZW model, and it is diagonal.
The compactified free boson, whose spectrum was given in eq. \eqref{sr}, may be called the $U(1)$ WZW model, and it is not diagonal. 

Let us study the consequences of the axiom \eqref{lsfg}.
The space $\mathcal{F}(G)$ of functions on $G$ has a natural action of 
$G\times \bar{G}$, where the bar is here for distinguishing the two copies of $G$, such that for $f\in \mathcal{F}(G)$ we have 
\begin{align}
\left( (g,\bar{g})\cdot f\right)(h) = f(g^{-1}h\bar{g})\ .
\end{align}
We identify the corresponding infinitesimal symmetry algebra $\mathfrak{g}\times \bar{\mathfrak{g}}$ with the large level limit of the symmetry algebra $\hat{\mathfrak{g}}\times \bar{\hat{\mathfrak{g}}}$ of the WZW model.
That is, $\mathfrak{g}$ and its generators $t^a$ are identified with the horizontal subalgebra of $\hat{\mathfrak{g}}$ and its generators $J^a_0$.
The natural scalar product on $\mathcal{F}(G)$ is 
\begin{align}
 \langle f|f'\rangle = \int_G dh\ \overline{f(h)} f'(h)\ ,
\label{gbg}
\end{align}
where $dh$ is the Haar measure, which is invariant under the left and right actions of $G$ on itself.
As in the case of the $H_3^+$ model, the generators of the symmetry algebra are antihermitian for this scalar product, which now implies
\begin{align}
 (J^a_0)^\dagger = -J^a_0\  . 
\label{jzdj}
\end{align}
This conjugation rule is naturally extended to the following conjugation rule on the affine Lie algebra,
\begin{align}
 \boxed{(J^a_n)^\dagger = -J^a_{-n}}\ .
\end{align}
This is compatible with the commutation relations \eqref{jam} of the affine Lie algebra $\hat{\mathfrak{g}}$, provided the structure constants $f^{ab}_c$ and level $k$ are real.
This is also compatible with the conjugation rule \eqref{ldn} for the generators of the Virasoro algebra, via the Sugawara construction \eqref{ljj}.

If $G$ is compact, then the space $\mathcal{F}(G)$ of functions on $G$ can be decomposed into irreducible representations of the symmetry group $G\times \bar{G}$ using the \textbf{\boldmath Peter-Weyl theorem}\index{Peter-Weyl theorem}, 
\begin{align}
 \mathcal{F}(G) = \bigoplus_{R\in \mathcal{R}} R\otimes \bar{R}\ ,
\end{align}
where $\mathcal{R}$ is the set of irreducible unitary representations of $G$, which coincides with the set of irreducible finite-dimensional representations of $G$.
Since the scalar product \eqref{gbg} is positive definite, it is obvious that only unitary representations can appear.
The nontrivial statement is that all unitary irreducible representations do appear, and that they couple diagonally. 
If $G$ is simply connected, then the spectrum of the WZW model is still diagonal for all positive integer values of $k$, \cite{fms97}
\begin{align}
 S = \bigoplus_{R\in \mathcal{R}_k} \hat{R}\otimes \bar{\hat{R}}\ ,
\end{align}
where $\hat{R}$ is the affine highest-weight representation of $\hat{\mathfrak{g}}$ which is built from $R$ by acting with the creation modes and removing the null vectors, and the finite subset $\mathcal{R}_k$ of $\mathcal{R}$ is defined by certain $k$-dependent conditions.
The resulting representations $\hat{R}$ are called the integrable highest-weight representations of $\hat{\mathfrak{g}}$. 
We have $\underset{k\to\infty}{\lim} \mathcal{R}_k =\mathcal{R}$ and $\underset{k\to \infty}{\lim} \hat{R} = R$, so that the spectrum $S$ has the desired large level limit \eqref{lsfg}.

These results on the spectrum of the $G$ WZW model when $G$ is compact can be derived by looking for rational models, whose spectrums are be made of multiply degenerate representations -- the logic we followed with Virasoro minimal models.
We will now do this in the case $G=SU_2$.   


\subsection{The \texorpdfstring{$SU_2$}{SU(2)} WZW model \label{secsu}}

We want to build theories with the $\widehat{\mathfrak{sl}}_2$ symmetry algebra, whose spectrums are discrete or even rational.
These spectrums must therefore be made of degenerate representations.
Rather than studying the structure and null vectors of the representations of $\widehat{\mathfrak{sl}}_2$, as we did in Section \ref{secvm} in the case of the Virasoro algebra, 
we will use a shortcut.
Remembering that we recovered
the Virasoro degenerate fields and their fusion rules from the Liouville OPE in Section \ref{sectpf},
we will use the $H_3^+$ OPE for studying $\widehat{\mathfrak{sl}}_2$ degenerate fields. 

According to our axiom \eqref{lsfg}, and to the Peter-Weyl theorem, the fields which are relevant for the $SU_2$ WZW model correspond to the finite-dimensional representations of $SU_2$.
We will admit the well-known result that such representations have spins $j\in\{0,\frac12,1,\frac32\cdots \}$ and dimensions $2j+1$.
We will soon see that the corresponding fields are degenerate, in the sense  that their OPEs with other fields involve finitely many primary fields. 
Experience with Virasoro minimal models however suggests that we should consider multiply degenerate fields, and it will turn out that we also need fields with spins $j\in \frac12{\mathbb{N}} + \frac12 b^2=\frac12{\mathbb{N}} -1-\frac{k}{2}$, which will also turn out to be degenerate.
Let us introduce notations for the limits of $H_3^+$ field when the spin takes such particular values,
\begin{align}
J\in \frac12{\mathbb{N}} \quad \Rightarrow \quad \left\{\begin{array}{ccl} \Phi^J  & = &\underset{j\to J}{\lim}\ \Phi^j \ , \\ \Phi^{(J,1)} &=& \underset{j\to J-1-\frac{k}{2}}{\lim} \Phi^j \ . \end{array}\right.
\end{align}
Let us now consider the OPE $\Phi^{j_1}_{x_1,\bar{x}_1}\Phi^{j_2}_{x_2,\bar{x}_2}$ \eqref{xope} where we initially assume $j_1,j_2\in -\frac12+ib{\mathbb{R}}$.
The positions of the line of integration $j\in -\frac12+ib{\mathbb{R}}$ and the eight cones of poles of the OPE coefficient are
\begin{align}
\newcommand{\polewedge}[3]{
\begin{scope}[#1]
\node[blue, draw,circle,inner sep=1pt,fill] at (0, 0) {};
\node[#3] at (0,0) {#2};
\filldraw[opacity = .1, blue] (0,0) -- (6, -2) -- (6, 2) -- cycle;
\end{scope}
}
 \begin{tikzpicture}[baseline=(current  bounding  box.center), scale = 1.2]
  \draw[-latex] (-5,0) -- (.8, 0) node[above right] {$0$} -- (6,0) node [above] {$j$};
  \clip (-5, -3) -- (-5, 3) -- (6, 3) -- (6, -3) -- cycle;
  \draw (.8, -3.5) -- (.8, 3.5);
  \begin{scope}[rotate around = {-18.43:(.4,0)}]
  \draw[ultra thick, red] (.4, -4.5) -- (.4, 4.5);
  \polewedge{shift = {(0, .7)}, rotate = 180}{$j_1-j_2-1$}{above left};
  \polewedge{shift = {(0, -.7)}, rotate = 180}{$j_2-j_1-1$}{above left};
  \polewedge{shift = {(0, 1.8)}, rotate = 180}{$j_1+j_2$}{above left};
  \polewedge{shift = {(-.2, -1.8)}, rotate = 180}{$-j_1-j_2-k$}{above left};
  \polewedge{shift = {(1, .8)}}{$j_1-j_2-k-2$}{above right};
  \polewedge{shift = {(1, -.6)}}{$j_2-j_1-k-2$}{above right};
  \polewedge{shift = {(1, 1.9)}}{$j_1+j_2-k-1$}{above right};
  \polewedge{shift = {(.8, -1.7)}}{$-j_1-j_2-1$}{above right};
  \end{scope}
 \end{tikzpicture}
\end{align}
Taking the limit $j\to J$ or $j\to J-1-\frac{k}{2}$, the OPE coefficient vanishes, and the only surviving contributions are from poles that cross the line of integration. (See Section \ref{seceul} for more explanations.) The resulting OPEs are schematically written as 
\begin{align}
 \Phi^J \Phi^{j_2} & \sim \sum_{j=j_2-J}^{j_2+J} \Phi^j \ ,
\label{pjp}
\\
\Phi^{(J,1)}\Phi^{j_2} & \sim \sum_{j=j_2-1-\frac{k}{2}-J}^{j_2-1-\frac{k}{2}+J} \Phi^j + \sum_{j=j_2+1+\frac{k}{2}-J}^{j_2+1+\frac{k}{2}+J} \Phi^j\ ,
\label{pjop}
\end{align}
where the sums run by increments of $1$, and we have taken the reflection relation $\Phi^j\propto \Phi^{-j-1}$ into account. 

For generic values of the level $k$, the OPE of two fields with half-integer spins is therefore 
\begin{align}
 \boxed{\Phi^{J_1}\Phi^{J_2} \sim \sum_{J=|J_1-J_2|}^{J_1+J_2} \Phi^J}\ .
\end{align}
This suggests that there exists a \textbf{\boldmath generalized $SU_2$ WZW model}\index{generalized $SU_2$ WZW model}, whose spectrum is 
\begin{align}
 \boxed{S = \bigoplus_{J=0,\frac12,1,\frac32,\cdots} \hat{R}_J \otimes \bar{\hat{R}}_J}\ ,
\end{align}
where $\hat{R}_J$ is the affine highest-weight representation of $\widehat{\mathfrak{sl}}_2$ built from the finite-dimensional representation of $\mathfrak{sl}_2$ of spin $J$.
The two-point function of the generalized $SU_2$ WZW model is obtained from the corresponding $H_3^+$ two-point function, 
\begin{align}
 \left\langle \Phi^{J_1}_{x_1,\bar{x}_1} \Phi^{J_2}_{x_2,\bar{x}_2} \right\rangle = \frac{\pi}{\sqrt{-k-2}}\mu^{\frac{2J_1+1}{\sqrt{-k-2}}} \gamma(\tfrac{2J_1+1}{k+2})\, \delta_{J_1,J_2}|x_{12}|^{4J_1}\, .
\label{pjpjd}
\end{align}
In complete analogy with the case of the generalized minimal models, the three-point function of a generalized $SU_2$ WZW model is obtained from the three-point function \eqref{chp} of the $H_3^+$ model by sending the spins to their half-integer values, and replacing the (vanishing) $\Upsilon_b$ functions with their derivatives. 

Let us now look for rational WZW models, by considering doubly degenerate fields.
We restrict our attention to the case when $\Phi^{J}$ and $\Phi^{(J',1)}$ are related by reflection, so that $J+J'=\frac{k}{2}$.
This restricts the level $k$ to integer values,  
\begin{align}
 \boxed{k\in {\mathbb{N}}}\ ,
\end{align}
and the spin $J$ to the finite set 
\begin{align}
 J\in \left\{0,\frac12,\cdots \frac{k}{2}\right\}\ .
\label{jin}
\end{align}
The OPE of the doubly degenerate field $\Phi^J \propto \Phi^{(\frac{k}{2}-J,1)}$ with $\Phi^{j_2}$ is constrained by both equations \eqref{pjp} and \eqref{pjop}.
Taking the reflection relation $\Phi^j\propto \Phi^{-j-1}$ into account, we find that the OPE is nonvanishing only if $j_2$ itself belongs to the set \eqref{jin}.
In this case, we have 
\begin{align}
\boxed{\Phi^{J_1}\Phi^{J_2} = \sum_{J=|J_1-J_2|}^{\operatorname{min}(J_1+J_2,k-J_1-J_2)} \Phi^J}\ .
\end{align}
This suggests that the set of our doubly degenerate fields is closed under fusion, and that there exists a rational model whose spectrum is
\begin{align}
 \boxed{S = \bigoplus_{J=0,\frac12,\cdots \frac{k}{2}} \hat{R}_J \otimes \bar{\hat{R}}_J}\ .
\end{align}
This model, which exists for any positive integer value of $k$, is the \textbf{\boldmath $SU_2$ WZW model}\index{su2 WZW model@$SU_2$ WZW model}.
The two- and three-point functions of this model are special cases of corresponding correlation functions of the generalized $SU_2$ WZW model. 

The space of models with the $\widehat{\mathfrak{sl}}_2$ symmetry algebra is therefore similar to the space of models with Virasoro symmetry algebra, according to the following table:
\begin{align}
\renewcommand{\arraystretch}{1.3}
 \begin{tabular}{|l|l|}
  \hline
 $\widehat{\mathfrak{sl}}_2$  & Virasoro 
\\
\hline
$H_3^+$ model & Liouville theory 
\\
generalized $SU_2$ WZW models & generalized minimal models
\\
$SU_2$ WZW models & diagonal minimal models
\\
\hline
 \end{tabular}
\end{align}
In addition, for both symmetry algebras, there exist rational, non-diagonal models, which in both cases fit in an A-D-E classification \cite{fms97}. 
Non-diagonal models with $\widehat{\mathfrak{sl}}_2$ symmetry include the $SO_3$ WZW models, where $SO_3 = \frac{SU_2}{\mathbb{Z}_2}$ is not simply connected.


\subsection{The \texorpdfstring{$\widetilde{SL}_2(\mathbb{R})$}{SL2(R)} WZW model \label{secslr}}

After the $H_3^+$ model, the \textbf{$\widetilde{SL}_2(\mathbb{R})$ WZW model}\index{sl2tilder WZW model@$\widetilde{SL}_2(\mathbb{R})$ WZW model} is our second example of a non-rational model with an $\widehat{\mathfrak{sl}}_2$ symmetry algebra.
Work on the $\widetilde{SL}_2(\mathbb{R})$ WZW model has been motivated by its relevance to string theory in $AdS_3$.
The model has not been fully solved: the three-point function is known only partially, and crossing symmetry has not been proved.
We will limit ourselves to working out the fusion rules, and deriving Maldacena and Ooguri's widely believed and well-tested conjecture for the spectrum of the model.
This spectrum is more complicated than the spectrum of the $H_3^+$ model, which is why solving the $\widetilde{SL}_2(\mathbb{R})$ WZW model is more difficult.

The Lie group \textbf{\boldmath $\widetilde{SL}_2(\mathbb{R})$}\index{sl2tilder@$\widetilde{SL}_2(\mathbb{R})$} is defined as the universal covering group of the group $SL_2({\mathbb{R}})$ of matrices of size two with real coefficients and determinant one.
The group $SL_2({\mathbb{R}})$ is not simply-connected, as the matrices of the type $\left(\begin{smallmatrix} \cos \tau & \sin\tau \\ -\sin\tau & \cos \tau \end{smallmatrix}\right)$ form a non-contractible loop, and the first homotopy group of $SL_2({\mathbb{R}})$ is ${\mathbb{Z}}$.
So $\widetilde{SL}_2(\mathbb{R})$ is obtained from $SL_2({\mathbb{R}})$ by decompactifying the $\tau$ direction, and we have $SL_2({\mathbb{R}}) = \widetilde{SL}_2(\mathbb{R})/{\mathbb{Z}}$.

Let us study the space $\mathcal{F}(\widetilde{SL}_2(\mathbb{R}))$ of functions on $\widetilde{SL}_2(\mathbb{R})$, which is assumed to be the large level limit of the spectrum of our model. 
In this limit, a basis of symmetry generators is $(J^a_0)$, and the elements of this basis are antihermitian for the natural scalar product \eqref{gbg}.
We will however work with a basis that includes a hermitian generator, whose eigenvalues are therefore real in unitary representations.
We still call this basis $(J^a_0)$, although it is obtained from the original basis by a complex change of bases, such that the conjugation rule becomes
\begin{align}
 \left\{\begin{array}{l} (J_0^0)^\dagger = J_0^0\ , \\
         (J_0^\pm)^\dagger = -J_0^\mp \ .
        \end{array}
\right.
\label{jtdj}
\end{align}
In the matrix representation \eqref{mta} of $\mathfrak{sl}_2$, this corresponds to the $\mathfrak{su}_{1,1}$ conjugation rule $M^\dagger = \left(\begin{smallmatrix} 1 & 0 \\ 0 & -1 \end{smallmatrix}\right) \bar{M}^T \left(\begin{smallmatrix} 1 & 0 \\ 0 & -1 \end{smallmatrix}\right)$. (The matrices which satisfy $M^\dagger =-M$ for the $\mathfrak{su}_{1,1}$ conjugation rule are by definition the elements of $\mathfrak{su}_{1,1}$ itself). 

The decomposition of $\mathcal{F}(\widetilde{SL}_2(\mathbb{R}))$ into irreducible unitary representations of the global symmetry algebra $\mathfrak{sl}_2\times \overline{\mathfrak{sl}}_2$ involves two types of representations: the \textbf{\boldmath principal series representation of $\mathfrak{sl}_2$}\index{principal series representation of $\mathfrak{sl}_2$} $C^j_\alpha$ and the \textbf{\boldmath discrete series representation of $\mathfrak{sl}_2$}\index{discrete series representation of $\mathfrak{sl}_2$} $D^{j,\pm}$, where $j$ is the spin. 
These representations can be characterized by the eigenvalues of the hermitian generator $J_0^0$,
\begin{align} 
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|l|l|l|}
  \hline
Representation & Parameter values & Eigenvalues of $J_0^0$
\\
\hline 
$C^j_\alpha$  & $j\in -\tfrac12+i{\mathbb{R}}_+,\ \alpha\in{\mathbb{R}}\ \text{mod}\ {\mathbb{Z}}$ &  $\alpha + {\mathbb{Z}}$ 
\\
$D^{j,+}$ & $j\in]-\tfrac12,\infty[$ & $j+1+{\mathbb{N}}$
\\
$D^{j,-}$ & $j\in]-\tfrac12,\infty[$ & $-(j+1+{\mathbb{N}})$
\\
\hline 
 \end{tabular}
\label{rpe}
\end{align}
Given a representation $R$, let $R^*$ be the dual representation, that is the representation with opposite $J_0^0$ eigenvalues:
\begin{align}
 (C^j_\alpha)^* &= C^j_{-\alpha} \ , 
\\
 (D^{j,\pm})^* &= D^{j,\mp}\ ,
\end{align}
So, according to \cite{rib09} and references therein, we have
\begin{align}
 \mathcal{F}(\widetilde{SL}_2(\mathbb{R})) &= \int^\oplus_{-\frac12+i{\mathbb{R}}_+} dj \int^\oplus_{]0,1[} d\alpha\ C^j_\alpha \otimes \bar{C}^j_{\alpha} \oplus \bigoplus_\pm \int^\oplus_{]-\frac12, \infty[} dj\ D^{j,\pm}\otimes \bar{D}^{j,\pm} \ ,
\label{fst}
\\
 \mathcal{F}(SL_2(\mathbb{R})) &= \int^\oplus_{-\frac12+i{\mathbb{R}}_+} dj \bigoplus_{\alpha\in\{0,\frac12\}} C^j_\alpha \otimes \bar{C}^j_{\alpha} \oplus \bigoplus_\pm \bigoplus_{j=-\frac12, 0,\frac12 \cdots} D^{j,\pm}\otimes \bar{D}^{j,\pm} \ ,
\end{align}
where the identification of $\mathcal{F}(SL_2(\mathbb{R}))$ with the space of $\tau$-periodic functions on $\widetilde{SL}_2(\mathbb{R})$ amounts to restricting the eigenvalues of our hermitian generator to be half-integers.
Tensor products of principal and discrete series representations can be written as 
\begin{align}
 R_1\otimes R_2 = \bigoplus_{R_3} N_{R_1,R_2,R_3^*} R_3\ ,
\label{ror}
\end{align}
where $N_{R_1,R_2,R_3}$ is an integer-valued function, which obeys $N_{R_1^*,R_2^*,R_3^*}=N_{R_1,R_2,R_3}$ and is symmetric under permutations.
Modulo these symmetries, the only nonzero values of $N_{R_1,R_2,R_3}$ are
\begin{align}
N_{D^{j_1,+},D^{j_2,+},D^{j_3,-}} &= 1 \quad \text{if}\ j_3\in j_1+j_2+1+{\mathbb{N}}\ ,
\label{nddd}
\\
N_{C^{j_1}_{\alpha_1},D^{j_2,+},D^{j_3,-}} &= 1 \quad \text{if}\ \alpha_1+j_2-j_3\in{\mathbb{Z}}\ ,
\\
 N_{C^{j_1}_{\alpha_1},C^{j_2}_{\alpha_2},D^{j_3,+}} &= 1 \quad \text{if}\ \alpha_1+\alpha_2+j_3\in {\mathbb{Z}}\ ,
\\
N_{C^{j_1}_{\alpha_1},C^{j_2}_{\alpha_2},C^{j_3}_{\alpha_3}} &= 2 \quad \text{if}\ \alpha_1+\alpha_2+\alpha_3\in {\mathbb{Z}}\ .
\end{align}
For example, the tensor product of two principal series representations is
\begin{align}
 C^{j_1}_{\alpha_1}\otimes C^{j_2}_{\alpha_2} &= 2\int^\oplus_{-\frac12+i{\mathbb{R}}_+} dj\ C^j_{\alpha_1+\alpha_2} 
\oplus \bigoplus_\pm \bigoplus_{\substack{j\in \pm\alpha_1\pm\alpha_2+{\mathbb{Z}}\\ j\in]-\frac12, \infty[}} D^{j,\pm} \ ,
\label{coc}
\end{align}
where the factor of $2$ is the tensor product multiplicity which we already encountered in Section \ref{secwikz}.
Actually, all the values of $N_{R_1,R_2,R_3}$ can be deduced from the values of $N_{D^{j_1,+},D^{j_2,+},D^{j_3,-}}$, using the remark that as far as the eigenvalues \eqref{rpe} of $J^0_0$ are concerned, we have the identification
\begin{align}
 C^j_\alpha \sim D^{\alpha-1,+} \oplus D^{-\alpha,-}\ .
\label{cjdd}
\end{align}
This identification apparently predicts a nonzero value for $N_{C^j_\alpha,D^{j_2,+},D^{j_3,+}}$.
That value should be discarded, because it depends on $\alpha$ whereas $C^j_\alpha$ only depends on $\alpha\ \text{mod}\ {\mathbb{Z}}$.

After these reminders on $\widetilde{SL}_2(\mathbb{R})$ and its representations, we are ready to consider the associated WZW model. 
The natural extension of the conjugation rule \eqref{jtdj} to the symmetry algebra $\widehat{\mathfrak{sl}}_2$ is
\begin{align}
 \left\{\begin{array}{l} (J_n^0)^\dagger = J_{-n}^0\ , \\
         (J_n^\pm)^\dagger = -J_{-n}^\mp \ ,
        \end{array}
\right.
\end{align}
which is compatible with the commutation relations \eqref{jam} provided the level $k$ is real.
The principal and discrete series representations of $\mathfrak{sl}_2$ are naturally extended to affine highest-weight representations of $\widehat{\mathfrak{sl}}_2$: the principal series representations $\hat{C}^j_\alpha$ and discrete series representations $\hat{D}^{j,\pm}$.
By computing the norms of level one states, it is easy to see that such representations are not unitary.
But the $\widetilde{SL}_2(\mathbb{R})$ WZW model is not expected to be unitary, as the metric on the underlying group has a mixed signature. (What matters for applications to string theory is not unitarity, but another property called the no-ghost theorem.) 

So, can we build the spectrum of the model from such affine highest-weight representations?
The answer turns out to be no, as this would be incompatible with an algebraic feature of $\widehat{\mathfrak{sl}}_2$ called the \textbf{\boldmath spectral flow}\index{spectral flow} \cite{mo00a}.
The spectral flow is a family $(\rho_w)_{w\in{\mathbb{Z}}}$ of automorphisms of $\widehat{\mathfrak{sl}}_2$, which obey $\rho_w\rho_{w'}=\rho_{w+w'}$ and act as 
\begin{align}
 \rho_w(J^0_n)&=  J^0_n + \frac12 kw \delta_{n,0}   \ ,
\\
 \rho_w(J^\pm_n) &= J^\pm_{n\pm w}  \ .
\end{align}
According to eqs. \eqref{ljj} and \eqref{lzjj}, this implies
\begin{align}
 \rho_w(L_n)  = L_n + wJ^0_n +\frac14 kw^2 \delta_{n,0}\ .
\end{align}
Given a representation $R$ of $\widehat{\mathfrak{sl}}_2$, that is an action of the generators $J^a_n$ on some vectors $|v\rangle$, we define the \textbf{\boldmath spectrally flowed representation}\index{spectrally flowed representation} $\rho_w(R)$ by the action $\rho_{-w}(J^a_n)|v\rangle$.  
It follows from this definition that 
\begin{align}
 \rho_w(R)^* = \rho_{-w}(R^*)\ .
\end{align}
Moreover, it is believed that the action of spectral flow commutes with fusion, in the sense that \cite{gab01b}
\begin{align}
 \rho_{w}(R)\times \rho_{w'}(R') = \rho_{w+w'}(R\times R')\ .
\label{rwr}
\end{align}
We assume that fusion products of representations of $\widehat{\mathfrak{sl}}_2$ have the form 
\begin{align}
 R_1\times R_2 = \bigoplus_{R_3} N_{R_1,R_2,R_3^*} R_3\ ,
\end{align}
where the $N_{R_1,R_2,R_3}$ are a permutation-symmetric, integer-valued fusion multiplicities such that $N_{R_1^*,R_2^*,R_3^*}=N_{R_1,R_2,R_3}$.
From eq. \eqref{rwr}, we must then have 
\begin{align}
w_1+w_2+w_3=0 \quad \Rightarrow \quad N_{\rho_{w_1}(R_1),\rho_{w_2}(R_2),\rho_{w_3}(R_3)}=N_{R_1,R_2,R_3}\ .
\label{nrrr} 
\end{align}
Let us consider the action of spectral flow on our affine highest-weight representations. 
We introduce the notations 
\begin{align}
 \hat{C}^{j,w}_\alpha &= \rho_w(\hat{C}^j_\alpha) \quad , \quad (w\in{\mathbb{Z}})\ ,
\\
\hat{D}^{j,w} &= \rho_{w-\frac12}(\hat{D}^{j,+})\quad , \quad (w\in \tfrac12+{\mathbb{Z}})\ .
\end{align}
If $w\neq 0$, then $\hat{C}^{j,w}_\alpha$ cannot be an affine highest-weight representation, because the eigenvalues of $\rho_{-w}(L_0) = L_0-w J^0_0 +\frac14 kw^2$ in $\hat{C}^j_\alpha$ are not bounded from below -- and actually, the representations $(\hat{C}^{j,w}_\alpha)_{w\in{\mathbb{Z}}}$ all differ from one another.
Let us now focus on discrete series representations.
The representation $\hat{D}^{j,\pm}$ can be characterized by the existence of a state $|v^{j,\pm}\rangle$ such that 
\begin{align}
J^\mp_{n\geq 0}|v^{j,\pm}\rangle = J^0_{n>0}|v^{j,\pm}\rangle =  J^\pm_{n>0}|v^{j,\pm}\rangle = (J^0_0\mp(j+1))|v^{j,\pm}\rangle = 0\ .
\end{align}
So we can characterize $\rho_w(\hat{D}^{j,\pm})$ by the action of $\rho_{-w}(J^a_n)$ on $|v^{j,\pm}\rangle$.
In particular, we notice that $\rho_1(J^a_n)|v^{j,+}\rangle = 0 \ \Leftrightarrow \ J^a_n|v^{-j-2-\frac{k}{2},-}\rangle=0$, which leads to 
\begin{align}
 \rho_{-1}(\hat{D}^{j,+}) = \hat{D}^{-j-2-\frac{k}{2},-} \ .
\label{rdd}
\end{align}
So the spectral flow orbit of $\hat{D}^{j,+}$ contains two affine highest-weight representations, namely $\hat{D}^{j,\frac12} = \hat{D}^{j,+}$ itself and $\hat{D}^{j,-\frac12} = \hat{D}^{-j-2-\frac{k}{2},-}$.
The rest of the orbit is made of representations where the eigenvalues of $L_0$ are not bounded from below. 
And the dual representations of our spectrally flowed representations are
\begin{align}
 (\hat{C}^{j,w}_{\alpha})^* &= \hat{C}^{j,-w}_{-\alpha}\ ,
\label{cjwd}
\\
(\hat{D}^{j,w})^* &= \hat{D}^{-j-2-\frac{k}{2},-w}\ .
\label{djwd}
\end{align}
This concludes our discussion of spectral flow.
We will now be able to argue that spectrally flowed representations must appear in the spectrum. 

By our definition of WZW models, the large level limit of the spectrum $\tilde{S}$ of the $\widetilde{SL}_2(\mathbb{R})$ WZW model is $\mathcal{F}(\widetilde{SL}_2(\mathbb{R}))$ \eqref{fst}, and we therefore expect $\tilde{S}$ to contain affine discrete representations of both series $\hat{D}^{j,\pm}$.
Let us show that $\tilde{S}$ cannot contain only affine highest-weight representations.
Consider spins $j_1,j_2,j_3$ such that $N_{D^{j_1,+},D^{j_2,-},D^{j_3,+}}=1$.
If the level $k$ is large enough, we must then have $N_{\hat{D}^{j_1,\frac12},\hat{D}^{j_2,-\frac12},\hat{D}^{j_3,\frac12}}=1$.
Using the behaviour \eqref{nrrr} of fusion multiplicities under spectral flow, this implies $N_{\hat{D}^{j_1,-\frac12},\hat{D}^{j_2,-\frac12},\hat{D}^{j_3,\frac32}}=1$.
So the fusion product $\hat{D}^{j_1,-\frac12}\times \hat{D}^{j_2,-\frac12}$ contains the representation $(\hat{D}^{j_3,\frac32})^*$, which is not an affine highest-weight representation.
Generalizing this argument, the spectrum must in fact contain 
representations of the type $\hat{D}^{j,w}$ for all values of $w\in \frac12+{\mathbb{Z}}$.
Then it is natural to assume that the spectral flow actually leaves the spectrum invariant.
But what are the allowed values of the spin $j$ of $\hat{D}^{j,w}$? We still impose the constraint $j>-\frac12$ which comes from the representation $D^{j,\pm}$ of $\mathfrak{sl}_2$.
If this applies to both spins in the relation \eqref{rdd}, we must then have 
\begin{align}
 -\frac12 <j < -\frac{k+3}{2}\ .
\label{jimm}
\end{align}
This defines a non-empty interval provided
\begin{align}
 \boxed{k\in]-\infty,-2[}\ .
\end{align}
(Nevertheless, the model surely exists for $k\in \mathbb{C}-\{2\}$.)
The natural conjectures for the spectrums of the $\widetilde{SL}_2(\mathbb{R})$ and $SL_2(\mathbb{R})$ WZW models are then
\begin{align}
 \tilde{S} &= \bigoplus_{w\in{\mathbb{Z}}}\int^\oplus_{-\frac12+i{\mathbb{R}}_+} dj \int^\oplus_{]0,1[} d\alpha\ \hat{C}^{j,w}_\alpha \otimes \bar{\hat{C}}^{j,w}_{\alpha} 
\oplus \bigoplus_{w\in\frac12+{\mathbb{Z}}}\int^\oplus_{]-\frac12,-\frac{k+3}{2}[} dj\ \hat{D}^{j,w}\otimes \bar{\hat{D}}^{j,w} \ ,
\\
 S &= \bigoplus_{\substack{w_L,w_R\in{\mathbb{Z}}\\ w_L-w_R\in 2{\mathbb{Z}}}}\int^\oplus_{-\frac12+i{\mathbb{R}}_+} dj \bigoplus_{\alpha\in\{0,\frac12\}} \hat{C}^{j,w_L}_\alpha \otimes \bar{\hat{C}}^{j,w_R}_{\alpha} \oplus  \bigoplus_{\substack{w_L,w_R\in\frac12+{\mathbb{Z}}\\ w_L-w_R\in 2{\mathbb{Z}}}}\ \bigoplus_{\substack{j= -\frac12, 0,\frac12,\cdots \\ j<-\frac{k+3}{2}}} \hat{D}^{j,w_L}\otimes \bar{\hat{D}}^{j,w_R} \ .
\end{align}
Notice that the left and right spectral flow numbers $w_L$ and $w_R$ are independent in the case of $SL_2(\mathbb{R})$, and equal in the case of $\widetilde{SL}_2(\mathbb{R})$, so that the spectrum $\tilde{S}$ is diagonal.
The rule, which can only be heuristic in the absence of a definition of WZW models based on the corresponding loop groups, is:
\begin{quote}
 In the $G$ WZW model the spectral flow takes values in the first homotopy group of the global symmetry group, that is $\pi_1(\frac{G\times \bar{G}}{Z(G)})$ where $Z(G)$ is the center of $G$.
\end{quote}
For our WZW models, the relevant homotopy groups are 
$ \pi_1(\frac{\widetilde{SL}_2(\mathbb{R})\times \overline{\widetilde{SL}_2(\mathbb{R})}}{{\mathbb{Z}}}) = {\mathbb{Z}}$ and $\pi_1(\frac{SL_2({\mathbb{R}})\times \overline{SL_2({\mathbb{R}})}}{{\mathbb{Z}}_2}) = \frac{{\mathbb{Z}}\times \overline{{\mathbb{Z}}}}{{\mathbb{Z}}_2}$.
The rule also applies to the case $G=U(1)$ of the compactified free boson, if we consider the winding number as a spectral flow number. 

Finally, let us check that we can find fusion rules for the representations of $\widehat{\mathfrak{sl}}_2$, such that
\begin{enumerate}
 \item the rule \eqref{nrrr} is obeyed,
\item in the large level limit $k\to -\infty$, the fusion rules reduce to the tensor product rules for representations of $\mathfrak{sl}_2$,
\item the conjectured spectrums of the $\widetilde{SL}_2(\mathbb{R})$ and $SL_2(\mathbb{R})$ WZW models are closed under fusion.
\end{enumerate}
We first obtain the fusion multiplicities $N_{\hat{D}^{j_1,\pm},\hat{D}^{j_2,\pm},\hat{D}^{j_3,\pm}}$ for affine highest-weight representations of the discrete series  by assuming that it can be nonzero only when the corresponding tensor product multiplicity \eqref{nddd} is nonzero, and when all spins obey the condition \eqref{jimm}.
The rest of the nonzero fusion multiplicities of the type    
$N_{\hat{D}^{j_1,w_1},\hat{D}^{j_2,w_2},\hat{D}^{j_3,w_3}}$ are obtained by the rule \eqref{nrrr}.
Then we generalize the relation \eqref{cjdd} between $\mathfrak{sl}_2$ representations of the principal and discrete series, and obtain 
\begin{align}
 \hat{C}^{j,w}_\alpha \sim \hat{D}^{\alpha-1,w+\frac12} \oplus \hat{D}^{\alpha-2-\frac{k}{2},w-\frac12} \ .
\end{align}
This enables us to compute fusion multiplicities involving representations of the type $\hat{C}^{j,w}_\alpha$.
The only subtlety is that we obtain aberrant terms in $N_{\hat{C}^{j_1,w_1}_{\alpha_1},\hat{D}^{j_2,w_2},\hat{D}^{j_3,w_3}}$, which depend on $\alpha_1$ instead of $\alpha_1\ \text{mod}\ {\mathbb{Z}}$, and must be discarded.
Keeping the condition \eqref{jimm} on spins of discrete series representations implicit, the results are 
\begin{align}
 N_{\hat{D}^{j_1,w_1},\hat{D}^{j_2,w_2},\hat{D}^{j_3,w_3}} 
&= \delta_{\sum w_i,\frac12} \delta_{\sum j_i+3+\frac{k}{2},-{\mathbb{N}}} + \delta_{\sum w_i,-\frac12}\delta_{\sum j_i+3+k,{\mathbb{N}}} \ ,
\\
 N_{\hat{C}^{j_1,w_1}_{\alpha_1},\hat{D}^{j_2,w_2},\hat{D}^{j_3,w_3}} &= \delta_{\sum w_i,0} \delta_{\alpha_1+j_2+j_3+\frac{k}{2},{\mathbb{Z}}}\ ,
\\
 N_{\hat{C}^{j_1,w_1}_{\alpha_1},\hat{C}^{j_2,w_2}_{\alpha_2},\hat{D}^{j_3,w_3}} & = \delta_{\sum w_i,\frac12} \delta_{\alpha_1+\alpha_2+j_3,{\mathbb{Z}}} + \delta_{\sum w_i,-\frac12}\delta_{\alpha_1+\alpha_2+j_3+\frac{k}{2},{\mathbb{Z}}}\ ,
\\
N_{\hat{C}^{j_1,w_1}_{\alpha_1},\hat{C}^{j_2,w_2}_{\alpha_2},\hat{C}^{j_3,w_3}_{\alpha_3}} & = \delta_{\sum w_i,1}\delta_{\sum\alpha_i-\frac{k}{2},{\mathbb{Z}}} + 2\, \delta_{\sum w_i,0}\delta_{\sum \alpha_i,{\mathbb{Z}}} + \delta_{\sum w_i,-1}\delta_{\sum\alpha_i+\frac{k}{2},{\mathbb{Z}}}\ .
\end{align}
This leads to the following fusion rules:
\begin{multline}
\hat{D}^{j_1,w_1}\times \hat{D}^{j_2,w_2} = \int^\oplus_{-\frac12+i{\mathbb{R}}_+} dj\ \hat{C}^{j,w_1+w_2}_{j_1+j_2+\frac{k}{2}} 
\\ \oplus 
\bigoplus_{\substack{j\in j_1+j_2+1+{\mathbb{N}} \\ j\in ]-\frac12, -\frac{k+3}{2}[}} \hat{D}^{j,w_1+w_2-\frac12} \oplus 
\bigoplus_{\substack{j\in j_1+j_2+1+\frac{k}{2}-{\mathbb{N}} \\ j\in ]-\frac12, -\frac{k+3}{2}[}} \hat{D}^{j,w_1+w_2+\frac12}\ ,
\end{multline}
\begin{align}
 \hat{C}^{j_1,w_1}_{\alpha_1}\times \hat{D}^{j_2,w_2} &= \int^\oplus_{-\frac12+i{\mathbb{R}}_+} dj\left( \hat{C}^{j,w_1+w_2-\frac12}_{\alpha_1+j_2} \oplus \hat{C}^{j,w_1+w_2+\frac12}_{\alpha_1+j_2+\frac{k}{2}}\right) \oplus \bigoplus_{\substack{j\in \alpha_1+j_2+{\mathbb{Z}} \\ j\in ]-\frac12, -\frac{k+3}{2}[}} \hat{D}^{j,w_1+w_2}\ ,
\end{align}
\begin{multline}
 \hat{C}^{j_1,w_1}_{\alpha_1}\times \hat{C}^{j_2,w_2}_{\alpha_2} = \int^\oplus_{-\frac12+i{\mathbb{R}}_+} dj \left(\hat{C}^{j,w_1+w_2-1}_{\alpha_1+\alpha_2-\frac{k}{2}} \oplus 2\, \hat{C}^{j,w_1+w_2}_{\alpha_1+\alpha_2} \oplus \hat{C}^{j,w_1+w_2+1}_{\alpha_1+\alpha_2+\frac{k}{2}}\right) 
\\
\oplus \bigoplus_{\substack{j\in \alpha_1+\alpha_2-\frac{k}{2}+{\mathbb{Z}} \\ j\in]-\frac12, -\frac{k+3}{2}[}} \hat{D}^{j,w_1+w_2-\frac12} 
\oplus \bigoplus_{\substack{j\in \alpha_1+\alpha_2+{\mathbb{Z}} \\ j\in]-\frac12, -\frac{k+3}{2}[}} \hat{D}^{j,w_1+w_2+\frac12} \ .
\end{multline}
So, while the spectral flow number $w$ is not conserved, fusion violates it by at most one unit.
This can alternatively be shown at the level of correlation functions by studying how spectral flow affects the Ward identities and Knizhnik-Zamolodchikov equations \cite{rib05}.

\section{Exercises}

\begin{exo}[Normal-ordered commutator]
~\label{exoabba}
Let us consider holomorphic fields $A,B$ such that 
\begin{align}
 A(y)B(z) = \sum_{n=0}^N \frac{C_n(z)}{(y-z)^n} + O(y-z)\ ,
\end{align}
which is of the type of eq. \eqref{abope} with $C_0 = (AB)$. 
Compute the expansion of $A(y)B(z)$ near $z=y$ (rather than $y=z$), and deduce the operator product expansion of $B(y)A(z)$. 
In particular, show that 
\begin{align}
 (AB)-(BA) = \sum_{n=1}^N \frac{(-1)^{n+1}}{n!} C_n^{(n)} = C_1'-\frac12 C_2'' + \frac16 C_3''' -\cdots \ .
\end{align}
(It is recommended to begin with the cases $N=0$ and $N=1$.)
\end{exo}

\begin{exo}[Normalization of OPE coefficients in free bosonic theories]
 ~\label{exoone}
The aim of this exercise is to show that the OPE coefficient in the OPE of $\hat{\mathfrak{u}}_1$-primary fields \eqref{vvoo} can be set to one by renormalizing the fields.
In other words, calling this coefficient $C_{\alpha_1,\alpha_2}$, we want to show that there exists a function $\lambda(\alpha)$ such that 
\begin{align}
 C_{\alpha_1,\alpha_2} = \frac{\lambda(\alpha_1+\alpha_2)}{\lambda(\alpha_1)\lambda(\alpha_2)}\ .
\label{clll}
\end{align}
To begin with, 
use commutativity \eqref{comm} and associativity \eqref{asso} of the OPE, and show that 
\begin{align}
C_{\alpha_1,\alpha_2} &= C_{\alpha_2,\alpha_1}\ ,
\\
 C_{\alpha_1,\alpha_2}C_{\alpha_1+\alpha_2,\alpha_3} &= C_{\alpha_1,\alpha_2+\alpha_3}C_{\alpha_2,\alpha_3}\ .
\end{align}
Then consider the ansatz
\begin{align}
  \lambda(\alpha) = \frac{1}{C_{\alpha,0}} \exp \int_0^{\alpha} \varphi \ , \quad \text{where}\quad  
 \varphi(\alpha)&=\left.{\frac{\partial}{\partial \alpha_2}}\log C_{\alpha,\alpha_2}\right|_{\alpha_2=0}\ .
\end{align}
Show that $C_{\alpha,0}$ is actually an $\alpha$-independent constant, and that the function $\varphi(\alpha)$ is such that
\begin{align}
 {\frac{\partial}{\partial \alpha_2}} \log C_{\alpha_1,\alpha_2}  = \varphi(\alpha_1+\alpha_2)-\varphi(\alpha_2)\ . 
\end{align}
Prove eq. \eqref{clll} by showing that both sides have the same value at $\alpha_2=0$, and the same logarithmic derivative wrt $\alpha_2$. 
(If the spectrum is discrete, a similar proof can be done using finite differences instead of derivatives.) 
\end{exo}

\begin{exo}[Sugawara construction of a Virasoro field]
 ~\label{exosug}
Compute the $TJ^a$ OPE \eqref{tja}, by applying Wick's theorem to 
$\cunderbracket{J^a}{(z)K_{bc}}{(J^bJ^c)}(y)$, 
going through the following intermediate steps:
\begin{align}
 \cunderbracket{J^a}{(z)}{(J^bJ_b)}(y) 
 &= \frac{1}{2\pi i}\oint_y\frac{dx}{x-y}\left(\frac{kJ^a(y)}{(x-z)^2} + \frac{f^{ab}_{c}J^c(x)J_b(y)}{z-x} + \frac{kJ^a(x)}{(y-z)^2} - \frac{f^{ab}_{c}J^c(x)J_b(y)}{z-y}\right)  ,
\\
& = \frac{2kJ^a(y)}{(y-z)^2} + \frac{f^{ab}_c f^{dc}_b J_d(y)}{(y-z)^2} 
 = 2(k+g) {\frac{\partial}{\partial z}} \frac{J^a(z)}{y-z} + O(1)\ .
\end{align}
Then apply Wick's theorem to $\cunderbracket{T}{(y) K_{ab}}{(J^aJ^b)}(z)$, and check the following identities:
\begin{align}
 \cunderbracket{T}{(y)}{(J^aJ_a)}(z) & = \frac{1}{2\pi i} \oint_z \frac{dx}{x-z}\left({\frac{\partial}{\partial x}}\frac{J^a(x)J_a(z)}{y-x} + {\frac{\partial}{\partial z}} \frac{J^a(x)J_a(z)}{y-z}\right) \ ,
\\
&=  \frac{1}{2\pi i} \oint_zdx \frac{J^a(x)J_a(z)}{(x-z)(y-x)(y-z)} + {\frac{\partial}{\partial z}} \frac{1}{2\pi i} \oint_zdx \frac{J^a(x)J_a(z)}{(x-z)(y-z)} \ ,
\\
&= \frac{k\dim \mathfrak{g}}{(y-z)^4} + \frac{(J^aJ_a)(z)}{(y-z)^2} + {\frac{\partial}{\partial z}}\frac{(J^aJ_a)(z)}{y-z}\ .
\end{align}
Conclude that the field $T$ satisfies the Virasoro field OPE \eqref{tt} with the central charge \eqref{ckg}.
\end{exo}

\begin{exo}[Modified Sugawara construction]
 ~\label{exotqpj}
Compute the $\hat{T}\hat{T}$ OPE for the modified Sugawara field $\hat{T} = T + Q_a\partial J^a$.
Show that $\hat{T}$ is a Virasoro field, and compute the central charge. 
Compute the $\hat{T}J^a$ OPE: under which conditions are $J^a$ primary fields with integer dimensions?
\end{exo}

\begin{exo}[Associativity of the $J^aJ^b\Phi^R$ OPE]
 ~\label{exojjp}
Check the associativity of the $J^aJ^b\Phi^R$ OPE, by performing two different computations of the behaviour near $y_2=z_0$ of 
\begin{align}
\mathcal{O}= \frac{1}{2\pi i} \oint_{y_2}dy_1\ J^a(y_1)J^b(y_2)\Phi^R(z_0)\ .
\end{align}
Firstly, use the $J^aJ^b$ OPE \eqref{jajb}, and check that
\begin{align}
 \mathcal{O}= f_c^{ab}J^c(y_2)\Phi^R(z_0) = \frac{-f_c^{ab}t^c\Phi^R(z_0)}{y_2-z_0} + O(1)\ .
\end{align}
Secondly, split the integration contour in two terms, $\oint_{y_2} = \oint_{y_2,z_0} - \oint_{z_0}$.
In the first term, use the $J^b(y_2)\Phi^R(z_0)$ OPE, as no integration contour runs between these two operators.
In the second term, use the $J^a(y_1)\Phi^R(z_0)$ OPE.
Check that you obtain the following intermediate steps:
\begin{align}
 \mathcal{O}& =\frac{1}{2\pi i} \oint_{y_2,z_0}dy_1 J^a(y_1)\frac{-t^b\Phi^R(z_0)}{y_2-z_0} - \frac{1}{2\pi i} \oint_{z_0}dy_1 J^b(y_2)\frac{-t^a\Phi^R(z_0)}{y_1-z_0} +O(1)\ ,
\\
& = \frac{-t^b}{y_2-z_0} \frac{1}{2\pi i} \oint_{y_2,z_0}dy_1 J^a(y_1)\Phi^R(z_0) + t^a J^b(y_2)\Phi^R(z_0) + O(1)\ ,
\\
& = \frac{(t^bt^a-t^at^b)\Phi^R(z_0)}{y_2-z_0} + O(1) =  \frac{-f_c^{ab}t^c\Phi^R(z_0)}{y_2-z_0} + O(1)\ .
\end{align}
Notice that this explains the minus sign in the $J^a\Phi^R$ OPE eq. \eqref{jpr}.
\end{exo}

\begin{exo}[Affine primary fields are primary fields]
 ~\label{exoapf}
Let $\Phi^R$ be an affine primary field.
Compute the OPE $T(y)\Phi^{R}(z_0)$, and check that this OPE is of the form \eqref{tvp}, with the conformal dimension and action of $L_{-1}$ given by eqs. \eqref{dr} and \eqref{lmp} respectively.
To do this, apply 
Wick's theorem to $\cunderbracket{\Phi^R}{(z_0)}{(J^aJ_a)}(y)$, using eq. \eqref{jpr} in the form $\cunderbracket{\Phi^R}{(z_0)}{J^a}(x) = \frac{-t^a\Phi^R(x)}{x-z_0}$.
\end{exo}


\begin{exo}[Wakimoto free-field representation of the algebra $\widehat{\mathfrak{sl}}_2$]
 ~\label{exowaki}
Consider fields $(J,\beta,\gamma)$ such that 
\begin{align}
 J(y)J(z) = \frac{-\frac12}{(y-z)^2} + O(1) \quad , \quad \beta(y)\gamma(z) = \frac{-1}{y-z} + O(1)\ ,
\end{align}
and the OPEs $J\beta,J\gamma,\beta\beta,\gamma\gamma$ have no singular terms.
Consider the fields 
\begin{align}
 J^- = -\beta \quad , \quad J^0 = -(\beta\gamma) - bJ \quad , \quad J^+ = (\beta\gamma^2)+2b(\gamma J)+k\partial\gamma\ ,
\end{align}
where the brackets are normal-ordered products, and the parameters $b$ and $k$ obey the relation \eqref{bk}.
Show that the fields $(J^-,J^0,J^+)$ obey the OPEs \eqref{jjjj}, and are therefore $\widehat{\mathfrak{sl}}_2$ currents. 
Show that the Sugawara construction yields the Virasoro field
\begin{align}
 T = -\beta \partial\gamma - J^2 +b^{-1}\partial J\ ,
\end{align}
and rederive the central charge from this formula.
Then define the field $\Phi^j_\mu(z)$ by 
\begin{align}
 & \beta(y)\Phi^j_\mu(z) = \frac{-\mu}{y-z}\Phi^j_\mu(z)+ O(1) \quad , \quad \gamma(y)\Phi^j_\mu(z)=O(1)\ , 
\\
 & J(y)\Phi^j_\mu(z) = \frac{-b^{-1}(j+1)}{y-z}\Phi^j_\mu(z)+ O(1)\ .
\end{align}
Show that the field $\left({\frac{\partial}{\partial \mu}}-\gamma(z)\right)\Phi^j_\mu(z)$ satisfies the same relations, and is therefore proportional to $\Phi^j_\mu(z)$.
Choosing the coefficient of proportionality such that
\begin{align}
 {\frac{\partial}{\partial \mu}}\Phi^j_\mu(z) =\left(\frac{j+1}{\mu}+\gamma(z)\right)\Phi^j_\mu(z)\ ,
\end{align}
write the OPEs $J^a(y)\Phi^j_\mu(z)$ in terms of differential operators as in eq. \eqref{jprx}, and conclude that $\Phi^j_\mu(z)$ is a $\mu$-basis affine primary field.
\end{exo}

\begin{exo}[Conformal global Ward identities from KZ equations]
 ~\label{exokz}
 Prove that the KZ equations imply the global Ward identities of conformal symmetry \eqref{spz}.
 Use the global Ward identities of the affine symmetry \eqref{drxt}, the Casimir relation for the isospin differential operators \eqref{dta}, and the conformal dimensions of affine primary fields \eqref{dr}. 
\end{exo}


\begin{exo}[Proof of the identity \eqref{dtyj}]
 ~\label{exoktk}
Check that the identity holds when applied to positions $z_i$, due to $\mathcal{K}^{-1}z_i = z_i$. 
To check that the identity also holds when applied to Sklyanin variables $y_j$, it is enough to check 
that both sides have the same commutator with $\mathcal{K}\hat{J}^-(y)\mathcal{K}^{-1}$. 
Compute the commutator of the left-hand side using $[\hat{T}(\hat{y}_j),\hat{J}^-(y)]={\frac{\partial}{\partial y}}\frac{1}{y-\hat{y}_j}\hat{J}^-(y)$, which is a consequence of eq. \eqref{dtd}.
Compute the commutator of the 
right-hand side using the formula \eqref{djm} for $\hat{J}^-(y)$, and conclude.
\end{exo}

\bibliographystyle{cft}
\bibliography{cft}

%\input{refs.tex}

\printindex

\end{document}
